{
  "lesson_id": "D2-LESSON-012",
  "domain": 2,
  "title": "Security Assessments and Testing",
  "subtitle": "Measuring Security: Pentests, Audits, and Assessments",
  "version": "2.0-enhanced",
  "objectives_covered": ["2.3"],
  "estimated_duration": "75-90 minutes",
  "difficulty": "intermediate",
  "prerequisites": ["D2-LESSON-007"],

  "skill_tree": {
    "position": {"domain": 2, "sequence": 12, "tier": "intermediate"},
    "prerequisites": [{"lesson_id": "D2-LESSON-007", "title": "Vulnerability Management", "why_needed": "Assessments build on vulnerability concepts"}],
    "unlocks": [{"lesson_id": "D5-LESSON-005", "title": "Audits and Assessments", "connection": "GRC perspective on assessments"}]
  },

  "role_relevance": {
    "soc_analyst": {"relevance": "medium", "percentage_of_job": "15-25%", "daily_tasks": ["Support assessment activities", "Review findings"]},
    "security_engineer": {"relevance": "high", "percentage_of_job": "30-40%", "daily_tasks": ["Coordinate assessments", "Remediate findings"]},
    "grc_analyst": {"relevance": "critical", "percentage_of_job": "50-60%", "daily_tasks": ["Plan assessments", "Track remediation", "Report to stakeholders"]},
    "penetration_tester": {"relevance": "critical", "percentage_of_job": "70-80%", "daily_tasks": ["Conduct penetration tests", "Write reports", "Validate fixes"]}
  },

  "introduction": {
    "hook": "How do you know if your security controls actually work? Security assessments—from vulnerability scans to full penetration tests—provide evidence of your security posture and identify weaknesses before attackers do.",
    "exam_weight": {"estimated_questions": "4-6", "high_yield_topics": ["Pentest vs vuln scan", "Assessment types", "Rules of engagement", "Reporting"]}
  },

  "sections": [
    {
      "section_id": "D2-L012-S01",
      "title": "Assessment Types",
      "estimated_time": "15 minutes",
      "content": {
        "core_concepts": [
          {
            "concept": "Assessment Spectrum",
            "types": [
              {"type": "Vulnerability Scan", "method": "Automated tool identifies known vulnerabilities", "depth": "Broad, shallow", "exploitation": "None"},
              {"type": "Vulnerability Assessment", "method": "Scan + analysis + prioritization", "depth": "Broader analysis", "exploitation": "None"},
              {"type": "Penetration Test", "method": "Attempt to actually exploit vulnerabilities", "depth": "Deep, targeted", "exploitation": "Yes - proves exploitability"},
              {"type": "Red Team Exercise", "method": "Full adversary simulation", "depth": "Comprehensive", "exploitation": "Yes - tests people, process, technology"}
            ]
          },
          {
            "concept": "Penetration Test Types",
            "types": [
              {"type": "Black Box", "knowledge": "No prior knowledge", "simulates": "External attacker"},
              {"type": "White Box", "knowledge": "Full knowledge (code, architecture)", "simulates": "Insider or thorough review"},
              {"type": "Gray Box", "knowledge": "Partial knowledge", "simulates": "Compromised insider or partner"}
            ]
          },
          {
            "concept": "Testing Environments",
            "environments": [
              {"environment": "Known Environment", "description": "Tester has full info (white box)"},
              {"environment": "Partially Known", "description": "Tester has some info (gray box)"},
              {"environment": "Unknown Environment", "description": "Tester has no info (black box)"}
            ],
            "note": "CompTIA now uses 'known/unknown environment' terminology"
          }
        ]
      },
      "memory_hooks": {
        "mnemonic": "Black = Blind, White = Wide open, Gray = Glimpse",
        "common_mistakes": [{"mistake": "Thinking vulnerability scans prove exploitability", "correction": "Scans identify potential vulnerabilities. Only pentests prove they can actually be exploited."}]
      },
      "must_remember_for_exam": [
        {"fact": "Vulnerability scan = automated, no exploitation", "why_tested": "Assessment distinction"},
        {"fact": "Penetration test = actually exploits vulnerabilities", "why_tested": "Assessment distinction"},
        {"fact": "Black box = no knowledge; White box = full knowledge", "why_tested": "Test types"},
        {"fact": "Red team = full adversary simulation", "why_tested": "Assessment type"}
      ],
      "key_points": ["Vuln scan identifies; pentest exploits", "Black = no knowledge, White = full, Gray = partial", "Red team simulates real adversary"],
      "knowledge_check": {
        "question": "A security team wants to prove that identified vulnerabilities can actually be exploited. Which assessment type should they use?",
        "options": ["Vulnerability scan", "Vulnerability assessment", "Penetration test", "Compliance audit"],
        "correct": 2,
        "explanation": "Penetration tests actually attempt to exploit vulnerabilities, proving exploitability. Scans and assessments only identify potential vulnerabilities.",
        "wrong_answer_analysis": [
          {"option": 0, "why_wrong": "Scans identify but don't exploit"},
          {"option": 1, "why_wrong": "Assessments analyze but don't exploit"},
          {"option": 3, "why_wrong": "Audits check compliance, not exploitability"}
        ]
      }
    },
    {
      "section_id": "D2-L012-S02",
      "title": "Penetration Testing Process",
      "estimated_time": "12 minutes",
      "content": {
        "core_concepts": [
          {
            "concept": "Pentest Phases",
            "phases": [
              {"phase": "Planning/Scoping", "activities": "Define scope, rules of engagement, get authorization"},
              {"phase": "Reconnaissance", "activities": "Gather information about target"},
              {"phase": "Scanning/Enumeration", "activities": "Identify systems, services, vulnerabilities"},
              {"phase": "Exploitation", "activities": "Attempt to exploit vulnerabilities"},
              {"phase": "Post-Exploitation", "activities": "Maintain access, pivot, escalate privileges"},
              {"phase": "Reporting", "activities": "Document findings, recommendations"}
            ]
          },
          {
            "concept": "Rules of Engagement",
            "definition": "Documented agreement defining test boundaries",
            "includes": [
              "Scope (what can be tested)",
              "Timeline (when testing occurs)",
              "Methods (allowed techniques)",
              "Communication (emergency contacts)",
              "Data handling (what happens to findings)"
            ],
            "importance": "Protects both tester and organization legally"
          },
          {
            "concept": "Authorization",
            "requirement": "Written authorization REQUIRED before testing",
            "without_it": "Testing without authorization is illegal (computer crime)",
            "document": "Often called 'get out of jail free' letter"
          }
        ]
      },
      "must_remember_for_exam": [
        {"fact": "Written authorization required before penetration testing", "why_tested": "Legal requirement"},
        {"fact": "Rules of engagement define scope and boundaries", "why_tested": "Process element"},
        {"fact": "Testing without authorization = illegal", "why_tested": "Legal awareness"}
      ],
      "key_points": ["Written authorization required before testing", "Rules of engagement define boundaries", "Phases: Plan → Recon → Scan → Exploit → Post-exploit → Report"]
    },
    {
      "section_id": "D2-L012-S03",
      "title": "Specialized Assessment Types",
      "estimated_time": "10 minutes",
      "content": {
        "core_concepts": [
          {
            "concept": "Physical Penetration Testing",
            "targets": "Physical security controls",
            "techniques": ["Tailgating/piggybacking", "Lock picking", "Badge cloning", "Social engineering"],
            "goal": "Test physical access controls"
          },
          {
            "concept": "Social Engineering Assessment",
            "targets": "Human element",
            "techniques": ["Phishing simulations", "Vishing calls", "Pretexting", "Physical social engineering"],
            "goal": "Test employee security awareness"
          },
          {
            "concept": "Wireless Assessment",
            "targets": "Wireless networks",
            "techniques": ["Rogue AP detection", "WPA cracking", "Evil twin attacks"],
            "goal": "Test wireless security controls"
          },
          {
            "concept": "Bug Bounty Programs",
            "definition": "Crowdsourced security testing with rewards",
            "benefits": ["Continuous testing", "Diverse perspectives", "Pay for results"],
            "considerations": ["Scope definition", "Legal framework", "Reward structure"]
          }
        ]
      },
      "must_remember_for_exam": [
        {"fact": "Physical pentest tests physical security controls", "why_tested": "Assessment type"},
        {"fact": "Social engineering assessment tests human element", "why_tested": "Assessment type"},
        {"fact": "Bug bounty = crowdsourced security testing", "why_tested": "Modern approach"}
      ],
      "key_points": ["Physical pentests test locks, badges, tailgating", "Social engineering tests employees", "Bug bounties provide crowdsourced testing"]
    },
    {
      "section_id": "D2-L012-S04",
      "title": "Reporting and Remediation",
      "estimated_time": "10 minutes",
      "content": {
        "core_concepts": [
          {
            "concept": "Assessment Report Components",
            "components": [
              {"component": "Executive Summary", "audience": "Leadership", "content": "High-level findings and risk"},
              {"component": "Technical Details", "audience": "Technical teams", "content": "Vulnerabilities, evidence, reproduction steps"},
              {"component": "Risk Ratings", "audience": "All", "content": "Severity based on impact and likelihood"},
              {"component": "Recommendations", "audience": "All", "content": "Remediation guidance"}
            ]
          },
          {
            "concept": "Finding Severity",
            "factors": ["Exploitability", "Impact", "Affected systems", "Data sensitivity"],
            "common_scale": ["Critical", "High", "Medium", "Low", "Informational"]
          },
          {
            "concept": "Remediation Tracking",
            "process": [
              "Assign owners to findings",
              "Set remediation timelines by severity",
              "Track progress",
              "Verify fixes (retest)"
            ]
          }
        ]
      },
      "must_remember_for_exam": [
        {"fact": "Executive summary for leadership, technical details for IT", "why_tested": "Report audience"},
        {"fact": "Findings should be verified/retested after remediation", "why_tested": "Process completion"}
      ],
      "key_points": ["Reports have executive and technical sections", "Severity based on exploitability and impact", "Always retest after remediation"]
    }
  ],

  "hands_on_labs": {
    "browser_labs": [
      {"lab_id": "lab-assessment-planner", "title": "Assessment Planning", "type": "scenario", "description": "Create scope and rules of engagement for a pentest"},
      {"lab_id": "lab-finding-classifier", "title": "Finding Classifier", "type": "quiz", "description": "Rate finding severity based on details"}
    ],
    "external_labs": [
      {"resource": "TryHackMe", "lab_name": "Intro to Offensive Security", "url": "https://tryhackme.com", "description": "Hands-on penetration testing basics"},
      {"resource": "HackTheBox", "url": "https://hackthebox.com", "description": "Practice penetration testing skills"}
    ]
  },

  "summary": {
    "key_takeaways": [
      "Vulnerability scan identifies; penetration test exploits",
      "Black box = no knowledge; White box = full knowledge; Gray box = partial",
      "Red team simulates full adversary with minimal restrictions",
      "Written authorization required before any penetration testing",
      "Rules of engagement define scope and boundaries",
      "Reports need executive summary and technical details"
    ],
    "exam_essentials": [
      "Pentest exploits; vuln scan only identifies",
      "Black box = unknown environment",
      "White box = known environment",
      "Written authorization REQUIRED",
      "Rules of engagement define test boundaries",
      "Bug bounty = crowdsourced testing"
    ]
  },

  "related_content": {
    "simulations": ["D2-SIM-005"],
    "next_lesson": "D3-LESSON-001",
    "previous_lesson": "D2-LESSON-011"
  }
}
