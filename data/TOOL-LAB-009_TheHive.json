{
  "lab_id": "TOOL-LAB-009",
  "tool_name": "TheHive",
  "tool_category": "Case Management",
  "version": "1.0",
  
  "metadata": {
    "difficulty": "intermediate",
    "estimated_time": "2-3 hours",
    "last_updated": "2025-01-14",
    "author": "Security+ Training System"
  },
  
  "overview": {
    "tagline": "Open Source Security Incident Response Platform",
    "description": "TheHive is a scalable Security Incident Response Platform for SOC teams. It manages cases, tracks investigations, integrates with MISP for threat intelligence, and automates workflows with Cortex analyzers. Essential for organized incident response.",
    "official_site": "https://thehive-project.org/",
    "download_url": "https://github.com/TheHive-Project/TheHive",
    "license": "Open Source (AGPL)",
    "platforms": ["Linux", "Docker"],
    "why_learn": "Organized case management separates professional SOCs from chaos. TheHive provides structure for investigations and collaboration."
  },
  
  "security_plus_relevance": {
    "domains": [4, 5],
    "objectives": ["4.2", "4.8", "5.1"],
    "exam_topics": [
      "Incident response procedures",
      "Security operations workflows",
      "Documentation and reporting",
      "Security program management"
    ]
  },
  
  "career_relevance": {
    "soc_analyst": {
      "relevance": "critical",
      "percentage_of_job": "40-50%",
      "usage": "Daily case management, investigation tracking"
    },
    "incident_responder": {
      "relevance": "critical",
      "percentage_of_job": "50-60%",
      "usage": "Managing complex investigations, collaboration"
    },
    "security_engineer": {
      "relevance": "medium",
      "percentage_of_job": "10-15%",
      "usage": "Building automation workflows"
    },
    "penetration_tester": {
      "relevance": "low",
      "percentage_of_job": "5%",
      "usage": "Understanding SOC processes"
    },
    "grc_analyst": {
      "relevance": "high",
      "percentage_of_job": "20-25%",
      "usage": "Audit trails, metrics, compliance reporting"
    }
  },
  
  "prerequisites": {
    "knowledge": [
      "Basic incident response concepts",
      "Understanding of SOC workflows",
      "Familiarity with ticketing systems"
    ],
    "tools_needed": [
      "Docker (for easy deployment)",
      "Web browser",
      "Optional: Cortex for analyzers"
    ],
    "estimated_setup_time": "30-45 minutes"
  },
  
  "quick_start": {
    "installation_steps": [
      {
        "step": 1,
        "title": "Deploy with Docker",
        "instructions": "git clone https://github.com/TheHive-Project/Docker-Templates\ncd Docker-Templates/docker\ndocker-compose up -d",
        "platform_specific": {
          "linux": "Docker Compose recommended",
          "windows": "Docker Desktop with Linux containers",
          "macos": "Docker Desktop"
        }
      },
      {
        "step": 2,
        "title": "Access Web Interface",
        "instructions": "Open browser to http://localhost:9000\nDefault login: admin@thehive.local / secret",
        "verification": "Login screen appears"
      }
    ],
    "first_run": "Create organization → Create user → Create first case",
    "verification": "Dashboard shows empty case list"
  },
  
  "core_concepts": [
    {
      "concept_id": "cases",
      "title": "Cases",
      "explanation": "Cases are containers for investigations. They have severity, status, tasks, observables, and timeline entries.",
      "why_it_matters": "Structured cases ensure nothing falls through the cracks.",
      "exam_tip": "Incident documentation is crucial for lessons learned"
    },
    {
      "concept_id": "observables",
      "title": "Observables",
      "explanation": "IOCs attached to cases: IPs, domains, hashes, emails. Can be analyzed automatically with Cortex.",
      "why_it_matters": "Centralized IOC tracking enables correlation across cases.",
      "exam_tip": "IOC management is key to threat intelligence"
    },
    {
      "concept_id": "tasks",
      "title": "Tasks",
      "explanation": "Work items within cases assigned to analysts. Track progress and ensure completeness.",
      "why_it_matters": "Task assignment enables team coordination.",
      "exam_tip": "Clear task ownership improves response time"
    },
    {
      "concept_id": "cortex",
      "title": "Cortex Integration",
      "explanation": "Cortex automates analysis: VirusTotal lookups, WHOIS, sandbox submission, etc.",
      "why_it_matters": "Automation accelerates investigation.",
      "exam_tip": "SOAR integration improves SOC efficiency"
    }
  ],
  
  "mini_projects": [
    {
      "project_id": "project-1",
      "title": "Setting Up Your SOC Platform",
      "difficulty": "beginner",
      "estimated_time": "45-60 minutes",
      "description": "Deploy TheHive, configure organization structure, and create your first case.",
      "learning_objectives": [
        "Deploy TheHive with Docker",
        "Configure organizations and users",
        "Create and manage cases",
        "Understand case lifecycle"
      ],
      "scenario": "You're setting up case management for a new SOC team.",
      
      "setup": {
        "files_needed": [],
        "environment": "Docker installed, ports 9000 available"
      },
      
      "tasks": [
        {
          "task_id": "task-1",
          "title": "Deploy TheHive",
          "instructions": "Clone and start:\n\ngit clone https://github.com/TheHive-Project/Docker-Templates\ncd Docker-Templates/docker\ndocker-compose up -d\n\nWait 2-3 minutes for startup",
          "hints": ["Check logs: docker-compose logs -f", "Elasticsearch needs time to start"],
          "expected_result": "TheHive accessible at localhost:9000",
          "common_mistakes": ["Not waiting for full startup"]
        },
        {
          "task_id": "task-2",
          "title": "Create Organization",
          "instructions": "1. Login as admin\n2. Go to Admin → Organizations\n3. Create organization: 'SOC Team'\n4. Add users with appropriate roles",
          "hints": ["org-admin can manage org", "analyst for daily work"],
          "expected_result": "Organization with users created",
          "common_mistakes": ["Wrong role assignments"]
        },
        {
          "task_id": "task-3",
          "title": "Create Your First Case",
          "instructions": "1. Click '+ New Case'\n2. Title: 'Suspicious Login Alert'\n3. Severity: Medium\n4. Add description\n5. Save",
          "hints": ["TLP controls sharing", "Tags help filtering"],
          "expected_result": "Case created and visible in list",
          "common_mistakes": ["Missing required fields"]
        },
        {
          "task_id": "task-4",
          "title": "Add Tasks to Case",
          "instructions": "In your case:\n1. Click Tasks tab\n2. Add: 'Review source logs'\n3. Add: 'Check user account'\n4. Add: 'Document findings'\n5. Assign to yourself",
          "hints": ["Tasks track work items", "Can assign to team members"],
          "expected_result": "Tasks visible in case",
          "common_mistakes": ["Not assigning tasks"]
        },
        {
          "task_id": "task-5",
          "title": "Add Observables",
          "instructions": "1. Go to Observables tab\n2. Add IP: 192.168.1.100 (type: ip)\n3. Add username (type: other)\n4. Tag as IOC if malicious",
          "hints": ["Observables are your IOCs", "Types enable proper handling"],
          "expected_result": "Observables attached to case",
          "common_mistakes": ["Wrong observable types"]
        }
      ],
      
      "challenge_questions": [
        {
          "question": "Why separate cases by investigation vs. one big case?",
          "answer": "Separate cases enable proper tracking, metrics, and closure",
          "explanation": "Each incident should have its own case for accountability"
        }
      ],
      
      "takeaways": [
        "TheHive provides structure for SOC investigations",
        "Cases contain all investigation elements",
        "Tasks ensure work is tracked",
        "Observables centralize IOC management"
      ]
    },
    {
      "project_id": "project-2",
      "title": "Working an Investigation",
      "difficulty": "intermediate",
      "estimated_time": "60-90 minutes",
      "description": "Work through a complete investigation lifecycle: from alert to closure with proper documentation.",
      "learning_objectives": [
        "Handle case lifecycle",
        "Document investigation steps",
        "Manage multiple observables",
        "Close cases properly"
      ],
      "scenario": "A phishing alert came in. Work the investigation from start to finish.",
      
      "setup": {
        "files_needed": [],
        "environment": "TheHive running with your organization"
      },
      
      "tasks": [
        {
          "task_id": "task-1",
          "title": "Create Phishing Case",
          "instructions": "Create case:\n- Title: 'Phishing: Fake Invoice Email'\n- Severity: High\n- Tags: phishing, email\n- Description: Employee reported suspicious invoice email",
          "hints": ["High severity gets attention", "Good titles help triage"],
          "expected_result": "Case created with proper details",
          "common_mistakes": ["Vague descriptions"]
        },
        {
          "task_id": "task-2",
          "title": "Add Observables from Email",
          "instructions": "Add observables:\n1. Sender email (type: mail)\n2. Links in email (type: url)\n3. Attachment hash (type: hash)\n4. Sender IP (type: ip)",
          "hints": ["Extract all IOCs from email", "Hash attachments before opening"],
          "expected_result": "All IOCs documented",
          "common_mistakes": ["Missing IOCs"]
        },
        {
          "task_id": "task-3",
          "title": "Create Investigation Tasks",
          "instructions": "Add tasks:\n1. 'Check if link was clicked'\n2. 'Search for similar emails'\n3. 'Block sender domain'\n4. 'User awareness follow-up'",
          "hints": ["Tasks = action items", "Cover all response steps"],
          "expected_result": "Complete task list",
          "common_mistakes": ["Incomplete task list"]
        },
        {
          "task_id": "task-4",
          "title": "Document Findings",
          "instructions": "For each task:\n1. Complete the task\n2. Add task log entry documenting what you found\n3. Mark task as Complete\n4. Update case description with summary",
          "hints": ["Log entries create audit trail", "Be specific in findings"],
          "expected_result": "Documented investigation",
          "common_mistakes": ["Poor documentation"]
        },
        {
          "task_id": "task-5",
          "title": "Close Case",
          "instructions": "1. Review all tasks completed\n2. Set case status to Resolved\n3. Add resolution summary\n4. Select True Positive/False Positive\n5. Close case",
          "hints": ["Resolution type affects metrics", "Summary helps future reference"],
          "expected_result": "Properly closed case",
          "common_mistakes": ["Closing without summary"]
        }
      ],
      
      "challenge_questions": [
        {
          "question": "Why document every step even for simple cases?",
          "answer": "Audit trail, training, metrics, legal requirements",
          "explanation": "Documentation proves due diligence and enables improvement"
        }
      ],
      
      "takeaways": [
        "Full lifecycle management ensures completeness",
        "Documentation creates audit trail",
        "Proper closure enables accurate metrics",
        "IOC collection supports threat intelligence"
      ]
    },
    {
      "project_id": "project-3",
      "title": "Building SOC Workflows",
      "difficulty": "advanced",
      "estimated_time": "60-90 minutes",
      "description": "Configure case templates, custom fields, and automation for efficient SOC operations.",
      "learning_objectives": [
        "Create case templates",
        "Configure custom fields",
        "Set up Cortex analyzers",
        "Build reporting workflows"
      ],
      "scenario": "Standardize your SOC processes with templates and automation.",
      
      "setup": {
        "files_needed": [],
        "environment": "TheHive with admin access"
      },
      
      "tasks": [
        {
          "task_id": "task-1",
          "title": "Create Case Template",
          "instructions": "Create template for phishing:\n1. Admin → Case Templates\n2. Name: 'Phishing Investigation'\n3. Add pre-defined tasks\n4. Set default severity/tags\n5. Add required custom fields",
          "hints": ["Templates ensure consistency", "Pre-populate common tasks"],
          "expected_result": "Reusable case template",
          "common_mistakes": ["Templates too rigid"]
        },
        {
          "task_id": "task-2",
          "title": "Configure Custom Fields",
          "instructions": "Add custom fields:\n1. 'Affected Users' (number)\n2. 'Attack Vector' (dropdown)\n3. 'Business Impact' (text)\n4. 'MITRE ATT&CK' (multi-select)",
          "hints": ["Custom fields enable metrics", "Dropdowns ensure consistency"],
          "expected_result": "Custom fields available",
          "common_mistakes": ["Too many required fields"]
        },
        {
          "task_id": "task-3",
          "title": "Set Up Cortex Analyzers",
          "instructions": "If Cortex deployed:\n1. Configure VirusTotal analyzer\n2. Configure WHOIS analyzer\n3. Test analyzer on observable\n4. Review results in case",
          "hints": ["API keys required", "Rate limits apply"],
          "expected_result": "Automated observable analysis",
          "common_mistakes": ["Missing API keys"]
        },
        {
          "task_id": "task-4",
          "title": "Create Dashboard",
          "instructions": "Build operations dashboard:\n1. Cases by status\n2. Cases by severity\n3. Cases by analyst\n4. Average time to close",
          "hints": ["Dashboards show SOC health", "Identify bottlenecks"],
          "expected_result": "Operational visibility dashboard",
          "common_mistakes": ["Too many metrics"]
        },
        {
          "task_id": "task-5",
          "title": "Document SOC Procedures",
          "instructions": "Create runbook:\n1. When to use each template\n2. Required fields for cases\n3. Escalation procedures\n4. Closure requirements",
          "hints": ["SOPs ensure consistency", "New analysts need guidance"],
          "expected_result": "SOC procedure documentation",
          "common_mistakes": ["No documentation"]
        }
      ],
      
      "challenge_questions": [
        {
          "question": "How do templates improve SOC operations?",
          "answer": "Consistency, speed, completeness, training",
          "explanation": "Templates encode best practices and reduce errors"
        }
      ],
      
      "takeaways": [
        "Templates standardize investigations",
        "Custom fields enable meaningful metrics",
        "Automation accelerates analysis",
        "Documentation enables scaling"
      ]
    }
  ],
  
  "external_resources": [
    {
      "platform": "TheHive Project",
      "name": "Official Documentation",
      "url": "https://docs.thehive-project.org/",
      "cost": "Free",
      "difficulty": "all",
      "estimated_time": "Reference",
      "description": "Complete TheHive documentation"
    },
    {
      "platform": "GitHub",
      "name": "TheHive Templates",
      "url": "https://github.com/TheHive-Project/TheHive-Resources",
      "cost": "Free",
      "difficulty": "intermediate",
      "estimated_time": "Reference",
      "description": "Community case templates and resources"
    }
  ],
  
  "cheat_sheet": {
    "sections": [
      {
        "title": "Case Status",
        "commands": [
          { "command": "New", "description": "Just created, not started" },
          { "command": "InProgress", "description": "Being investigated" },
          { "command": "Resolved", "description": "Investigation complete" },
          { "command": "Closed", "description": "Fully closed" }
        ]
      },
      {
        "title": "Observable Types",
        "commands": [
          { "command": "ip", "description": "IP addresses" },
          { "command": "domain", "description": "Domain names" },
          { "command": "url", "description": "URLs" },
          { "command": "hash", "description": "File hashes (MD5, SHA)" },
          { "command": "mail", "description": "Email addresses" },
          { "command": "filename", "description": "File names" }
        ]
      },
      {
        "title": "Severity Levels",
        "commands": [
          { "command": "Low", "description": "Minimal impact" },
          { "command": "Medium", "description": "Moderate impact" },
          { "command": "High", "description": "Significant impact" },
          { "command": "Critical", "description": "Severe impact" }
        ]
      },
      {
        "title": "Resolution Types",
        "commands": [
          { "command": "True Positive", "description": "Confirmed incident" },
          { "command": "False Positive", "description": "Not an incident" },
          { "command": "Indeterminate", "description": "Cannot determine" },
          { "command": "Duplicate", "description": "Already tracked elsewhere" }
        ]
      }
    ]
  },
  
  "knowledge_check": [
    {
      "question": "What is the primary purpose of case management in a SOC?",
      "options": [
        "Replace SIEM systems",
        "Track and document investigations systematically",
        "Block malware automatically",
        "Generate compliance reports only"
      ],
      "correct": 1,
      "explanation": "Case management provides structure, tracking, and documentation for security investigations"
    },
    {
      "question": "What are 'observables' in TheHive?",
      "options": [
        "User accounts",
        "Dashboard widgets",
        "IOCs attached to cases (IPs, domains, hashes)",
        "Audit logs"
      ],
      "correct": 2,
      "explanation": "Observables are indicators of compromise that are tracked and analyzed within cases"
    },
    {
      "question": "Why use case templates?",
      "options": [
        "They're required by TheHive",
        "They ensure consistent, complete investigations",
        "They replace documentation",
        "They automatically close cases"
      ],
      "correct": 1,
      "explanation": "Templates standardize investigations with pre-defined tasks, fields, and procedures"
    }
  ],
  
  "next_steps": {
    "related_labs": ["TOOL-LAB-003", "TOOL-LAB-010"],
    "related_lessons": ["D4-LESSON-002", "D5-LESSON-001"],
    "certifications": [
      "CompTIA CySA+",
      "GIAC Certified Incident Handler (GCIH)"
    ],
    "advanced_topics": [
      "MISP integration",
      "Cortex responders",
      "Custom webhooks",
      "API automation"
    ]
  }
}
