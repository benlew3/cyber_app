{
  "lesson_id": "D2-LESSON-011",
  "domain": 2,
  "title": "Attack Frameworks and Methodologies",
  "subtitle": "Understanding How Attackers Think: MITRE ATT&CK, Kill Chain, and More",
  "version": "2.0-enhanced",
  "objectives_covered": [
    "2.1"
  ],
  "estimated_duration": "75-90 minutes",
  "difficulty": "intermediate",
  "prerequisites": [
    "D2-LESSON-001"
  ],
  "skill_tree": {
    "position": {
      "domain": 2,
      "sequence": 11,
      "tier": "intermediate"
    },
    "prerequisites": [
      {
        "lesson_id": "D2-LESSON-001",
        "title": "Threat Actors",
        "why_needed": "Frameworks describe actor behaviors"
      }
    ],
    "unlocks": [
      {
        "lesson_id": "D4-LESSON-001",
        "title": "Security Monitoring",
        "connection": "Framework-based detection"
      }
    ]
  },
  "role_relevance": {
    "soc_analyst": {
      "relevance": "critical",
      "percentage_of_job": "45-55%",
      "daily_tasks": [
        "Map alerts to ATT&CK",
        "Identify tactics",
        "Track TTPs"
      ]
    },
    "incident_responder": {
      "relevance": "critical",
      "percentage_of_job": "50-60%",
      "daily_tasks": [
        "Trace attack path",
        "Predict next moves",
        "Document using frameworks"
      ]
    },
    "security_engineer": {
      "relevance": "high",
      "percentage_of_job": "30-40%",
      "daily_tasks": [
        "Design defenses using ATT&CK",
        "Identify coverage gaps"
      ]
    },
    "penetration_tester": {
      "relevance": "critical",
      "percentage_of_job": "55-65%",
      "daily_tasks": [
        "Follow attack methodologies",
        "Emulate adversary TTPs"
      ]
    }
  },
  "introduction": {
    "hook": "Attackers follow patterns. Understanding their playbooksâ€”from the Cyber Kill Chain to MITRE ATT&CKâ€”helps defenders anticipate moves, detect intrusions, and respond effectively.",
    "exam_weight": {
      "estimated_questions": "4-6",
      "high_yield_topics": [
        "MITRE ATT&CK structure",
        "Kill Chain stages",
        "Diamond Model",
        "TTPs"
      ]
    },
    "learning_goals": [
      "Explain the purpose and structure of MITRE ATT&CK framework",
      "Navigate the Cyber Kill Chain and understand attack progression",
      "Apply the Diamond Model for threat intelligence analysis",
      "Use frameworks for detection engineering, threat hunting, and gap analysis"
    ],
    "why_it_matters": {
      "career_impact": "MITRE ATT&CK has become the common language of cybersecurity. SOC analysts map alerts to techniques, threat hunters use it for hypothesis generation, and security teams use it for coverage assessment.",
      "business_connection": "Frameworks enable consistent communication about threats across teams and organizations. They help prioritize security investments by identifying detection gaps against real adversary behaviors.",
      "exam_relevance": "Expect 3-4 questions on frameworks. Key topics: ATT&CK tactics vs techniques, Cyber Kill Chain phases, Diamond Model components (adversary, capability, infrastructure, victim), and practical applications."
    }
  },
  "sections": [
    {
      "section_id": "D2-L011-S01",
      "title": "MITRE ATT&CK Framework",
      "estimated_time": "15 minutes",
      "content": "MITRE ATT&CK (Adversarial Tactics, Techniques, and Common Knowledge) is a globally accessible knowledge base of adversary behavior based on real-world observations.\n\n**Framework Structure**\n\n*Tactics (The \"Why\")*\nTactics represent the adversary's objectives - why they're performing an action. The Enterprise matrix includes 14 tactics:\n\n1. **Reconnaissance** - Gathering information to plan attack\n2. **Resource Development** - Establishing infrastructure and capabilities\n3. **Initial Access** - Getting into the network\n4. **Execution** - Running malicious code\n5. **Persistence** - Maintaining foothold across restarts\n6. **Privilege Escalation** - Gaining higher-level permissions\n7. **Defense Evasion** - Avoiding detection\n8. **Credential Access** - Stealing credentials\n9. **Discovery** - Learning about the environment\n10. **Lateral Movement** - Moving through the network\n11. **Collection** - Gathering target data\n12. **Command and Control** - Communicating with compromised systems\n13. **Exfiltration** - Stealing data\n14. **Impact** - Disruption, destruction, or manipulation\n\n*Techniques (The \"How\")*\nTechniques describe how adversaries achieve tactical objectives. Each tactic has multiple techniques. Over 200 techniques documented. Example: Initial Access includes Phishing, Drive-by Compromise, Supply Chain Compromise.\n\n*Sub-Techniques*\nMore specific implementations of techniques. Example: Phishing has sub-techniques for Spearphishing Attachment, Spearphishing Link, Spearphishing via Service.\n\n*Procedures*\nSpecific implementations by threat groups. Real-world examples of how techniques are used. Documented in threat group and software profiles.\n\n**ATT&CK Matrices**\n\n*Enterprise Matrix*\n- Windows, macOS, Linux, Cloud, Network, Containers\n- Most comprehensive matrix\n- Primary focus for most organizations\n\n*Mobile Matrix*\n- iOS and Android techniques\n- Device and network-based attacks\n\n*ICS Matrix*\n- Industrial Control Systems\n- OT-specific techniques\n- Critical infrastructure focus\n\n**Using ATT&CK Operationally**\n\n*Threat Intelligence*\n- Map threat reports to ATT&CK techniques\n- Identify techniques used by threat actors targeting your industry\n- Prioritize defenses based on relevant threats\n\n*Detection Engineering*\n- Build detections mapped to specific techniques\n- Measure detection coverage across the matrix\n- Identify gaps in detection capabilities\n\n*Red Team/Purple Team*\n- Emulate adversary techniques during testing\n- Validate detection capabilities\n- Prioritize remediation based on findings\n\n*Security Assessment*\n- Evaluate security controls against ATT&CK\n- Gap analysis for technique coverage\n- Risk-based prioritization of improvements\n\n**ATT&CK Navigator**\nVisual tool for exploring and annotating ATT&CK matrices. Layer creation for coverage mapping. Comparison of multiple layers. Export for reporting and documentation.",
      "must_remember_for_exam": [
        {
          "fact": "ATT&CK: Tactics = WHY, Techniques = HOW",
          "why_tested": "Framework structure"
        },
        {
          "fact": "14 tactics from Reconnaissance to Impact",
          "why_tested": "Framework scope"
        },
        {
          "fact": "TTPs = Tactics, Techniques, Procedures",
          "why_tested": "Terminology"
        }
      ],
      "key_points": [
        "Tactics = goals (why), Techniques = methods (how)",
        "14 tactics cover full attack lifecycle",
        "Used for detection, gap analysis, red teaming"
      ],
      "exam_tips": [
        "Focus on understanding concepts, not memorizing details",
        "Expect scenario-based questions that test application of knowledge"
      ],
      "knowledge_check": {
        "question": "What does the MITRE ATT&CK framework primarily document?",
        "options": [
          "Security product ratings",
          "Adversary tactics, techniques, and procedures (TTPs)",
          "Compliance requirements",
          "Network diagrams"
        ],
        "correct_answer": 1,
        "explanation": "MITRE ATT&CK is a knowledge base of adversary tactics and techniques based on real-world observations."
      },
      "memory_hooks": {
        "mnemonics": [
          "ATT&CK = Adversary Tactics, Techniques & Common Knowledge"
        ],
        "analogies": [
          "ATT&CK is like playbook of opponent's plays - know their moves to defend better"
        ]
      },
      "deep_dive": [
        {
          "title": "Building an ATT&CK-Based Detection Program",
          "content": "Systematic approach to ATT&CK detection: 1) Identify priority techniques based on threat intelligence relevant to your organization. 2) Map existing detections to techniques - most organizations are surprised how little coverage they have. 3) Identify gaps, prioritize by risk. 4) Develop detections for priority techniques using SIEM, EDR, NDR. 5) Test detections with atomic tests or red team exercises. 6) Measure and report coverage improvements over time. Tools: ATT&CK Navigator, DeTT&CT, Sigma rules mapped to ATT&CK, Atomic Red Team for testing."
        },
        {
          "title": "ATT&CK for CTI (Cyber Threat Intelligence)",
          "content": "ATT&CK provides common language for threat intelligence. Mapping process: Parse threat reports for behaviors described. Identify techniques matching described behaviors. Document procedures (specific implementations). Track threat actor profiles over time. Share intelligence using ATT&CK references. Benefits: Consistent terminology across reports, actionable intelligence (maps to detections), tracking threat actor evolution, industry sharing with common framework. ATT&CK Workbench allows custom knowledge base management."
        }
      ],
      "career_spotlight": {
        "role": "Threat Intelligence Analyst",
        "daily_tasks": [
          "Mapping threat reports to ATT&CK techniques",
          "Tracking threat actor TTPs",
          "Producing intelligence products for stakeholders",
          "Collaborating with detection engineering on coverage",
          "Presenting threat briefings to leadership"
        ],
        "tools_used": [
          "ATT&CK Navigator",
          "MISP",
          "OpenCTI",
          "ThreatConnect",
          "Maltego"
        ],
        "career_path": "SOC Analyst → Threat Intel Analyst → Senior Analyst → CTI Manager → Threat Intel Director"
      },
      "real_world_example": {
        "title": "APT29 (Cozy Bear) - Technique Mapping in Practice",
        "incident": "APT29's SolarWinds campaign used numerous ATT&CK techniques: T1195.002 (Supply Chain Compromise), T1059.001 (PowerShell), T1078 (Valid Accounts), T1550.001 (Application Access Token), T1071.001 (Web Protocols for C2).",
        "impact": "Understanding the techniques allowed defenders to build specific detections and hunt for indicators of this campaign in their environments.",
        "lesson": "ATT&CK mapping transforms threat reports from interesting reading to actionable intelligence. Organizations could search for specific technique implementations rather than just IOCs that attackers easily change."
      },
      "glossary_terms": [
        {
          "term": "MITRE ATT&CK",
          "definition": "Knowledge base of adversary tactics, techniques, and procedures based on real-world observations",
          "exam_note": "Industry standard framework for threat behavior"
        },
        {
          "term": "Tactic",
          "definition": "The adversary's objective or reason for performing an action (the 'why')",
          "exam_note": "14 tactics in Enterprise matrix from Recon to Impact"
        },
        {
          "term": "Technique",
          "definition": "How an adversary achieves a tactical objective (the 'how')",
          "exam_note": "200+ techniques, some with sub-techniques"
        },
        {
          "term": "Procedure",
          "definition": "Specific implementation of a technique by a threat actor or malware",
          "exam_note": "Real-world examples documented in threat profiles"
        },
        {
          "term": "ATT&CK Navigator",
          "definition": "Tool for visualizing and annotating ATT&CK matrices",
          "exam_note": "Used for coverage mapping and gap analysis"
        }
      ]
    },
    {
      "section_id": "D2-L011-S02",
      "title": "Cyber Kill Chain",
      "estimated_time": "12 minutes",
      "content": "The Lockheed Martin Cyber Kill Chain defines the stages of a cyberattack, providing a framework for understanding and disrupting adversary operations.\n\n**The Seven Phases**\n\n**1. Reconnaissance**\nAttacker researches the target to identify vulnerabilities and entry points.\n\n*Activities:*\n- OSINT gathering (social media, websites, job postings)\n- Email harvesting\n- Network scanning and enumeration\n- Technology identification\n- Employee identification for social engineering\n\n*Defensive Measures:*\n- Minimize public information exposure\n- Monitor for reconnaissance activity\n- Implement honeypots for early warning\n- Employee awareness of information sharing\n\n**2. Weaponization**\nAttacker creates deliverable payload by coupling exploit with backdoor.\n\n*Activities:*\n- Exploit development or acquisition\n- Malware customization\n- Document weaponization (malicious macros, exploits)\n- Creating decoy documents\n\n*Defensive Measures:*\n- Threat intelligence on weaponization trends\n- Difficult to directly defend (attacker activity)\n\n**3. Delivery**\nAttacker transmits weapon to target environment.\n\n*Delivery Methods:*\n- Email attachments\n- Malicious links\n- Watering hole attacks\n- USB drops\n- Supply chain compromise\n\n*Defensive Measures:*\n- Email security gateways\n- Web filtering\n- User awareness training\n- Removable media controls\n\n**4. Exploitation**\nWeapon executes, exploiting vulnerability to gain access.\n\n*Exploitation Targets:*\n- Application vulnerabilities\n- Operating system vulnerabilities\n- Human vulnerabilities (clicking links)\n- Zero-day vulnerabilities\n\n*Defensive Measures:*\n- Patch management\n- Endpoint protection\n- Application whitelisting\n- Disable unnecessary features (macros)\n\n**5. Installation**\nAttacker installs backdoor or implant for persistent access.\n\n*Persistence Mechanisms:*\n- Registry modifications\n- Scheduled tasks\n- Service creation\n- Bootkit/rootkit installation\n- DLL hijacking\n\n*Defensive Measures:*\n- Endpoint detection and response (EDR)\n- File integrity monitoring\n- Application whitelisting\n- Privileged access management\n\n**6. Command and Control (C2)**\nAttacker establishes communication channel with compromised system.\n\n*C2 Techniques:*\n- HTTP/HTTPS callbacks\n- DNS tunneling\n- Social media channels\n- Encrypted channels\n- Domain fronting\n\n*Defensive Measures:*\n- Network monitoring and anomaly detection\n- DNS filtering\n- Proxy inspection\n- Outbound firewall rules\n- Threat intelligence IOC blocking\n\n**7. Actions on Objectives**\nAttacker accomplishes their goal (data theft, destruction, etc.).\n\n*Objectives:*\n- Data exfiltration\n- Data destruction\n- Ransomware deployment\n- Espionage\n- Sabotage\n\n*Defensive Measures:*\n- Data loss prevention\n- Database activity monitoring\n- Encryption\n- Backup and recovery\n- Incident response readiness\n\n**Using the Kill Chain Defensively**\n\n*Intelligence-Driven Defense:*\n- Understand attacker's progression through phases\n- Disrupt attack at any phase to break the chain\n- Earlier disruption is better (left of boom)\n- Defense in depth at each phase\n\n*Kill Chain Analysis:*\n- Map incidents to kill chain phases\n- Identify which phases defenses caught the attack\n- Find gaps where attacks progressed undetected\n- Improve controls at weak phases",
      "must_remember_for_exam": [
        {
          "fact": "7 stages: Recon â†’ Weaponize â†’ Deliver â†’ Exploit â†’ Install â†’ C2 â†’ Actions",
          "why_tested": "Sequence"
        },
        {
          "fact": "Breaking chain at ANY stage stops attack",
          "why_tested": "Defense principle"
        }
      ],
      "key_points": [
        "7 sequential stages from Recon to Actions",
        "Break chain anywhere to stop attack",
        "Earlier detection = less damage"
      ],
      "exam_tips": [
        "Know the three control categories: Technical, Administrative, Physical",
        "Understand control functions: Preventive, Detective, Corrective, Deterrent, Compensating"
      ],
      "knowledge_check": {
        "question": "In the Cyber Kill Chain, which phase involves the attacker delivering a weaponized payload?",
        "options": [
          "Reconnaissance",
          "Delivery",
          "Installation",
          "Actions on Objectives"
        ],
        "correct_answer": 1,
        "explanation": "Delivery is when the attacker transmits the weaponized payload to the target."
      },
      "memory_hooks": {
        "mnemonics": [
          "Kill Chain: RWDEIACA - Recon, Weaponize, Deliver, Exploit, Install, Access, Actions"
        ],
        "analogies": [
          "Kill Chain is burglary plan - case house, prepare tools, approach, break in, establish presence"
        ]
      },
      "deep_dive": [
        {
          "title": "Kill Chain Limitations and Evolutions",
          "content": "Kill Chain criticisms: Linear model doesn't reflect complex attacks, less applicable to insider threats, doesn't address attacks that skip phases (supply chain), assumes goal is breach (not always true). Evolutions: MITRE ATT&CK provides more granular view, Unified Kill Chain combines models, attack graphs show non-linear paths. The Kill Chain remains valuable for understanding attack progression and communicating with leadership, but should be complemented with other frameworks."
        },
        {
          "title": "Left of Boom vs Right of Boom",
          "content": "Military terminology applied to cyber: 'Boom' = successful compromise. Left of Boom (proactive): Reconnaissance, Weaponization, Delivery, Exploitation - prevent the attack. Right of Boom (reactive): Installation, C2, Actions - detect and respond to active breach. Security strategy should address both: Prevention (left) through hardening, awareness, filtering. Detection (right) through monitoring, EDR, threat hunting. Organizations often over-invest in prevention while under-investing in detection/response."
        }
      ],
      "career_spotlight": {
        "role": "Security Operations Center (SOC) Analyst",
        "daily_tasks": [
          "Monitoring alerts and identifying attack phases",
          "Investigating potential compromises",
          "Correlating events across kill chain phases",
          "Escalating confirmed incidents",
          "Documenting findings and response actions"
        ],
        "tools_used": [
          "SIEM",
          "EDR",
          "SOAR",
          "Threat Intel platforms",
          "Packet capture tools"
        ],
        "career_path": "Tier 1 SOC → Tier 2 SOC → Tier 3/Hunt → SOC Lead → SOC Manager"
      },
      "real_world_example": {
        "title": "Sony Pictures Hack (2014) - Kill Chain in Action",
        "incident": "Reconnaissance: Attackers gathered intel on Sony employees. Weaponization: Created destructive malware. Delivery: Spearphishing emails to employees. Exploitation: Compromised credentials. Installation: Deployed wipers and backdoors. C2: Established persistent access. Actions: Destroyed data and leaked confidential information.",
        "impact": "$100+ million in damages, executive resignations, leaked emails caused significant embarrassment, theatrical release disrupted.",
        "lesson": "Breaking the chain at any phase would have limited damage. Email security could have stopped delivery. User awareness could have prevented exploitation. Network monitoring could have detected C2. Defense at every phase matters."
      },
      "glossary_terms": [
        {
          "term": "Cyber Kill Chain",
          "definition": "Seven-phase model of cyberattack progression from reconnaissance to actions on objectives",
          "exam_note": "Lockheed Martin model - know all 7 phases in order"
        },
        {
          "term": "Weaponization",
          "definition": "Phase where attacker combines exploit with payload to create deliverable weapon",
          "exam_note": "Happens before delivery - attacker activity, hard to defend"
        },
        {
          "term": "C2/Command and Control",
          "definition": "Communication channel between attacker and compromised system for ongoing control",
          "exam_note": "Disrupting C2 isolates attacker from compromised systems"
        },
        {
          "term": "Actions on Objectives",
          "definition": "Final kill chain phase where attacker accomplishes their goal",
          "exam_note": "Goal varies: theft, destruction, espionage, ransom"
        },
        {
          "term": "Left of Boom",
          "definition": "Proactive security focus on preventing attacks before compromise occurs",
          "exam_note": "Prevention-focused activities (recon through exploitation)"
        }
      ]
    },
    {
      "section_id": "D2-L011-S03",
      "title": "Diamond Model and Other Frameworks",
      "estimated_time": "10 minutes",
      "content": "Beyond ATT&CK and Kill Chain, several frameworks help analyze and understand cyber threats from different perspectives.\n\n**The Diamond Model of Intrusion Analysis**\n\nThe Diamond Model describes the relationship between four core features of any intrusion:\n\n**Core Features:**\n\n*Adversary*\nThe threat actor conducting the intrusion. Ranges from nation-states to hacktivists to criminals. Understanding adversary helps predict future actions.\n\n*Capability*\nThe tools and techniques used by the adversary. Malware, exploits, infrastructure. May be custom-developed or commodity.\n\n*Infrastructure*\nThe resources used to deliver capability. IP addresses, domains, email accounts. Physical and logical resources.\n\n*Victim*\nThe target of the intrusion. Organizations, individuals, systems. Includes vulnerabilities that enabled the attack.\n\n**Axioms:**\n1. Every intrusion involves adversary, capability, infrastructure, and victim\n2. There's a directional relationship: adversary uses capability via infrastructure against victim\n3. Activities are linked through shared features\n\n**Meta-Features:**\n- Timestamp - when the event occurred\n- Phase - which kill chain phase\n- Result - success or failure\n- Direction - adversary-to-victim or victim-to-adversary\n- Methodology - general approach (spearphishing, watering hole)\n- Resources - what the adversary required\n\n**Using the Diamond Model:**\n\n*Activity Threading*\nConnect related events through shared features. Same malware (capability) in different incidents. Same C2 infrastructure across campaigns. Build understanding of adversary operations.\n\n*Activity Grouping*\nCluster related activities into campaigns. Identify adversary campaigns by shared features. Track adversary evolution over time.\n\n**NIST Cybersecurity Framework**\n\n*Core Functions:*\n1. **Identify** - Asset management, risk assessment, governance\n2. **Protect** - Access control, training, data security\n3. **Detect** - Monitoring, detection processes, anomalies\n4. **Respond** - Response planning, communications, mitigation\n5. **Recover** - Recovery planning, improvements, communications\n\n*Implementation Tiers:*\n- Tier 1: Partial (ad hoc, reactive)\n- Tier 2: Risk Informed (awareness but not organization-wide)\n- Tier 3: Repeatable (formal, organization-wide)\n- Tier 4: Adaptive (continuous improvement, lessons learned)\n\n*Profiles:*\nCurrent state vs target state. Gap analysis for improvement planning.\n\n**Other Notable Frameworks:**\n\n*STRIDE (Threat Modeling)*\n- Spoofing identity\n- Tampering with data\n- Repudiation\n- Information disclosure\n- Denial of service\n- Elevation of privilege\n\n*PASTA (Risk-Centric Threat Modeling)*\nProcess for Attack Simulation and Threat Analysis. Seven-stage methodology for application threat modeling.\n\n*DREAD (Risk Rating - Deprecated)*\n- Damage potential\n- Reproducibility\n- Exploitability\n- Affected users\n- Discoverability\n\n**Selecting Frameworks:**\n- ATT&CK: Detection engineering, threat intelligence\n- Kill Chain: Incident analysis, leadership communication\n- Diamond Model: Threat intelligence, attribution\n- NIST CSF: Program assessment, maturity improvement\n- STRIDE: Application threat modeling",
      "must_remember_for_exam": [
        {
          "fact": "Diamond Model: Adversary, Capability, Infrastructure, Victim",
          "why_tested": "Framework"
        },
        {
          "fact": "OWASP Top 10 = critical web app risks",
          "why_tested": "Standard reference"
        }
      ],
      "key_points": [
        "Diamond Model has 4 vertices for analysis",
        "OWASP Top 10 guides web security priorities"
      ],
      "exam_tips": [
        "SQL injection exploits unvalidated input in database queries",
        "XSS executes malicious scripts in victim's browser"
      ],
      "knowledge_check": {
        "question": "What are the four core components of the Diamond Model?",
        "options": [
          "People, Process, Technology, Data",
          "Adversary, Capability, Infrastructure, Victim",
          "Identify, Protect, Detect, Respond",
          "Confidentiality, Integrity, Availability, Safety"
        ],
        "correct_answer": 1,
        "explanation": "The Diamond Model's four vertices are: Adversary, Capability, Infrastructure, and Victim."
      },
      "memory_hooks": {
        "mnemonics": [
          "Diamond: AVIC - Adversary, Victim, Infrastructure, Capability"
        ],
        "analogies": [
          "Diamond Model is crime investigation board - who, target, tools, resources"
        ]
      },
      "deep_dive": [
        {
          "title": "Combining Frameworks for Comprehensive Analysis",
          "content": "Frameworks complement each other: Kill Chain shows attack progression over time. ATT&CK provides technique-level detail within each phase. Diamond Model adds adversary and infrastructure context. NIST CSF organizes defensive response. Example workflow: Use Kill Chain to structure incident timeline. Map each phase to ATT&CK techniques observed. Apply Diamond Model to link to threat actors. Use NIST CSF to identify defensive improvements. This multi-framework approach provides comprehensive understanding and actionable intelligence."
        },
        {
          "title": "Attribution Using Diamond Model",
          "content": "Diamond Model supports attribution analysis: Shared infrastructure links campaigns. Common capabilities suggest same adversary or tooling source. Victim patterns reveal targeting preferences. Activity threading builds adversary profiles over time. Challenges: False flags (attackers plant misleading evidence), shared tools (commodity malware), infrastructure reuse (bulletproof hosting), nation-state obfuscation. Attribution confidence levels: Unknown, Possible, Probable, Confirmed. Never attribute publicly without high confidence. Intelligence agencies have more data for attribution than private sector."
        }
      ],
      "career_spotlight": {
        "role": "Cyber Threat Intelligence Manager",
        "daily_tasks": [
          "Directing threat intelligence collection and analysis",
          "Briefing executives on threat landscape",
          "Coordinating with detection and response teams",
          "Managing threat intelligence platform",
          "Building relationships with intel sharing partners"
        ],
        "tools_used": [
          "TIP platforms",
          "ATT&CK Navigator",
          "Diamond Model tools",
          "Intelligence databases"
        ],
        "career_path": "Analyst → Senior Analyst → CTI Lead → CTI Manager → CISO or Director of Threat Intel"
      },
      "real_world_example": {
        "title": "Tracking APT Groups Across Campaigns",
        "incident": "Mandiant (now part of Google Cloud) used Diamond Model analysis to track APT1, linking 141+ attacks over 7 years. Shared infrastructure, capabilities (custom malware), and victim targeting patterns revealed a coherent threat actor later attributed to PLA Unit 61398.",
        "impact": "First major public attribution to a specific nation-state unit. Changed how industry discusses nation-state threats. Led to US indictments of Chinese military officers.",
        "lesson": "Long-term tracking of adversary features enables attribution. Infrastructure and capability analysis builds adversary profiles. Multiple data points increase attribution confidence. Sharing threat intelligence multiplies defensive capabilities."
      },
      "glossary_terms": [
        {
          "term": "Diamond Model",
          "definition": "Framework describing intrusions through four features: Adversary, Capability, Infrastructure, Victim",
          "exam_note": "Used for threat intelligence and attribution analysis"
        },
        {
          "term": "NIST CSF",
          "definition": "Cybersecurity Framework with five functions: Identify, Protect, Detect, Respond, Recover",
          "exam_note": "Widely adopted framework for security program management"
        },
        {
          "term": "Activity Threading",
          "definition": "Diamond Model technique connecting related intrusions through shared features",
          "exam_note": "Links campaigns through common infrastructure, capabilities, etc."
        },
        {
          "term": "STRIDE",
          "definition": "Threat modeling mnemonic: Spoofing, Tampering, Repudiation, Information disclosure, DoS, Elevation of privilege",
          "exam_note": "Microsoft-developed, used in application threat modeling"
        },
        {
          "term": "Attribution",
          "definition": "Identifying the threat actor responsible for an intrusion or campaign",
          "exam_note": "Difficult, requires multiple data points, confidence levels vary"
        }
      ]
    }
  ],
  "summary": {
    "exam_essentials": [
      "MITRE ATT&CK: Tactics = WHY, Techniques = HOW",
      "14 ATT&CK tactics from Recon to Impact",
      "Kill Chain: 7 stages, break anywhere to stop attack",
      "Diamond Model: Adversary, Capability, Infrastructure, Victim",
      "TTPs = Tactics, Techniques, Procedures"
    ],
    "connection_to_next": "Frameworks help us think like attackers. The next lesson covers Security Assessments - testing our defenses.",
    "key_takeaways": [
      "MITRE ATT&CK maps adversary tactics, techniques, and procedures (TTPs) across the attack lifecycle",
      "The Cyber Kill Chain defines 7 phases from reconnaissance to actions on objectives",
      "Diamond Model connects adversary, capability, infrastructure, and victim for threat analysis",
      "Frameworks enable common language for threat intelligence sharing and detection engineering",
      "ATT&CK coverage analysis identifies detection gaps against known adversary behaviors"
    ]
  },
  "related_content": {
    "next_lesson": "D2-LESSON-012",
    "previous_lesson": "D2-LESSON-010"
  },
  "hands_on_activity": {
    "title": "MITRE ATT&CK Mapping",
    "objective": "Map an attack scenario to MITRE ATT&CK framework",
    "scenario": "Map each phase of an APT attack to ATT&CK tactics and techniques.",
    "steps": [
      "Read the attack narrative",
      "Identify distinct attack phases",
      "Map each phase to ATT&CK tactic",
      "Identify specific techniques used"
    ],
    "exercises": [
      {
        "phase": "Attacker sent phishing email with malicious Word attachment",
        "tactic": "Initial Access",
        "technique": "T1566.001 - Spearphishing Attachment"
      },
      {
        "phase": "Malware established connection to command and control server",
        "tactic": "Command and Control",
        "technique": "T1071.001 - Application Layer Protocol: Web"
      },
      {
        "phase": "Attacker used Mimikatz to dump credentials from memory",
        "tactic": "Credential Access",
        "technique": "T1003.001 - LSASS Memory"
      },
      {
        "phase": "Moved laterally to domain controller using stolen credentials",
        "tactic": "Lateral Movement",
        "technique": "T1021.001 - Remote Desktop Protocol"
      },
      {
        "phase": "Compressed sensitive files and exfiltrated over HTTPS",
        "tactic": "Exfiltration",
        "technique": "T1041 - Exfiltration Over C2 Channel"
      }
    ],
    "expected_outcome": "Complete ATT&CK mapping for all attack phases",
    "reflection_questions": [
      "How does ATT&CK mapping help detection engineering?",
      "What's the difference between tactics and techniques?",
      "How can you use ATT&CK for security gap analysis?"
    ]
  },
  "what_would_you_do": {
    "scenario": "Your CISO asks you to assess detection coverage against ransomware. You have SIEM, EDR, and network monitoring. You pull a MITRE ATT&CK mapping for recent ransomware groups and find coverage gaps in: Initial Access (T1566-Phishing), Credential Access (T1003-Credential Dumping), and Lateral Movement (T1021-Remote Services).",
    "context": "Budget is limited. You can improve detection in one area this quarter.",
    "question": "Which detection gap do you prioritize?",
    "options": [
      {
        "id": "a",
        "text": "Initial Access (Phishing) - stop them at the door",
        "is_best": false,
        "feedback": "While prevention is ideal, phishing will occasionally succeed despite controls. Defense-in-depth requires detection throughout the kill chain, not just at entry.",
        "consequences": "Phishing detection improved, but attacker gets through with sophisticated lure. No detection of subsequent activity."
      },
      {
        "id": "b",
        "text": "Credential Access - credential theft precedes lateral movement and ransomware deployment",
        "is_best": true,
        "feedback": "Correct! Credential theft is a chokepoint in ransomware attacks. Detecting credential dumping (Mimikatz, LSASS access) catches attackers after initial access but before they can spread.",
        "consequences": "Credential dumping attempt detected. Incident contained to single system. Ransomware deployment prevented."
      },
      {
        "id": "c",
        "text": "Lateral Movement - that's closest to ransomware deployment",
        "is_best": false,
        "feedback": "By lateral movement, attackers have credentials and are spreading. Detection here is valuable but catching credential theft earlier provides more response time.",
        "consequences": "Lateral movement detected but attacker already has domain admin credentials. Containment difficult."
      },
      {
        "id": "d",
        "text": "Fix all three equally - spreading resources across gaps",
        "is_best": false,
        "feedback": "Limited budget spread across three areas means none are done well. Prioritize the highest-value detection gap.",
        "consequences": "All three areas slightly improved. None reach effective detection threshold. Attack succeeds through weakest point."
      }
    ],
    "key_lesson": "Use ATT&CK to prioritize detection investments. Identify chokepoints where most attack paths converge. Credential access is a common chokepoint - nearly all ransomware attacks require credential theft."
  }
}