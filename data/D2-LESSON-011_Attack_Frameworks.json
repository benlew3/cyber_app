{
  "lesson_id": "D2-LESSON-011",
  "domain": 2,
  "title": "Attack Frameworks and Methodologies",
  "subtitle": "Understanding How Attackers Think: MITRE ATT&CK, Kill Chain, and More",
  "version": "2.0-enhanced",
  "objectives_covered": ["2.1"],
  "estimated_duration": "75-90 minutes",
  "difficulty": "intermediate",
  "prerequisites": ["D2-LESSON-001"],

  "skill_tree": {
    "position": {"domain": 2, "sequence": 11, "tier": "intermediate"},
    "prerequisites": [{"lesson_id": "D2-LESSON-001", "title": "Threat Actors", "why_needed": "Frameworks describe actor behaviors"}],
    "unlocks": [{"lesson_id": "D4-LESSON-001", "title": "Security Monitoring", "connection": "Framework-based detection"}]
  },

  "role_relevance": {
    "soc_analyst": {"relevance": "critical", "percentage_of_job": "45-55%", "daily_tasks": ["Map alerts to ATT&CK", "Identify tactics", "Track TTPs"]},
    "incident_responder": {"relevance": "critical", "percentage_of_job": "50-60%", "daily_tasks": ["Trace attack path", "Predict next moves", "Document using frameworks"]},
    "security_engineer": {"relevance": "high", "percentage_of_job": "30-40%", "daily_tasks": ["Design defenses using ATT&CK", "Identify coverage gaps"]},
    "penetration_tester": {"relevance": "critical", "percentage_of_job": "55-65%", "daily_tasks": ["Follow attack methodologies", "Emulate adversary TTPs"]}
  },

  "introduction": {
    "hook": "Attackers follow patterns. Understanding their playbooks—from the Cyber Kill Chain to MITRE ATT&CK—helps defenders anticipate moves, detect intrusions, and respond effectively.",
    "exam_weight": {"estimated_questions": "4-6", "high_yield_topics": ["MITRE ATT&CK structure", "Kill Chain stages", "Diamond Model", "TTPs"]}
  },

  "sections": [
    {
      "section_id": "D2-L011-S01",
      "title": "MITRE ATT&CK Framework",
      "estimated_time": "15 minutes",
      "content": {
        "core_concepts": [
          {
            "concept": "ATT&CK Structure",
            "definition": "Knowledge base of adversary tactics and techniques",
            "components": [
              {"component": "Tactics", "definition": "WHY - the adversary's goal", "count": "14 tactics"},
              {"component": "Techniques", "definition": "HOW - method to achieve goal", "count": "Hundreds"},
              {"component": "Procedures", "definition": "Specific implementation of technique"}
            ]
          },
          {
            "concept": "The 14 Tactics",
            "tactics": [
              "Reconnaissance", "Resource Development", "Initial Access", "Execution",
              "Persistence", "Privilege Escalation", "Defense Evasion", "Credential Access",
              "Discovery", "Lateral Movement", "Collection", "Command and Control",
              "Exfiltration", "Impact"
            ]
          },
          {
            "concept": "ATT&CK Use Cases",
            "uses": [
              {"use": "Threat Intelligence", "description": "Map observed behaviors to known TTPs"},
              {"use": "Detection Development", "description": "Build detections for specific techniques"},
              {"use": "Gap Analysis", "description": "Identify undefended techniques"},
              {"use": "Red Team Planning", "description": "Emulate specific adversaries"}
            ]
          }
        ]
      },
      "must_remember_for_exam": [
        {"fact": "ATT&CK: Tactics = WHY, Techniques = HOW", "why_tested": "Framework structure"},
        {"fact": "14 tactics from Reconnaissance to Impact", "why_tested": "Framework scope"},
        {"fact": "TTPs = Tactics, Techniques, Procedures", "why_tested": "Terminology"}
      ],
      "key_points": ["Tactics = goals (why), Techniques = methods (how)", "14 tactics cover full attack lifecycle", "Used for detection, gap analysis, red teaming"]
    },
    {
      "section_id": "D2-L011-S02",
      "title": "Cyber Kill Chain",
      "estimated_time": "12 minutes",
      "content": {
        "core_concepts": [
          {
            "concept": "Kill Chain Stages",
            "stages": [
              {"stage": "1. Reconnaissance", "description": "Research targets, gather intel"},
              {"stage": "2. Weaponization", "description": "Create attack tools, package exploits"},
              {"stage": "3. Delivery", "description": "Transmit weapon (email, web, USB)"},
              {"stage": "4. Exploitation", "description": "Trigger vulnerability"},
              {"stage": "5. Installation", "description": "Install malware, establish persistence"},
              {"stage": "6. Command & Control", "description": "Establish remote communication"},
              {"stage": "7. Actions on Objectives", "description": "Achieve goals (steal, disrupt)"}
            ]
          },
          {
            "concept": "Defensive Application",
            "principle": "Break the chain at any stage to stop the attack",
            "earlier_is_better": "Earlier detection = less damage"
          }
        ]
      },
      "must_remember_for_exam": [
        {"fact": "7 stages: Recon → Weaponize → Deliver → Exploit → Install → C2 → Actions", "why_tested": "Sequence"},
        {"fact": "Breaking chain at ANY stage stops attack", "why_tested": "Defense principle"}
      ],
      "key_points": ["7 sequential stages from Recon to Actions", "Break chain anywhere to stop attack", "Earlier detection = less damage"]
    },
    {
      "section_id": "D2-L011-S03",
      "title": "Diamond Model and Other Frameworks",
      "estimated_time": "10 minutes",
      "content": {
        "core_concepts": [
          {
            "concept": "Diamond Model of Intrusion Analysis",
            "components": [
              {"vertex": "Adversary", "description": "Who is attacking"},
              {"vertex": "Capability", "description": "Tools and techniques used"},
              {"vertex": "Infrastructure", "description": "Resources (IPs, domains, servers)"},
              {"vertex": "Victim", "description": "Target of the attack"}
            ],
            "use": "Analyze and track intrusion events"
          },
          {
            "concept": "OWASP Top 10",
            "definition": "Most critical web application security risks",
            "use": "Prioritize web security efforts"
          }
        ]
      },
      "must_remember_for_exam": [
        {"fact": "Diamond Model: Adversary, Capability, Infrastructure, Victim", "why_tested": "Framework"},
        {"fact": "OWASP Top 10 = critical web app risks", "why_tested": "Standard reference"}
      ],
      "key_points": ["Diamond Model has 4 vertices for analysis", "OWASP Top 10 guides web security priorities"]
    }
  ],

  "summary": {
    "exam_essentials": [
      "MITRE ATT&CK: Tactics = WHY, Techniques = HOW",
      "14 ATT&CK tactics from Recon to Impact",
      "Kill Chain: 7 stages, break anywhere to stop attack",
      "Diamond Model: Adversary, Capability, Infrastructure, Victim",
      "TTPs = Tactics, Techniques, Procedures"
    ]
  },

  "related_content": {
    "next_lesson": "D2-LESSON-012",
    "previous_lesson": "D2-LESSON-010"
  }
}
