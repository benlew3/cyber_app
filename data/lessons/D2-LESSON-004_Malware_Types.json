{
  "lesson_id": "D2-LESSON-004",
  "domain": 2,
  "title": "Malware Types",
  "objectives_covered": ["2.4"],
  "estimated_duration": "50-60 minutes",
  "difficulty": "beginner",
  "version": "3.0-enhanced",

  "skill_tree": {
    "prerequisites": ["D2-LESSON-002", "D2-LESSON-003"],
    "unlocks": ["D2-LESSON-005", "D2-LESSON-006", "D4-LESSON-001"],
    "cascade_learning": {
      "builds_on": [
        {"lesson": "D2-LESSON-002", "concepts": ["Malware delivered through attack vectors"]},
        {"lesson": "D2-LESSON-003", "concepts": ["Social engineering often delivers malware"]}
      ],
      "enables": [
        {"lesson": "D2-LESSON-005", "concepts": ["Network attacks may deliver or command malware"]},
        {"lesson": "D4-LESSON-001", "concepts": ["Security monitoring detects malware indicators"]}
      ]
    }
  },

  "role_relevance": {
    "soc_analyst": {
      "importance": "critical",
      "daily_tasks": [
        "Identifying malware types from alerts and indicators",
        "Triaging malware infections by severity",
        "Analyzing malware behavior in alerts",
        "Correlating malware indicators across environment"
      ],
      "real_scenario": "EDR alert shows process injection and credential dumping—you recognize RAT behavior and escalate for incident response before lateral movement"
    },
    "incident_responder": {
      "importance": "critical",
      "daily_tasks": [
        "Analyzing malware samples during incidents",
        "Determining malware capabilities and impact",
        "Containing malware spread across network",
        "Removing malware and persistence mechanisms"
      ],
      "real_scenario": "Ransomware incident—you identify ransomware family (Conti), find encryption hasn't started, and contain before data loss"
    },
    "grc_analyst": {
      "importance": "medium",
      "daily_tasks": [
        "Understanding malware trends for risk assessments",
        "Documenting malware protection controls",
        "Assessing anti-malware solution effectiveness",
        "Reporting on malware incidents"
      ],
      "real_scenario": "Board report—you explain ransomware trends, organizational exposure, and effectiveness of current controls"
    },
    "penetration_tester": {
      "importance": "high",
      "daily_tasks": [
        "Developing and using custom malware for engagements",
        "Testing AV/EDR evasion",
        "Simulating malware behaviors ethically",
        "Demonstrating malware impact"
      ],
      "real_scenario": "Red team engagement—you deploy custom C2 implant, demonstrate persistence, and document detection gaps"
    },
    "security_engineer": {
      "importance": "critical",
      "daily_tasks": [
        "Implementing anti-malware solutions",
        "Configuring EDR and behavior-based detection",
        "Tuning malware detection rules",
        "Designing malware-resistant architectures"
      ],
      "real_scenario": "Deploying new EDR solution—you configure behavioral detection, enable memory scanning, and create custom rules for your environment"
    }
  },

  "introduction": {
    "hook": "In 2017, WannaCry ransomware infected 200,000 computers in 150 countries in a single day, including shutting down UK hospitals. In 2020, Emotet—initially a banking trojan—evolved into the most prolific malware distribution network, loading ransomware for hire. Today's malware isn't just viruses—it's sophisticated tools for espionage, extortion, and infrastructure attacks. Understanding malware types is understanding your enemy's weapons.",
    "learning_goals": [
      "Identify and categorize malware types by function",
      "Understand malware delivery and persistence mechanisms",
      "Recognize indicators of common malware families",
      "Apply appropriate defenses for different malware types"
    ],
    "why_it_matters": "Malware is the primary tool attackers use to achieve their goals—from stealing credentials to encrypting data to controlling infrastructure. Identifying malware type helps determine appropriate response, containment, and remediation strategies.",
    "exam_weight": {
      "percentage": "18-22% of Domain 2",
      "question_count": "10-14 questions",
      "question_types": ["Type identification", "Behavior matching", "Indicator recognition", "Defense selection"]
    }
  },

  "sections": [
    {
      "section_id": "D2-L004-S01",
      "title": "Malware Categories by Function",
      "content": "Malware is categorized by its primary function—what it's designed to do.\n\n**Viruses**\n\n*Characteristics:*\n- Requires host file to propagate\n- Attaches to legitimate programs\n- Executes when host runs\n- Self-replicating within system\n\n*Types:* Boot sector, file infector, macro, polymorphic\n\n**Worms**\n\n*Characteristics:*\n- Self-replicating without host file\n- Spreads across networks autonomously\n- Exploits vulnerabilities to propagate\n- Can cause network congestion\n\n*Examples:* WannaCry, NotPetya, Conficker\n\n**Trojans**\n\n*Characteristics:*\n- Disguised as legitimate software\n- Doesn't self-replicate\n- Requires user to execute\n- Delivers payload (RAT, ransomware, etc.)\n\n*Types:* Downloader, dropper, banking trojan\n\n**Ransomware**\n\n*Characteristics:*\n- Encrypts files or locks systems\n- Demands payment for decryption\n- May exfiltrate data first (double extortion)\n- Often delivered by other malware\n\n*Examples:* REvil, Conti, LockBit, Ryuk\n\n**Remote Access Trojans (RATs)**\n\n*Characteristics:*\n- Provides attacker remote control\n- Persistent backdoor access\n- Enables surveillance, data theft\n- Often used by APTs\n\n*Examples:* Cobalt Strike, Emotet, njRAT\n\n**Rootkits**\n\n*Characteristics:*\n- Hides malware and attacker activity\n- Operates at kernel or boot level\n- Extremely difficult to detect/remove\n- Maintains persistent stealth access\n\n*Types:* Kernel mode, bootkit, firmware",

      "memory_hooks": {
        "mnemonics": [
          {
            "name": "VW-TRRR",
            "expansion": "Virus, Worm, Trojan, Ransomware, RAT, Rootkit",
            "usage": "Six primary malware categories"
          },
          {
            "name": "Virus needs a Host, Worm stands alone",
            "expansion": "Key distinction: viruses attach to files, worms self-propagate",
            "usage": "Remember the fundamental difference between viruses and worms"
          }
        ],
        "analogies": [
          {
            "concept": "Malware Types = Disease Types",
            "analogy": "Virus = virus (needs host cell). Worm = bacteria (independent reproduction). Trojan = Trojan horse (disguised invader). Ransomware = kidnapper (holds files hostage). RAT = surveillance bug. Rootkit = cancer (hides within body).",
            "why_it_works": "Medical diseases parallel malware behaviors and spread patterns"
          }
        ],
        "common_mistakes": [
          {
            "mistake": "Using 'virus' as generic term for all malware",
            "correction": "Virus is a specific type that attaches to files. Malware is the broad category. Worms, trojans, ransomware are not viruses.",
            "exam_trap": "Exam distinguishes malware types precisely—know the differences"
          },
          {
            "mistake": "Thinking trojans self-replicate",
            "correction": "Trojans do NOT self-replicate like viruses or worms. They rely on user action to execute and spread (email attachments, fake downloads).",
            "exam_trap": "Self-replication is key differentiator: worms yes, trojans no"
          }
        ]
      },

      "what_would_happen_if": [
        {
          "situation": "Worm exploiting unpatched vulnerability enters network",
          "consequence": "Autonomous spread—infects all vulnerable systems without user interaction. Within hours, entire network compromised. This is how WannaCry spread so fast.",
          "lesson": "Worms spread automatically via vulnerabilities. Patching and segmentation are critical defenses."
        },
        {
          "situation": "Rootkit installed after initial compromise",
          "consequence": "Attacker activity hidden from OS and security tools. Antivirus can't see malware. Persistence survives reboots. Remediation requires OS reinstall or hardware replacement.",
          "lesson": "Rootkits hide at kernel/boot level. Detection requires specialized tools. Often only remediation is wipe and rebuild."
        }
      ],

      "glossary_terms": [
        {
          "term": "Virus",
          "definition": "Malware requiring a host file to propagate, attaching itself to legitimate programs",
          "exam_note": "Needs host file—different from worm which is standalone"
        },
        {
          "term": "Worm",
          "definition": "Self-replicating malware that spreads across networks without requiring a host file",
          "exam_note": "Autonomous spread via network—WannaCry, NotPetya"
        },
        {
          "term": "Trojan",
          "definition": "Malware disguised as legitimate software that delivers malicious payload when executed",
          "exam_note": "Does NOT self-replicate—requires user action"
        },
        {
          "term": "Ransomware",
          "definition": "Malware that encrypts files or locks systems and demands payment for restoration",
          "exam_note": "Modern variants do double extortion (steal data + encrypt)"
        }
      ],

      "knowledge_check": {
        "question": "Security analysts observe malware spreading rapidly across the network, infecting systems without any user interaction by exploiting an SMB vulnerability. What type of malware is this?",
        "options": [
          "Virus that attached to shared files",
          "Worm exploiting network vulnerability",
          "Trojan that users downloaded",
          "Ransomware encrypting files"
        ],
        "correct_answer": 1,
        "explanation": "Worms self-replicate across networks by exploiting vulnerabilities, spreading without user interaction. The autonomous spread via SMB vulnerability describes classic worm behavior (like WannaCry using EternalBlue).",
        "wrong_answer_analysis": {
          "0": "Viruses need host files and don't spread autonomously across networks.",
          "2": "Trojans require user action to execute—don't spread autonomously.",
          "3": "Ransomware is a payload, not a spreading mechanism. Ransomware could be delivered by a worm."
        }
      },

      "must_remember": [
        "Virus needs host file; Worm self-propagates",
        "Trojans don't self-replicate—require user execution",
        "Ransomware often uses double extortion (steal + encrypt)",
        "Rootkits hide at kernel/boot level—very hard to detect/remove"
      ]
    },

    {
      "section_id": "D2-L004-S02",
      "title": "Additional Malware Types",
      "content": "Beyond the primary categories, several specialized malware types exist.\n\n**Spyware**\n\n*Characteristics:*\n- Monitors user activity covertly\n- Captures keystrokes, screenshots, browsing\n- May capture credentials and personal data\n- Often bundled with 'free' software\n\n**Adware**\n\n*Characteristics:*\n- Displays unwanted advertisements\n- May redirect browsing\n- Often bundled with legitimate software\n- Can be gateway to more serious malware\n\n**Keyloggers**\n\n*Characteristics:*\n- Records keystrokes\n- Captures credentials, messages, data\n- Can be software or hardware-based\n- Often component of RATs/spyware\n\n**Cryptominers/Cryptojackers**\n\n*Characteristics:*\n- Uses victim resources for cryptocurrency mining\n- High CPU/GPU usage, slow systems\n- May run in browser (cryptojacking)\n- Financially motivated, less destructive\n\n**Botnet Malware**\n\n*Characteristics:*\n- Compromises system for attacker control\n- Part of distributed network (botnet)\n- Used for DDoS, spam, credential stuffing\n- Often very persistent, hard to remove\n\n**Fileless Malware**\n\n*Characteristics:*\n- Operates entirely in memory\n- No files written to disk\n- Uses legitimate tools (PowerShell, WMI)\n- Evades traditional AV detection\n- May persist through registry, scheduled tasks\n\n**Logic Bombs**\n\n*Characteristics:*\n- Triggered by specific condition (date, event)\n- Dormant until trigger occurs\n- Often planted by insiders\n- Causes damage when activated",

      "memory_hooks": {
        "mnemonics": [
          {
            "name": "SAKCBFL",
            "expansion": "Spyware, Adware, Keylogger, Cryptominer, Botnet, Fileless, Logic bomb",
            "usage": "Seven additional malware types"
          },
          {
            "name": "Fileless = Living off the Land",
            "expansion": "Fileless malware uses built-in OS tools instead of dropping files",
            "usage": "Remember fileless malware abuses legitimate tools like PowerShell"
          }
        ],
        "analogies": [
          {
            "concept": "Botnet = Zombie Army",
            "analogy": "Each infected computer is a 'zombie' controlled by the attacker (botmaster). Thousands of zombies act together for DDoS, spam, or other coordinated attacks.",
            "why_it_works": "Zombie metaphor is established term in security—machines under remote control"
          }
        ],
        "common_mistakes": [
          {
            "mistake": "Dismissing adware as harmless annoyance",
            "correction": "Adware often bundles with other malware, may modify browser security settings, and creates attack surface. Treat it as potential threat.",
            "exam_trap": "Adware can be gateway to more serious malware"
          },
          {
            "mistake": "Assuming traditional AV catches all malware",
            "correction": "Fileless malware, living-off-the-land techniques, and memory-only threats evade signature-based AV. Need behavior-based EDR.",
            "exam_trap": "Fileless malware evades traditional AV—requires behavioral detection"
          }
        ]
      },

      "what_would_happen_if": [
        {
          "situation": "Cryptominer malware infects organization's servers",
          "consequence": "Server CPU at 100%. Applications slow or unresponsive. Electricity bills spike. Users complain. Attacker profits from your resources. Less destructive than ransomware but still costly.",
          "lesson": "Cryptominers steal computational resources. Monitor for unusual CPU/GPU usage."
        },
        {
          "situation": "Attacker uses only PowerShell and WMI for post-exploitation",
          "consequence": "No malware files to detect. Traditional AV sees nothing. Attacker moves laterally using legitimate admin tools. Called 'living off the land' because they use your tools.",
          "lesson": "Fileless techniques require behavioral detection—monitoring what tools DO, not what files exist."
        }
      ],

      "glossary_terms": [
        {
          "term": "Spyware",
          "definition": "Malware that covertly monitors user activity and collects information",
          "exam_note": "Captures keystrokes, screenshots, browsing history"
        },
        {
          "term": "Botnet",
          "definition": "Network of compromised computers controlled remotely for coordinated malicious activity",
          "exam_note": "Used for DDoS, spam, credential stuffing"
        },
        {
          "term": "Fileless Malware",
          "definition": "Malware operating entirely in memory without writing files to disk",
          "exam_note": "Uses legitimate tools (PowerShell)—evades traditional AV"
        },
        {
          "term": "Logic Bomb",
          "definition": "Malicious code that activates when specific condition is met",
          "exam_note": "Often planted by insiders—triggers on date or event"
        }
      ],

      "knowledge_check": {
        "question": "Incident responders discover attackers are executing malicious commands using only PowerShell and WMI, with no malware files found on disk. What type of attack is this?",
        "options": [
          "Virus infection hiding in system files",
          "Trojan downloaded to temp folder",
          "Fileless malware using living-off-the-land techniques",
          "Rootkit hiding the malware files"
        ],
        "correct_answer": 2,
        "explanation": "Fileless malware operates entirely in memory using legitimate system tools like PowerShell and WMI. No files are written to disk, making traditional file-based detection ineffective. This 'living off the land' approach uses the victim's own tools.",
        "wrong_answer_analysis": {
          "0": "Viruses write to files—the scenario explicitly states no files found.",
          "1": "Trojans are file-based—no files were found on disk.",
          "3": "Rootkits hide files but files still exist. Here, no files exist at all—it's memory-only."
        }
      },

      "must_remember": [
        "Fileless malware = memory only, uses PowerShell/WMI (living off the land)",
        "Botnets = networks of compromised 'zombie' computers",
        "Cryptominers steal CPU/GPU resources, not data",
        "Logic bombs are triggered by conditions—often insider threats"
      ]
    },

    {
      "section_id": "D2-L004-S03",
      "title": "Malware Delivery and Persistence",
      "content": "Understanding how malware arrives and maintains access informs defensive strategies.\n\n**Delivery Mechanisms**\n\n*Email:*\n- Malicious attachments (Office macros, PDFs)\n- Links to malware downloads\n- Drive-by download sites in emails\n\n*Web:*\n- Compromised legitimate sites\n- Malicious advertisements\n- Fake software downloads\n- Watering hole attacks\n\n*Removable Media:*\n- Infected USB drives\n- USB drop attacks\n- Autorun exploitation\n\n*Network:*\n- Exploitation of vulnerabilities\n- Lateral movement from compromised systems\n- Supply chain compromise\n\n**Persistence Mechanisms**\n\n*Registry:*\n- Run/RunOnce keys\n- Services registration\n- Scheduled tasks entries\n\n*File System:*\n- Startup folder files\n- Modified legitimate executables\n- DLL hijacking\n\n*Boot Process:*\n- MBR/VBR modification\n- UEFI implants\n- Bootkit installation\n\n*Scheduled Tasks/Services:*\n- Scheduled task creation\n- Service installation\n- WMI event subscriptions\n\n**Evasion Techniques**\n\n*Anti-Analysis:*\n- VM/sandbox detection\n- Debugger detection\n- Code obfuscation\n\n*Detection Evasion:*\n- Polymorphic/metamorphic code\n- Packing and encryption\n- Process injection\n- Timestamp manipulation",

      "memory_hooks": {
        "mnemonics": [
          {
            "name": "EWNR Delivery",
            "expansion": "Email, Web, Network, Removable media",
            "usage": "Four primary malware delivery vectors"
          },
          {
            "name": "RFBS Persistence",
            "expansion": "Registry, File system, Boot process, Scheduled tasks/Services",
            "usage": "Four main persistence mechanisms"
          }
        ],
        "analogies": [
          {
            "concept": "Persistence = Keeping a Key to the House",
            "analogy": "Initial infection gets you in the door. Persistence is making a copy of the key so you can return anytime, even if they change the locks (reboot). Registry entries, scheduled tasks, and boot modifications are all copies of the key.",
            "why_it_works": "House key analogy makes persistence concept tangible"
          }
        ],
        "common_mistakes": [
          {
            "mistake": "Thinking malware is gone after killing the process",
            "correction": "Persistence mechanisms ensure malware returns after reboot. Must identify and remove all persistence—registry, scheduled tasks, services, startup items.",
            "exam_trap": "Full remediation requires removing persistence, not just active malware"
          },
          {
            "mistake": "Relying on AV for fileless malware",
            "correction": "Fileless malware evades file-based signatures. Need behavioral detection (EDR), script logging, and process monitoring.",
            "exam_trap": "Fileless requires behavior-based, not signature-based detection"
          }
        ]
      },

      "what_would_happen_if": [
        {
          "situation": "Incident response team removes malware files but misses scheduled task persistence",
          "consequence": "Scheduled task runs at next trigger time, re-downloads and reinstalls malware. Back to square one. Incomplete remediation lets attacker return.",
          "lesson": "Must identify and remove ALL persistence mechanisms during remediation."
        },
        {
          "situation": "Malware detects it's running in a sandbox and stops execution",
          "consequence": "Sandbox analysis shows 'clean' file. Malware passes security check. When executed on real system, activates malicious functionality. Anti-analysis succeeds.",
          "lesson": "Sophisticated malware detects analysis environments. Multiple analysis techniques needed."
        }
      ],

      "glossary_terms": [
        {
          "term": "Persistence",
          "definition": "Mechanism allowing malware to maintain access across system restarts",
          "exam_note": "Registry keys, scheduled tasks, services, boot sector"
        },
        {
          "term": "Process Injection",
          "definition": "Technique of running malicious code within legitimate process memory",
          "exam_note": "Evasion technique—hides in legitimate process"
        },
        {
          "term": "Polymorphic Malware",
          "definition": "Malware that changes its code each time it replicates to evade signatures",
          "exam_note": "Each copy looks different—signature detection fails"
        },
        {
          "term": "DLL Hijacking",
          "definition": "Technique exploiting DLL search order to load malicious library",
          "exam_note": "Persistence via legitimate application loading malicious DLL"
        }
      ],

      "knowledge_check": {
        "question": "After a malware incident, the security team deletes the malware executable and confirms it's no longer running. Two days later, the same malware reappears. What did they miss?",
        "options": [
          "The malware was polymorphic",
          "The network isn't properly segmented",
          "The malware's persistence mechanism",
          "The malware signature in AV database"
        ],
        "correct_answer": 2,
        "explanation": "The malware had a persistence mechanism (likely registry, scheduled task, or service) that reinstalled it. Deleting the executable without removing persistence allows the malware to return. Full remediation requires identifying and removing all persistence.",
        "wrong_answer_analysis": {
          "0": "Polymorphic code changes signatures but doesn't explain reappearance after deletion.",
          "1": "Network segmentation affects spread, not persistence on a single system.",
          "3": "AV signatures help detection, not explaining why deleted malware returned."
        }
      },

      "must_remember": [
        "RFBS persistence: Registry, File system, Boot process, Scheduled tasks/Services",
        "Must remove ALL persistence mechanisms for complete remediation",
        "Fileless malware evades file-based detection",
        "Sophisticated malware detects sandboxes and analysis environments"
      ]
    },

    {
      "section_id": "D2-L004-S04",
      "title": "Malware Defense and Detection",
      "content": "Layered defenses address malware at multiple stages of attack lifecycle.\n\n**Prevention Controls**\n\n*Endpoint Protection:*\n- Antivirus/Anti-malware\n- EDR (Endpoint Detection and Response)\n- Application whitelisting\n- Host-based firewall\n\n*Email Security:*\n- Attachment filtering\n- Link rewriting and sandboxing\n- Macro blocking\n- Impersonation protection\n\n*Network Security:*\n- Web filtering\n- Network segmentation\n- DNS filtering\n- IPS/IDS\n\n**Detection Approaches**\n\n*Signature-Based:*\n- Known malware patterns\n- Fast detection of known threats\n- Fails against new/modified malware\n\n*Behavior-Based:*\n- Monitors actions, not files\n- Detects fileless and new malware\n- May have higher false positives\n\n*Heuristic:*\n- Rules detecting suspicious characteristics\n- Catches variants and new malware\n- Balance between detection and false positives\n\n*Machine Learning:*\n- Pattern recognition from training data\n- Adapts to new threats\n- Requires good training data\n\n**Response Actions**\n\n*Immediate:*\n- Isolate infected systems\n- Preserve evidence\n- Block indicators (IPs, domains, hashes)\n\n*Investigation:*\n- Determine scope of infection\n- Identify persistence mechanisms\n- Understand attacker objectives\n\n*Remediation:*\n- Remove malware and persistence\n- Restore from clean backups\n- Patch exploited vulnerabilities",

      "memory_hooks": {
        "mnemonics": [
          {
            "name": "SBHM Detection",
            "expansion": "Signature, Behavior, Heuristic, Machine learning",
            "usage": "Four malware detection approaches"
          },
          {
            "name": "Prevention → Detection → Response",
            "expansion": "Defense in depth: try to prevent, detect what gets through, respond quickly",
            "usage": "Layered defense approach to malware"
          }
        ],
        "analogies": [
          {
            "concept": "Detection Types = Security Guards",
            "analogy": "Signature = guard with mugshots (catches known criminals). Behavior = guard watching for suspicious actions (catches unknown criminals acting suspiciously). Heuristic = guard with profile of 'likely criminal' characteristics. ML = guard who learns from experience.",
            "why_it_works": "Security guard types parallel detection methodologies"
          }
        ],
        "common_mistakes": [
          {
            "mistake": "Relying only on signature-based AV",
            "correction": "Signatures only catch known malware. New, modified, or fileless malware evades signatures. Need behavior-based EDR alongside AV.",
            "exam_trap": "Know signature vs behavior detection limitations"
          },
          {
            "mistake": "Not isolating infected systems immediately",
            "correction": "Infected systems may spread malware, exfiltrate data, or receive commands. Isolate first, investigate second.",
            "exam_trap": "Isolation is critical first response step for malware"
          }
        ]
      },

      "what_would_happen_if": [
        {
          "situation": "Organization relies only on signature-based antivirus",
          "consequence": "Zero-day malware, custom tools, and fileless attacks go undetected. Attackers know to modify malware slightly to evade signatures. Security is reactive, not proactive.",
          "lesson": "Signature + behavior-based detection. EDR complements traditional AV."
        },
        {
          "situation": "Malware detected but infected system not immediately isolated",
          "consequence": "Malware spreads to additional systems. Data continues to exfiltrate. Attacker maintains foothold. Scope of incident expands while you investigate.",
          "lesson": "Isolate immediately, investigate later. Containment prevents scope expansion."
        }
      ],

      "glossary_terms": [
        {
          "term": "EDR (Endpoint Detection and Response)",
          "definition": "Advanced endpoint security providing detection, investigation, and response capabilities",
          "exam_note": "Goes beyond AV—includes behavioral detection and response"
        },
        {
          "term": "Signature-Based Detection",
          "definition": "Detection method using known patterns/signatures to identify malware",
          "exam_note": "Fast for known threats, fails against new/modified malware"
        },
        {
          "term": "Behavior-Based Detection",
          "definition": "Detection method analyzing actions and behaviors rather than file signatures",
          "exam_note": "Catches fileless and unknown malware—more false positives"
        },
        {
          "term": "Application Whitelisting",
          "definition": "Security control allowing only approved applications to execute",
          "exam_note": "Strong prevention control—only known-good can run"
        }
      ],

      "knowledge_check": {
        "question": "An organization's antivirus (signature-based) fails to detect new malware that uses PowerShell to execute in memory. What additional control would BEST detect this threat?",
        "options": [
          "Updated antivirus signatures",
          "Behavior-based EDR solution",
          "Stronger firewall rules",
          "Enhanced email filtering"
        ],
        "correct_answer": 1,
        "explanation": "Behavior-based EDR monitors what applications and scripts DO, not what files exist. It would detect suspicious PowerShell behavior (downloading payloads, executing encoded commands) even without file signatures. This addresses fileless malware that evades signature-based AV.",
        "wrong_answer_analysis": {
          "0": "Updated signatures won't help against fileless malware with no files to sign.",
          "2": "Firewall rules filter network traffic but don't detect memory-based malware.",
          "3": "Email filtering prevents delivery but doesn't detect post-compromise activity."
        }
      },

      "must_remember": [
        "SBHM: Signature, Behavior, Heuristic, Machine learning detection",
        "EDR provides behavioral detection that AV misses",
        "Isolate infected systems immediately before investigation",
        "Application whitelisting = strong prevention (only approved apps run)"
      ]
    }
  ],

  "summary": {
    "key_takeaways": [
      "Virus needs host; Worm self-propagates; Trojan requires user action",
      "Fileless malware operates in memory using legitimate tools",
      "RFBS persistence: Registry, File system, Boot process, Scheduled tasks",
      "Signature detection catches known threats; behavior catches unknown",
      "EDR complements AV for comprehensive endpoint protection"
    ],
    "exam_focus": "Malware type identification, delivery/persistence mechanisms, detection approaches, defense strategies",
    "next_lesson": "D2-LESSON-005: Network Attacks—exploiting network protocols and services"
  }
}
