{
  "lesson_id": "D2-LESSON-004",
  "domain": 2,
  "title": "Malware Types and Characteristics",
  "subtitle": "Understanding Malicious Software to Defend Against It",
  "version": "2.0",
  "objectives_covered": [
    "2.4"
  ],
  "estimated_duration": "60-75 minutes",
  "difficulty": "intermediate",
  "prerequisites": [
    "D2-LESSON-001"
  ],
  "role_relevance": {
    "soc_analyst": {
      "relevance": "critical",
      "daily_tasks": [
        "Identify malware type from alerts",
        "Triage malware incidents",
        "Analyze malware behavior"
      ]
    },
    "incident_responder": {
      "relevance": "critical",
      "daily_tasks": [
        "Contain malware spread",
        "Identify malware capabilities",
        "Determine remediation steps"
      ]
    },
    "grc_analyst": {
      "relevance": "medium",
      "daily_tasks": [
        "Report on malware incidents",
        "Assess malware risk"
      ]
    },
    "penetration_tester": {
      "relevance": "high",
      "daily_tasks": [
        "Understand malware techniques",
        "Simulate malware behavior",
        "Test detection capabilities"
      ]
    },
    "security_engineer": {
      "relevance": "critical",
      "daily_tasks": [
        "Deploy anti-malware tools",
        "Configure EDR",
        "Build detection rules"
      ]
    }
  },
  "introduction": {
    "hook": "In May 2017, WannaCry ransomware spread to 200,000+ computers in 150 countries within 24 hours - crippling hospitals, shutting down factories, and costing billions in damages. It combined worm propagation (spreading automatically) with ransomware payload (encrypting files for ransom). Understanding malware types isn't academic - it determines how fast threats spread, what damage they cause, and how to stop them. The same defenses don't work for viruses, worms, and trojans.",
    "learning_goals": [
      "Classify malware by type: viruses, worms, trojans, ransomware, spyware, rootkits",
      "Distinguish between malware propagation methods and payloads",
      "Identify indicators of malware infection by type",
      "Apply appropriate prevention and remediation strategies for each malware type",
      "Understand modern malware trends including fileless and living-off-the-land techniques"
    ]
  },
  "sections": [
    {
      "title": "Malware Classification Fundamentals",
      "content": "Malware (malicious software) is classified by how it spreads (propagation) and what it does (payload). Propagation types: Viruses require host files and user action to spread. Worms self-replicate across networks without user interaction. Trojans disguise as legitimate software. Payload types: Ransomware encrypts for ransom. Spyware steals information. Rootkits hide malware presence. Understanding both aspects is crucial - WannaCry was a WORM (propagation) with RANSOMWARE (payload).\n\nUnderstanding these concepts is critical for exam success and real-world application. Security professionals encounter these scenarios regularly, making mastery essential. The key aspects to remember include: Malware classification: Propagation method + Payload type. Additionally, Propagation: How malware spreads (virus, worm, trojan) represents another crucial element. Organizations implementing these practices see measurable improvements in their security posture. Regular review and hands-on practice reinforce these concepts for long-term retention.",
      "key_points": [
        "Malware classification: Propagation method + Payload type",
        "Propagation: How malware spreads (virus, worm, trojan)",
        "Payload: What malware does (ransomware, spyware, backdoor)",
        "Same payload can use different propagation methods",
        "Classification determines defensive strategy"
      ],
      "memory_hooks": {
        "mnemonics": [
          {
            "term": "Malware Types",
            "mnemonic": "VWTRRS = Virus, Worm, Trojan, Ransomware, Rootkit, Spyware",
            "explanation": "Major malware categories"
          },
          {
            "term": "Propagation vs Payload",
            "mnemonic": "Propagation = HOW it spreads, Payload = WHAT it does",
            "explanation": "Two dimensions of malware classification"
          }
        ],
        "common_mistakes": [
          {
            "mistake": "Confusing propagation method with payload",
            "why_wrong": "Ransomware can spread via virus, worm, or trojan methods. The encryption payload is separate from how it arrived.",
            "correct_understanding": "Classify by BOTH propagation (how it spreads) and payload (what it does). WannaCry = worm + ransomware.",
            "exam_trap": "Malware has both propagation method AND payload - know both"
          },
          {
            "mistake": "Thinking antivirus catches all malware",
            "why_wrong": "Traditional AV uses signatures for KNOWN malware. Zero-days, fileless malware, and novel threats evade it.",
            "correct_understanding": "Layer defenses: AV for known threats + EDR for behavioral detection + application control for unknown execution.",
            "exam_trap": "AV catches known malware; behavioral analysis catches unknown"
          }
        ]
      },
      "knowledge_check": [
        {
          "question": "What two aspects define malware classification?",
          "answer": "Propagation method (how it spreads) and payload (what it does)",
          "explanation": "A worm that encrypts files is classified by both its self-replication (propagation) and ransomware behavior (payload)."
        },
        {
          "question": "Explain the significance of: Propagation: How malware spreads (virus, worm, trojan)...",
          "answer": "This concept is important because it directly impacts security operations and exam performance.",
          "explanation": "Understanding Propagation: How malware spreads (virus, helps security professionals make better decisions."
        },
        {
          "question": "Explain the significance of: Payload: What malware does (ransomware, spyware, backdoor)...",
          "answer": "This concept is important because it directly impacts security operations and exam performance.",
          "explanation": "Understanding Payload: What malware does (ransomware, helps security professionals make better decisions."
        },
        {
          "question": "Why is it problematic to: Confusing propagation method with payload?",
          "answer": "Ransomware can spread via virus, worm, or trojan methods. The encryption payload is separate from how it arrived.",
          "explanation": "Classify by BOTH propagation (how it spreads) and payload (what it does). WannaCry = worm + ransomware."
        }
      ]
    },
    {
      "title": "Viruses and Worms",
      "content": "Viruses and worms are both self-replicating, but differ critically in HOW they spread. Viruses attach to host files (executables, documents, boot sectors) and require user action to activate - opening infected files, running infected programs. Worms are standalone programs that self-replicate across networks WITHOUT user interaction, exploiting vulnerabilities to spread automatically. This makes worms far more dangerous for rapid spread - they don't need humans to propagate.\n\nUnderstanding these concepts is critical for exam success and real-world application. Security professionals encounter these scenarios regularly, making mastery essential. The key aspects to remember include: Virus: Requires host file + user action to spread. Additionally, Worm: Self-replicates across networks WITHOUT user action represents another crucial element. Organizations implementing these practices see measurable improvements in their security posture. Regular review and hands-on practice reinforce these concepts for long-term retention.",
      "key_points": [
        "Virus: Requires host file + user action to spread",
        "Worm: Self-replicates across networks WITHOUT user action",
        "Virus types: File, Boot sector, Macro, Polymorphic, Metamorphic",
        "Worms exploit network vulnerabilities for automatic spread",
        "Worms spread faster because they don't need user interaction"
      ],
      "memory_hooks": {
        "mnemonics": [
          {
            "term": "Virus vs Worm",
            "mnemonic": "Virus = needs a host (like biological virus), Worm = independent (like earthworm)",
            "explanation": "Viruses need files to attach to; worms are standalone"
          },
          {
            "term": "Worm Danger",
            "mnemonic": "Worm = No user needed = Network-wide spread in minutes",
            "explanation": "Worms spread faster because they're automatic"
          }
        ],
        "common_mistakes": [
          {
            "mistake": "Using 'virus' as a generic term for all malware",
            "why_wrong": "Technically, viruses are specific malware that attach to host files. Worms, trojans, and ransomware are different.",
            "correct_understanding": "Use specific terms: virus (needs host), worm (self-replicating), trojan (disguised), ransomware (encrypts for ransom).",
            "exam_trap": "Know the specific definition of virus vs general malware"
          },
          {
            "mistake": "Thinking email attachments always spread viruses",
            "why_wrong": "Email can spread viruses (infected attachments), worms (vulnerability exploits), or trojans (disguised executables).",
            "correct_understanding": "Email is a DELIVERY mechanism. The malware type depends on how it behaves after delivery.",
            "exam_trap": "Delivery method is separate from malware classification"
          }
        ]
      },
      "knowledge_check": [
        {
          "question": "Why do worms typically spread faster than viruses?",
          "answer": "Worms self-replicate across networks automatically without requiring user interaction, while viruses need users to open infected files",
          "explanation": "Worm propagation is automatic; virus propagation depends on user actions."
        },
        {
          "question": "Explain the significance of: Worm: Self-replicates across networks WITHOUT user action...",
          "answer": "This concept is important because it directly impacts security operations and exam performance.",
          "explanation": "Understanding Worm: Self-replicates across networks WI helps security professionals make better decisions."
        },
        {
          "question": "Explain the significance of: Virus types: File, Boot sector, Macro, Polymorphic, Metamorp...",
          "answer": "This concept is important because it directly impacts security operations and exam performance.",
          "explanation": "Understanding Virus types: File, Boot sector, Macro, P helps security professionals make better decisions."
        },
        {
          "question": "Why is it problematic to: Using 'virus' as a generic term for all malware?",
          "answer": "Technically, viruses are specific malware that attach to host files. Worms, trojans, and ransomware are different.",
          "explanation": "Use specific terms: virus (needs host), worm (self-replicating), trojan (disguised), ransomware (encrypts for ransom)."
        }
      ]
    },
    {
      "title": "Trojans, Ransomware, and Rootkits",
      "content": "Trojans disguise as legitimate software to trick users into installing them - like the mythological Trojan Horse. Once installed, they execute malicious payloads (backdoors, spyware, downloaders). Ransomware encrypts files and demands payment, with modern variants using 'double extortion' - stealing data before encrypting to threaten public release. Rootkits hide malware presence by modifying the OS, making detection extremely difficult. They persist across reboots and can hide files, processes, and network connections.\n\nUnderstanding these concepts is critical for exam success and real-world application. Security professionals encounter these scenarios regularly, making mastery essential. The key aspects to remember include: Trojans: Disguised as legitimate software, trick users into installing. Additionally, RATs (Remote Access Trojans): Provide remote control to attackers represents another crucial element. Organizations implementing these practices see measurable improvements in their security posture. Regular review and hands-on practice reinforce these concepts for long-term retention.",
      "key_points": [
        "Trojans: Disguised as legitimate software, trick users into installing",
        "RATs (Remote Access Trojans): Provide remote control to attackers",
        "Ransomware: Encrypts files for ransom, double extortion adds data theft",
        "Rootkits: Modify OS to hide malware presence, extremely persistent",
        "Bootkit: Rootkit that infects boot process, survives OS reinstall"
      ],
      "memory_hooks": {
        "mnemonics": [
          {
            "term": "Trojan Definition",
            "mnemonic": "Trojan = Tricks you into installing it (like the Greek horse)",
            "explanation": "Trojans rely on deception for initial access"
          },
          {
            "term": "Double Extortion",
            "mnemonic": "Modern ransomware: Steal THEN Encrypt (two threats)",
            "explanation": "Attackers exfiltrate data before encrypting for additional leverage"
          }
        ],
        "common_mistakes": [
          {
            "mistake": "Thinking ransomware is only about encryption",
            "why_wrong": "Modern ransomware steals data BEFORE encrypting. Even if you restore from backup, they threaten to publish stolen data.",
            "correct_understanding": "Double extortion means you face both data loss AND data exposure. Backups alone don't solve modern ransomware.",
            "exam_trap": "Know double extortion - data theft + encryption"
          },
          {
            "mistake": "Expecting antivirus to detect rootkits",
            "why_wrong": "Rootkits hide at OS level, below where AV operates. They can hide their own files and processes from security tools.",
            "correct_understanding": "Rootkit detection requires specialized tools, behavioral analysis, or booting from clean media.",
            "exam_trap": "Rootkits hide from normal security tools"
          }
        ]
      },
      "knowledge_check": [
        {
          "question": "Why is 'double extortion' ransomware more dangerous than traditional ransomware?",
          "answer": "Double extortion steals data before encrypting, so even restoring from backup doesn't prevent data exposure threats",
          "explanation": "Attackers have two leverage points: encrypted files AND stolen data they threaten to publish."
        },
        {
          "question": "Explain the significance of: RATs (Remote Access Trojans): Provide remote control to atta...",
          "answer": "This concept is important because it directly impacts security operations and exam performance.",
          "explanation": "Understanding RATs (Remote Access Trojans): Provide re helps security professionals make better decisions."
        },
        {
          "question": "Explain the significance of: Ransomware: Encrypts files for ransom, double extortion adds...",
          "answer": "This concept is important because it directly impacts security operations and exam performance.",
          "explanation": "Understanding Ransomware: Encrypts files for ransom, d helps security professionals make better decisions."
        },
        {
          "question": "Why is it problematic to: Thinking ransomware is only about encryption?",
          "answer": "Modern ransomware steals data BEFORE encrypting. Even if you restore from backup, they threaten to publish stolen data.",
          "explanation": "Double extortion means you face both data loss AND data exposure. Backups alone don't solve modern ransomware."
        }
      ]
    },
    {
      "title": "Modern Malware Techniques",
      "content": "Modern malware increasingly uses 'fileless' and 'living-off-the-land' techniques to evade detection. Fileless malware operates entirely in memory without writing to disk, evading file-based scanning. Living-off-the-land uses legitimate system tools (PowerShell, WMI, certutil) for malicious purposes - these tools are already trusted, so their use doesn't trigger alerts. Polymorphic malware changes its code with each infection while maintaining functionality. These techniques make traditional signature-based detection ineffective.\n\nUnderstanding these concepts is critical for exam success and real-world application. Security professionals encounter these scenarios regularly, making mastery essential. The key aspects to remember include: Fileless malware: Runs in memory only, no files to scan. Additionally, Living-off-the-land: Uses legitimate tools (PowerShell, WMI) maliciously represents another crucial element. Organizations implementing these practices see measurable improvements in their security posture. Regular review and hands-on practice reinforce these concepts for long-term retention.",
      "key_points": [
        "Fileless malware: Runs in memory only, no files to scan",
        "Living-off-the-land: Uses legitimate tools (PowerShell, WMI) maliciously",
        "Polymorphic: Changes code signature with each infection",
        "Metamorphic: Completely rewrites code while maintaining function",
        "Detection requires behavioral analysis, not just file scanning"
      ],
      "memory_hooks": {
        "mnemonics": [
          {
            "term": "Fileless Evasion",
            "mnemonic": "No file = No signature = No detection (by traditional AV)",
            "explanation": "Fileless malware evades file-based scanning"
          },
          {
            "term": "LOLBins",
            "mnemonic": "LOLBins = Living Off the Land Binaries (built-in tools used maliciously)",
            "explanation": "Attackers use legitimate system tools to avoid detection"
          }
        ],
        "common_mistakes": [
          {
            "mistake": "Relying on file-based detection for modern malware",
            "why_wrong": "Fileless malware never touches disk. Living-off-the-land uses trusted binaries. No malicious files to detect.",
            "correct_understanding": "Modern detection requires behavioral analysis, memory scanning, and command-line logging.",
            "exam_trap": "Know that modern malware evades file-based detection"
          },
          {
            "mistake": "Blocking PowerShell to stop attacks",
            "why_wrong": "PowerShell is required for legitimate administration. Blocking it breaks operations. Attackers use other LOLBins anyway.",
            "correct_understanding": "Log and monitor PowerShell, use constrained language mode, detect suspicious commands.",
            "exam_trap": "Monitor LOLBins rather than blocking them"
          }
        ]
      },
      "knowledge_check": [
        {
          "question": "Why is fileless malware difficult to detect with traditional antivirus?",
          "answer": "Traditional AV scans files on disk, but fileless malware operates only in memory without creating files to scan",
          "explanation": "No file means no signature match. Detection requires memory analysis or behavioral detection."
        },
        {
          "question": "Explain the significance of: Living-off-the-land: Uses legitimate tools (PowerShell, WMI)...",
          "answer": "This concept is important because it directly impacts security operations and exam performance.",
          "explanation": "Understanding Living-off-the-land: Uses legitimate too helps security professionals make better decisions."
        },
        {
          "question": "Explain the significance of: Polymorphic: Changes code signature with each infection...",
          "answer": "This concept is important because it directly impacts security operations and exam performance.",
          "explanation": "Understanding Polymorphic: Changes code signature with helps security professionals make better decisions."
        },
        {
          "question": "Why is it problematic to: Relying on file-based detection for modern malware?",
          "answer": "Fileless malware never touches disk. Living-off-the-land uses trusted binaries. No malicious files to detect.",
          "explanation": "Modern detection requires behavioral analysis, memory scanning, and command-line logging."
        }
      ]
    }
  ],
  "summary": {
    "key_takeaways": [
      "Classify malware by propagation (virus/worm/trojan) AND payload (ransomware/spyware/etc.)",
      "Viruses need hosts and user action; worms self-replicate automatically",
      "Modern ransomware uses double extortion: steal data then encrypt",
      "Rootkits hide at OS level, evading normal detection tools",
      "Fileless and living-off-the-land techniques evade file-based detection"
    ],
    "exam_tips": [
      "Virus = needs host file + user action, Worm = standalone + automatic spread",
      "Trojan = disguised as legitimate software",
      "Double extortion = data theft + encryption",
      "Rootkits hide below normal AV detection",
      "Fileless malware requires behavioral detection"
    ]
  },
  "skill_tree": {
    "prerequisites": [
      "D2-LESSON-001"
    ],
    "unlocks": [],
    "related_topics": []
  },
  "hands_on_activity": {
    "title": "Practice: Malware Types and Characteristics",
    "description": "Apply the concepts from this lesson in a hands-on exercise.",
    "objectives": [
      "Classify malware by type: viruses, worms, trojans, ransomware, spyware, rootkits",
      "Distinguish between malware propagation methods and payloads",
      "Identify indicators of malware infection by type"
    ]
  },
  "what_would_you_do": {
    "scenario": "You are a security analyst encountering a situation involving malware types and characteristics. How would you apply what you learned?",
    "considerations": [
      "Assess the situation",
      "Apply appropriate techniques",
      "Document your actions"
    ]
  },
  "related_content": {
    "lessons": [],
    "simulations": [],
    "external_resources": []
  }
}