{
  "lesson_id": "D2-LESSON-007",
  "domain": 2,
  "title": "Vulnerability Management",
  "subtitle": "Finding and Fixing Weaknesses Before Attackers Do",
  "version": "2.0-enhanced",
  "objectives_covered": ["2.3"],
  "estimated_duration": "90-120 minutes",
  "difficulty": "intermediate",
  "prerequisites": ["D2-LESSON-006"],

  "skill_tree": {
    "position": {"domain": 2, "sequence": 7, "tier": "intermediate"},
    "prerequisites": [{"lesson_id": "D2-LESSON-006", "title": "Application Attacks", "why_needed": "Understand vulnerabilities being scanned"}],
    "unlocks": [{"lesson_id": "D4-LESSON-003", "title": "Vulnerability Management (Operations)", "connection": "Operational vulnerability processes"}]
  },

  "role_relevance": {
    "soc_analyst": {"relevance": "high", "percentage_of_job": "25-35%", "daily_tasks": ["Review vulnerability alerts", "Prioritize findings", "Track remediation"]},
    "security_engineer": {"relevance": "critical", "percentage_of_job": "40-50%", "daily_tasks": ["Configure scanners", "Analyze results", "Coordinate patching"]},
    "grc_analyst": {"relevance": "high", "percentage_of_job": "35-45%", "daily_tasks": ["Report on vulnerability metrics", "Track compliance", "Manage risk acceptance"]},
    "penetration_tester": {"relevance": "critical", "percentage_of_job": "50-60%", "daily_tasks": ["Validate scan findings", "Discover additional vulnerabilities"]}
  },

  "introduction": {
    "hook": "The 2017 Equifax breach exploited a vulnerability that had a patch available for two months. 147 million records exposed because of poor vulnerability management. Finding vulnerabilities is only half the battleâ€”you must also fix them in time.",
    "exam_weight": {"estimated_questions": "5-7", "high_yield_topics": ["CVSS scoring", "Vulnerability types", "Scanning vs assessment vs penetration test", "Zero-day definition"]}
  },

  "sections": [
    {
      "section_id": "D2-L007-S01",
      "title": "Vulnerability Fundamentals",
      "estimated_time": "12 minutes",
      "content": {
        "core_concepts": [
          {
            "concept": "Vulnerability Types",
            "types": [
              {"type": "Zero-Day", "definition": "Unknown vulnerability with no patch available", "note": "0 days to prepare"},
              {"type": "Known Vulnerability", "definition": "Documented with CVE, may have patch"},
              {"type": "Misconfiguration", "definition": "Incorrect security settings"}
            ]
          },
          {
            "concept": "CVSS (Common Vulnerability Scoring System)",
            "scale": "0.0 to 10.0",
            "ratings": [
              {"range": "0.0", "severity": "None"},
              {"range": "0.1-3.9", "severity": "Low"},
              {"range": "4.0-6.9", "severity": "Medium"},
              {"range": "7.0-8.9", "severity": "High"},
              {"range": "9.0-10.0", "severity": "Critical"}
            ],
            "components": ["Base Score (inherent severity)", "Temporal Score (current state)", "Environmental Score (your context)"]
          },
          {
            "concept": "CVE (Common Vulnerabilities and Exposures)",
            "definition": "Standardized vulnerability identifier",
            "format": "CVE-YEAR-NUMBER (e.g., CVE-2021-44228)"
          }
        ]
      },
      "must_remember_for_exam": [
        {"fact": "Zero-day = no patch available, 0 days to prepare", "why_tested": "Definition"},
        {"fact": "CVSS 9.0-10.0 = Critical, 7.0-8.9 = High", "why_tested": "Scoring"},
        {"fact": "CVE = standardized vulnerability identifier", "why_tested": "Terminology"}
      ],
      "key_points": ["Zero-day has no patch; CVSS rates severity 0-10", "CVE provides standardized vulnerability IDs", "Critical = 9.0-10.0, High = 7.0-8.9"]
    },
    {
      "section_id": "D2-L007-S02",
      "title": "Vulnerability Assessment Methods",
      "estimated_time": "12 minutes",
      "content": {
        "core_concepts": [
          {
            "concept": "Assessment Types",
            "types": [
              {"type": "Vulnerability Scan", "method": "Automated tool checks for known vulnerabilities", "depth": "Broad, shallow"},
              {"type": "Vulnerability Assessment", "method": "Scan + analysis + prioritization", "depth": "Broader context"},
              {"type": "Penetration Test", "method": "Attempt to actually exploit vulnerabilities", "depth": "Deep, proves exploitability"}
            ]
          },
          {
            "concept": "Scan Types",
            "types": [
              {"type": "Credentialed", "access": "Authenticated access", "accuracy": "Higher (sees internal config)"},
              {"type": "Non-credentialed", "access": "External only", "accuracy": "Lower (attacker's view)"},
              {"type": "Agent-based", "method": "Software on endpoints", "benefit": "Continuous monitoring"}
            ]
          }
        ]
      },
      "must_remember_for_exam": [
        {"fact": "Vulnerability scan = automated check; Pentest = actual exploitation", "why_tested": "Method distinction"},
        {"fact": "Credentialed scans are more accurate than non-credentialed", "why_tested": "Scan comparison"},
        {"fact": "False positive = reported but doesn't exist; False negative = exists but not found", "why_tested": "Terminology"}
      ],
      "key_points": ["Scan (automated) vs Assessment (analyzed) vs Pentest (exploited)", "Credentialed scans see more, are more accurate", "False positive = reported incorrectly; False negative = missed"]
    },
    {
      "section_id": "D2-L007-S03",
      "title": "Vulnerability Management Process",
      "estimated_time": "10 minutes",
      "content": {
        "core_concepts": [
          {
            "concept": "Vulnerability Management Lifecycle",
            "stages": [
              {"stage": "Discover", "activity": "Scan and identify vulnerabilities"},
              {"stage": "Prioritize", "activity": "Rank by risk (CVSS + context)"},
              {"stage": "Remediate", "activity": "Patch, configure, or mitigate"},
              {"stage": "Verify", "activity": "Rescan to confirm fix"},
              {"stage": "Report", "activity": "Track metrics and trends"}
            ]
          },
          {
            "concept": "Remediation Options",
            "options": [
              {"option": "Patch", "description": "Apply vendor fix"},
              {"option": "Compensating Control", "description": "Mitigate without patching"},
              {"option": "Accept Risk", "description": "Document and accept (requires approval)"},
              {"option": "Transfer Risk", "description": "Insurance or contract terms"}
            ]
          }
        ]
      },
      "must_remember_for_exam": [
        {"fact": "Lifecycle: Discover â†’ Prioritize â†’ Remediate â†’ Verify â†’ Report", "why_tested": "Process"},
        {"fact": "Risk acceptance requires documentation and approval", "why_tested": "Governance"},
        {"fact": "Compensating control mitigates when patching isn't possible", "why_tested": "Remediation option"}
      ]
    }
  ],

  "summary": {
    "exam_essentials": [
      "Zero-day = no patch available",
      "CVSS: Critical 9.0-10.0, High 7.0-8.9",
      "CVE = standardized vulnerability ID",
      "Credentialed scans more accurate than non-credentialed",
      "Pentest actually exploits; scan just identifies"
    ]
  },

  "related_content": {
    "next_lesson": "D2-LESSON-008",
    "previous_lesson": "D2-LESSON-006"
  }
}
