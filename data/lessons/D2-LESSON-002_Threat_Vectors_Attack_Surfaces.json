{
  "lesson_id": "D2-LESSON-002",
  "domain": 2,
  "title": "Threat Vectors and Attack Surfaces",
  "subtitle": "Entry Points: Understanding How Attackers Get In",
  "version": "2.0-enhanced",
  "objectives_covered": ["2.2"],
  "estimated_duration": "90-120 minutes",
  "difficulty": "intermediate",
  "prerequisites": ["D2-LESSON-001"],

  "skill_tree": {
    "position": {"domain": 2, "sequence": 2, "tier": "foundation"},
    "prerequisites": [{"lesson_id": "D2-LESSON-001", "title": "Threat Actors and Motivations", "why_needed": "Understand WHO attacks before HOW they attack"}],
    "unlocks": [
      {"lesson_id": "D2-LESSON-003", "title": "Social Engineering", "connection": "Human vector attacks in depth"},
      {"lesson_id": "D2-LESSON-005", "title": "Network Attacks", "connection": "Network vector attacks in depth"}
    ],
    "builds_toward": ["CompTIA Security+ SY0-701", "Attack Surface Management", "Vulnerability Assessment"],
    "cascade_learning": {
      "this_lesson_establishes": ["Threat vector classification", "Attack surface components", "Supply chain risks", "Vector mitigation strategies"],
      "concepts_used_later": {"D2-LESSON-003": "Social engineering vectors", "D2-LESSON-005": "Network attack vectors", "D3-LESSON-002": "Infrastructure security"}
    }
  },

  "role_relevance": {
    "soc_analyst": {"relevance": "critical", "percentage_of_job": "45-55%", "daily_tasks": ["Monitor for vector-based attacks", "Analyze phishing attempts", "Track attack surface changes"]},
    "incident_responder": {"relevance": "high", "percentage_of_job": "35-45%", "daily_tasks": ["Identify initial access vector", "Trace attack paths", "Document vector exploitation"]},
    "security_engineer": {"relevance": "critical", "percentage_of_job": "40-50%", "daily_tasks": ["Implement vector defenses", "Reduce attack surface", "Configure email/web security"]},
    "grc_analyst": {"relevance": "high", "percentage_of_job": "30-40%", "daily_tasks": ["Assess third-party risk", "Document attack surface", "Evaluate supply chain exposure"]},
    "penetration_tester": {"relevance": "critical", "percentage_of_job": "50-60%", "daily_tasks": ["Discover attack surface", "Test vector defenses", "Exploit identified weaknesses"]}
  },

  "introduction": {
    "hook": "The 2021 Colonial Pipeline ransomware attack started with a single compromised VPN password. The 2017 Equifax breach came through one unpatched web server. Every door, window, and opening is a potential entry point. In cybersecurity, those entry points are called threat vectorsâ€”the paths attackers use to reach your systems.",
    "learning_goals": [
      "Identify common threat vectors: message, file, image, voice, removable media, network",
      "Evaluate attack surfaces across digital, physical, human, and supply chain components",
      "Analyze supply chain attack vectors and third-party risks",
      "Apply attack surface reduction techniques"
    ],
    "why_it_matters": {
      "career_impact": "You'll map attack surfaces, implement vector defenses, assess third-party risk, and prioritize security investments.",
      "business_connection": "You can't defend what you don't know exists. Unknown attack surface is undefended attack surface.",
      "exam_relevance": "Expect 6-8 questions on vector types, attack surfaces, and mitigation approaches."
    },
    "exam_weight": {"estimated_questions": "6-8", "high_yield_topics": ["Phishing vs spear phishing vs BEC", "Smishing/vishing", "Supply chain attacks", "Attack surface components"]}
  },

  "sections": [
    {
      "section_id": "D2-L002-S01",
      "title": "Threat Vectors and Attack Surface Fundamentals",
      "estimated_time": "12 minutes",
      "content": {
        "overview": "A threat vector is the method attackers use to gain access. Attack surface is the sum of all potential entry points.",
        "core_concepts": [
          {
            "concept": "Threat Vector Categories",
            "categories": [
              {"category": "Message-Based", "examples": "Email (phishing), SMS (smishing), IM, social media"},
              {"category": "File-Based", "examples": "Malicious documents, infected downloads, drive-by downloads"},
              {"category": "Image-Based", "examples": "Steganography, malicious image files, QR codes"},
              {"category": "Voice-Based", "examples": "Vishing, robocalls, deepfake voice"},
              {"category": "Removable Media", "examples": "USB drives, SD cards, external drives"},
              {"category": "Network", "examples": "Vulnerable services, wireless attacks, MITM"}
            ]
          },
          {
            "concept": "Attack Surface Components",
            "components": [
              {"component": "Digital", "includes": "Internet-facing systems, web apps, APIs, email, VPN, cloud, mobile"},
              {"component": "Physical", "includes": "Building access, hardware ports, discarded equipment"},
              {"component": "Human", "includes": "Employees, contractors, help desk, executives"},
              {"component": "Supply Chain", "includes": "Software vendors, hardware suppliers, service providers"}
            ]
          },
          {
            "concept": "Attack Surface Discovery Challenges",
            "challenges": [
              {"challenge": "Shadow IT", "description": "Unauthorized cloud services, unapproved apps"},
              {"challenge": "Forgotten Assets", "description": "Legacy systems, exposed test environments"},
              {"challenge": "Third-Party Exposure", "description": "Vendor connections, partner integrations"}
            ]
          }
        ]
      },
      "memory_hooks": {
        "mnemonic": "MFIV-RN: Message, File, Image, Voice, Removable, Network (vector types)",
        "analogy": "Attack surface is like all the doors and windows of a building. Threat vectors are the ways burglars might enterâ€”through doors, windows, or maybe the chimney."
      },
      "must_remember_for_exam": [
        {"fact": "Threat vector = HOW attackers get in", "why_tested": "Definition"},
        {"fact": "Attack surface = WHERE attackers can get in (total entry points)", "why_tested": "Definition"},
        {"fact": "Attack surface has 4 components: digital, physical, human, supply chain", "why_tested": "Framework"},
        {"fact": "Shadow IT expands attack surface without security awareness", "why_tested": "Common risk"}
      ],
      "key_points": ["Threat vector = method/path, Attack surface = total entry points", "Vector types: message, file, image, voice, removable, network", "Surface components: digital, physical, human, supply chain"],
      "knowledge_check": {
        "question": "Employees are using unapproved cloud storage to share files with partners. This represents expansion of the organization's:",
        "options": ["Threat landscape", "Attack surface", "Security perimeter", "Compliance scope"],
        "correct": 1,
        "explanation": "Shadow IT expands the attack surfaceâ€”new entry points that security doesn't monitor or protect.",
        "wrong_answer_analysis": [
          {"option": 0, "why_wrong": "Threat landscape is about WHO might attack, not entry points"},
          {"option": 2, "why_wrong": "Perimeter is about boundaries, not the total of all entry points"},
          {"option": 3, "why_wrong": "Compliance scope is regulatory concern, not security entry points"}
        ]
      }
    },
    {
      "section_id": "D2-L002-S02",
      "title": "Message-Based Attack Vectors",
      "estimated_time": "15 minutes",
      "content": {
        "overview": "Message-based attacks use communication channels to deliver malicious content or manipulate victims. Most common initial access vector.",
        "core_concepts": [
          {
            "concept": "Email Attack Types",
            "types": [
              {"type": "Phishing", "description": "Mass emails impersonating trusted entities", "goal": "Volume-based success"},
              {"type": "Spear Phishing", "description": "Targeted emails for specific individuals", "goal": "Higher success rate through personalization"},
              {"type": "Whaling", "description": "Spear phishing targeting executives", "goal": "High-value targets"},
              {"type": "BEC", "description": "Impersonating executives for wire fraud", "goal": "Financial theft, $2.7B annually"}
            ],
            "critical_distinction": "Phishing = mass, Spear Phishing = targeted, Whaling = executives, BEC = financial fraud"
          },
          {
            "concept": "SMS-Based Attacks (Smishing)",
            "characteristics": ["Short, urgent messages", "Links to credential harvesting", "Impersonate banks, delivery services"],
            "common_lures": ["Account locked", "Package delivery problem", "Verify your identity"]
          },
          {
            "concept": "Voice-Based Attacks (Vishing)",
            "characteristics": ["Phone calls impersonating IT support, banks", "Urgency to bypass skepticism", "May use caller ID spoofing"],
            "emerging_threat": "Deepfake voice impersonation"
          }
        ],
        "what_would_happen_if": {
          "scenario": "What if you only trained employees on phishing but not smishing/vishing?",
          "consequence": "Attackers adapt. They'll switch to SMS or phone calls where employees are less suspicious. Multi-channel awareness is essentialâ€”attackers use whatever works."
        }
      },
      "memory_hooks": {
        "mnemonic": "PSWB: Phishing (mass), Spear phishing (targeted), Whaling (executives), BEC (fraud)",
        "common_mistakes": [{"mistake": "Thinking BEC always involves malware", "correction": "BEC is often pure social engineeringâ€”no malware, just convincing emails requesting money transfers."}]
      },
      "must_remember_for_exam": [
        {"fact": "Phishing = mass, Spear phishing = targeted, Whaling = executives", "why_tested": "Attack classification"},
        {"fact": "BEC = Business Email Compromise ($2.7B annual losses)", "why_tested": "Major threat category"},
        {"fact": "Smishing = SMS phishing, Vishing = voice phishing", "why_tested": "Terminology"},
        {"fact": "Spear phishing is more sophisticated and successful than mass phishing", "why_tested": "Threat comparison"}
      ],
      "key_points": ["Phishing (mass) vs Spear phishing (targeted) vs BEC (executive fraud)", "Smishing = SMS attacks, Vishing = voice attacks", "BEC causes $2.7B in annual losses", "Multi-channel attacks bypass single-vector defenses"],
      "knowledge_check": {
        "question": "A CFO receives an email appearing to be from the CEO requesting an urgent wire transfer to a new vendor. This is MOST likely:",
        "options": ["Phishing", "Spear phishing", "Business Email Compromise", "Smishing"],
        "correct": 2,
        "explanation": "BEC specifically involves impersonating executives to request financial transfers. While it's targeted (like spear phishing), the financial fraud aspect makes it BEC.",
        "wrong_answer_analysis": [
          {"option": 0, "why_wrong": "Phishing is mass targeting, not specifically impersonating executives"},
          {"option": 1, "why_wrong": "Spear phishing is targeted but BEC specifically involves financial fraud impersonation"},
          {"option": 3, "why_wrong": "Smishing uses SMS, not email"}
        ]
      }
    },
    {
      "section_id": "D2-L002-S03",
      "title": "File-Based and Removable Media Vectors",
      "estimated_time": "12 minutes",
      "content": {
        "overview": "File-based attacks embed malicious code in files. Removable media provides physical delivery mechanism bypassing network controls.",
        "core_concepts": [
          {
            "concept": "Malicious Document Types",
            "types": [
              {"type": "Office Documents", "mechanism": "VBA macros, DDE attacks, template injection"},
              {"type": "PDF Files", "mechanism": "JavaScript execution, embedded files"},
              {"type": "Archive Files (ZIP/RAR)", "mechanism": "Hidden executables, nested archives, password-protected to evade scanning"}
            ]
          },
          {
            "concept": "Drive-by Downloads",
            "process": ["User visits compromised site", "Malicious code exploits browser vulnerability", "Malware downloads without user action"],
            "key_point": "No clicks requiredâ€”just visiting the site"
          },
          {
            "concept": "Removable Media Attacks",
            "methods": [
              {"method": "USB Drop", "description": "Plant infected USBs in parking lots/lobbies"},
              {"method": "Promotional Items", "description": "Infected devices given as gifts"},
              {"method": "Supply Chain", "description": "Compromised devices before delivery"}
            ],
            "famous_example": "Stuxnet spread via USB drives to air-gapped Iranian nuclear facility"
          }
        ]
      },
      "must_remember_for_exam": [
        {"fact": "Drive-by downloads require no user actionâ€”just visiting a site", "why_tested": "Attack mechanism"},
        {"fact": "Office macros are common malware delivery method", "why_tested": "File-based vector"},
        {"fact": "USB drives can bridge air-gapped networks (Stuxnet)", "why_tested": "Physical vector capability"}
      ],
      "key_points": ["Office macros, PDFs, and archives commonly deliver malware", "Drive-by downloads require no clicks", "USB drives bypass network security", "Password-protected archives evade email scanning"],
      "knowledge_check": {
        "question": "A user visits a legitimate website that was compromised. Without clicking anything, malware is downloaded to their system. This is:",
        "options": ["Phishing attack", "Drive-by download", "Watering hole attack", "Trojan infection"],
        "correct": 1,
        "explanation": "Drive-by downloads exploit browser vulnerabilities to install malware without user action. The key indicator is 'without clicking anything.'",
        "wrong_answer_analysis": [
          {"option": 0, "why_wrong": "Phishing requires user action (clicking link, entering credentials)"},
          {"option": 2, "why_wrong": "Watering hole is the strategy of compromising sites visitors trust; drive-by is the technical mechanism"},
          {"option": 3, "why_wrong": "Trojan describes the malware type, not the delivery method"}
        ]
      }
    },
    {
      "section_id": "D2-L002-S04",
      "title": "Supply Chain and Third-Party Vectors",
      "estimated_time": "12 minutes",
      "content": {
        "overview": "Supply chain attacks target trusted third parties to reach ultimate victims. Increasingly common and devastating.",
        "core_concepts": [
          {
            "concept": "Supply Chain Attack Types",
            "types": [
              {"type": "Software Supply Chain", "method": "Compromise vendor's development/build process", "example": "SolarWinds (2020)"},
              {"type": "Hardware Supply Chain", "method": "Implant malicious components in manufacturing", "example": "Firmware tampering"},
              {"type": "Service Provider", "method": "Compromise MSP to reach their customers", "example": "Kaseya attack (2021)"}
            ]
          },
          {
            "concept": "Why Supply Chain Attacks Work",
            "reasons": [
              "Trusted relationshipâ€”victims install updates willingly",
              "Signed code appears legitimate",
              "Wide reachâ€”one compromise affects thousands",
              "Detection difficultâ€”malware in 'trusted' software"
            ]
          },
          {
            "concept": "Third-Party Risk",
            "risks": [
              {"risk": "Vendor Network Access", "description": "Direct connection to your systems"},
              {"risk": "Data Sharing", "description": "Your data on their systems"},
              {"risk": "Software Dependencies", "description": "Libraries and components from others"},
              {"risk": "Physical Access", "description": "Contractors, service technicians"}
            ]
          }
        ],
        "what_would_happen_if": {
          "scenario": "What if your security software vendor was compromised?",
          "consequence": "Like SolarWindsâ€”you'd install malicious updates thinking you're improving security. The trusted update mechanism becomes the attack vector. This is why supply chain security is critical."
        }
      },
      "must_remember_for_exam": [
        {"fact": "SolarWinds = software supply chain attack (2020)", "why_tested": "Major example"},
        {"fact": "Supply chain attacks leverage trusted relationships", "why_tested": "Why they work"},
        {"fact": "MSP compromise can affect all their customers", "why_tested": "Cascading impact"}
      ],
      "key_points": ["Supply chain attacks compromise trusted vendors to reach victims", "SolarWinds showed devastating impact of software supply chain compromise", "Third-party risk includes vendor access, data sharing, and software dependencies"],
      "knowledge_check": {
        "question": "A software vendor's build process is compromised, causing malicious code to be included in updates sent to customers. This is:",
        "options": ["Watering hole attack", "Supply chain attack", "Man-in-the-middle attack", "Zero-day exploit"],
        "correct": 1,
        "explanation": "Supply chain attacks compromise the software development/distribution process to deliver malware through trusted updates.",
        "wrong_answer_analysis": [
          {"option": 0, "why_wrong": "Watering hole compromises websites visitors trust, not software vendors"},
          {"option": 2, "why_wrong": "MITM intercepts communications, not software builds"},
          {"option": 3, "why_wrong": "Zero-day is an unknown vulnerability, not a delivery method"}
        ]
      }
    },
    {
      "section_id": "D2-L002-S05",
      "title": "Attack Surface Reduction",
      "estimated_time": "10 minutes",
      "content": {
        "overview": "Reducing attack surface minimizes entry points available to attackers. Fundamental security principle.",
        "core_concepts": [
          {
            "concept": "Attack Surface Reduction Strategies",
            "strategies": [
              {"strategy": "Remove Unnecessary Services", "description": "Disable/uninstall what's not needed"},
              {"strategy": "Limit Network Exposure", "description": "Minimize internet-facing systems, use firewalls"},
              {"strategy": "Implement Least Privilege", "description": "Users only get access they need"},
              {"strategy": "Segment Networks", "description": "Separate critical systems from general network"},
              {"strategy": "Control Third-Party Access", "description": "Limit and monitor vendor connections"},
              {"strategy": "Manage Shadow IT", "description": "Discover and control unauthorized services"}
            ]
          },
          {
            "concept": "Attack Surface Management (ASM)",
            "definition": "Continuous process of discovering, inventorying, and monitoring external digital assets",
            "activities": ["Asset discovery", "Vulnerability scanning", "Risk prioritization", "Continuous monitoring"]
          }
        ]
      },
      "must_remember_for_exam": [
        {"fact": "Attack surface reduction = minimize entry points", "why_tested": "Fundamental concept"},
        {"fact": "Remove unnecessary services, limit exposure, implement least privilege", "why_tested": "Reduction strategies"},
        {"fact": "ASM = continuous external asset discovery and monitoring", "why_tested": "Modern discipline"}
      ],
      "key_points": ["Reduce surface by removing unnecessary services and limiting exposure", "Least privilege limits what attackers can reach", "ASM continuously discovers and monitors external assets"]
    }
  ],

  "hands_on_labs": {
    "browser_labs": [
      {"lab_id": "lab-vector-identifier", "title": "Attack Vector Identifier", "type": "scenario_quiz", "description": "Identify attack vectors in incident descriptions"},
      {"lab_id": "lab-surface-mapper", "title": "Attack Surface Mapper", "type": "interactive", "description": "Map an organization's attack surface components"}
    ],
    "external_labs": [
      {"resource": "TryHackMe", "lab_name": "Phishing", "url": "https://tryhackme.com", "description": "Analyze phishing emails and techniques"}
    ]
  },

  "summary": {
    "key_takeaways": [
      "Threat vector = HOW (method); Attack surface = WHERE (all entry points)",
      "Vector types: message, file, image, voice, removable media, network",
      "Attack surface: digital, physical, human, supply chain",
      "Phishing (mass) vs Spear phishing (targeted) vs BEC (fraud)",
      "Supply chain attacks leverage trusted relationships",
      "Reduce surface by removing unnecessary services and limiting exposure"
    ],
    "exam_essentials": [
      "Phishing = mass, Spear phishing = targeted, Whaling = executives",
      "BEC = Business Email Compromise ($2.7B losses)",
      "Smishing = SMS, Vishing = voice",
      "Drive-by download = no user action required",
      "Supply chain attacks use trusted update mechanisms"
    ]
  },

  "related_content": {
    "simulations": ["D2-SIM-001"],
    "remediation": ["D2-REM-001"],
    "next_lesson": "D2-LESSON-003",
    "previous_lesson": "D2-LESSON-001"
  }
}
