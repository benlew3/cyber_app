{
  "lesson_id": "D1-LESSON-002",
  "domain": 1,
  "title": "CIA Triad Fundamentals",
  "objectives_covered": ["1.2"],
  "estimated_duration": "45-55 minutes",
  "difficulty": "beginner",
  "prerequisites": ["D1-LESSON-001"],

  "introduction": {
    "hook": "In 2017, Equifax suffered a breach exposing 147 million people's personal data - a catastrophic failure of CONFIDENTIALITY. In 2020, SolarWinds attackers modified legitimate software updates with malware - a devastating attack on INTEGRITY. In 2021, a ransomware attack shut down Colonial Pipeline for six days - a critical loss of AVAILABILITY. Every major security incident maps back to one of these three principles. Understanding the CIA Triad isn't just academic - it's how security professionals think about, communicate, and prioritize protection.",
    "learning_goals": [
      "Define and differentiate confidentiality, integrity, and availability",
      "Identify threats specific to each CIA component",
      "Select appropriate controls to protect each principle",
      "Recognize CIA triad applications in real-world scenarios",
      "Balance competing CIA requirements based on business context"
    ],
    "why_it_matters": "The CIA Triad is the foundation of all security decision-making. When you assess risk, you're evaluating threats to CIA. When you select controls, you're protecting CIA. When you respond to incidents, you're restoring CIA. Every security framework, standard, and best practice maps back to these three principles. On the exam, expect 4-6 questions directly testing your understanding of CIA concepts and their application.",
    "career_relevance": {
      "soc_analyst": "You'll classify incidents by which CIA principle was compromised and prioritize response accordingly",
      "incident_responder": "Your reports will document which CIA principles were impacted and recommend controls to protect them",
      "grc_analyst": "You'll map compliance requirements to CIA principles and assess control coverage",
      "penetration_tester": "Your findings will be categorized by CIA impact - helps clients understand severity",
      "security_engineer": "You'll design systems that balance all three principles based on business requirements"
    }
  },

  "linux_fundamentals": {
    "why_linux": "Linux systems must protect confidentiality, integrity, and availability just like any other system. Understanding how Linux implements CIA protections is essential.",
    "essential_commands_this_lesson": [
      {
        "command": "chmod 600 sensitive_file.txt",
        "purpose": "Protect CONFIDENTIALITY - restrict file access",
        "example_output": "(no output on success)"
      },
      {
        "command": "sha256sum important_file.txt",
        "purpose": "Verify INTEGRITY - generate hash for comparison",
        "example_output": "a3b8f2c9d... important_file.txt"
      },
      {
        "command": "sudo systemctl status nginx",
        "purpose": "Check AVAILABILITY - verify service is running",
        "example_output": "Active: active (running)"
      },
      {
        "command": "gpg --encrypt --recipient user@email.com file.txt",
        "purpose": "Protect CONFIDENTIALITY - encrypt file",
        "example_output": "Creates file.txt.gpg"
      }
    ]
  },

  "sections": [
    {
      "section_id": "D1-L002-S01",
      "title": "Confidentiality: Keeping Secrets Secret",
      "content": "Confidentiality ensures that information is accessible only to those authorized to access it. When confidentiality fails, sensitive data is exposed to unauthorized parties.\n\n**What Confidentiality Protects**\n- Personal Identifiable Information (PII): Names, SSNs, addresses\n- Protected Health Information (PHI): Medical records, diagnoses\n- Financial data: Credit cards, bank accounts, transactions\n- Intellectual property: Trade secrets, source code, designs\n- Credentials: Passwords, API keys, certificates\n- Business sensitive: Strategic plans, merger info, pricing\n\n**Threats to Confidentiality**\n\n1. **Unauthorized Access**\n   - Hackers gaining system access\n   - Insiders accessing data beyond their role\n   - Credential theft and misuse\n\n2. **Data Breaches**\n   - Database compromises\n   - File server intrusions\n   - Cloud storage misconfigurations\n\n3. **Eavesdropping**\n   - Network traffic interception\n   - Man-in-the-middle attacks\n   - Shoulder surfing\n\n4. **Social Engineering**\n   - Phishing for credentials\n   - Pretexting for information\n   - Tailgating into secure areas\n\n5. **Improper Disposal**\n   - Unwiped hard drives\n   - Documents in trash\n   - Unsecured decommissioned equipment\n\n**Controls for Confidentiality**\n\n**Encryption**: The primary technical control\n- Data at rest: Full disk encryption, database encryption\n- Data in transit: TLS/SSL, VPNs, HTTPS\n- Data in use: Emerging technologies like homomorphic encryption\n\n**Access Controls**: Limiting who can access what\n- Role-Based Access Control (RBAC)\n- Least privilege implementation\n- Need-to-know restrictions\n\n**Data Classification**: Knowing what to protect\n- Public, Internal, Confidential, Restricted\n- Handling requirements by classification\n- Labeling and marking\n\n**Physical Security**: Protecting physical access\n- Locked server rooms\n- Clean desk policies\n- Secure disposal procedures",

      "key_points": [
        "Confidentiality prevents unauthorized disclosure of information",
        "Encryption is the primary technical control for confidentiality",
        "Access controls implement least privilege and need-to-know",
        "Data classification identifies what needs protection and how much",
        "Threats include breaches, eavesdropping, social engineering, and improper disposal"
      ],

      "real_world_example": {
        "scenario": "Healthcare data breach from cloud misconfiguration",
        "company": "MedCare Health Systems",
        "application": "A developer at MedCare accidentally configured an AWS S3 bucket containing patient records as publicly accessible. Within 48 hours, security researchers discovered 2.3 million patient records exposed - names, diagnoses, prescriptions, and insurance IDs. The breach cost $4.2M in fines, $8M in legal settlements, and immeasurable reputation damage. ROOT CAUSE: No data classification program, no cloud security review process, no detective controls monitoring for public buckets."
      },

      "career_callout": {
        "role": "SOC Analyst",
        "insight": "When you detect a potential data exfiltration alert - unusual outbound traffic, large file transfers, or cloud storage uploads - you're responding to a confidentiality threat. Your initial triage should identify what data might have been exposed and its classification level. This determines escalation urgency."
      },

      "exam_tips": [
        "Encryption protects CONFIDENTIALITY (making data unreadable)",
        "Hashing primarily protects INTEGRITY (not confidentiality - hashes are one-way)",
        "Access controls protect confidentiality by limiting WHO can see data",
        "Data classification is a MANAGERIAL control that enables confidentiality",
        "Social engineering attacks often target confidentiality (stealing credentials/info)"
      ],

      "glossary_terms": [
        {
          "term": "Confidentiality",
          "definition": "The security principle ensuring that information is accessible only to authorized individuals, entities, or processes.",
          "exam_note": "Protecting secrets. Encryption is primary control. Breaches = confidentiality failures."
        },
        {
          "term": "Data Classification",
          "definition": "The process of categorizing data based on its sensitivity and the impact of unauthorized disclosure, determining appropriate handling requirements.",
          "exam_note": "Enables proper protection. Common levels: Public, Internal, Confidential, Restricted."
        },
        {
          "term": "Encryption",
          "definition": "The process of converting readable data (plaintext) into an unreadable format (ciphertext) using an algorithm and key.",
          "exam_note": "Primary confidentiality control. At rest, in transit, in use. Requires key management."
        }
      ],

      "knowledge_check": {
        "question": "A company discovers that a former employee downloaded customer contact lists before leaving. No financial data or passwords were taken, but thousands of customer names, emails, and phone numbers were copied. Which CIA principle was primarily violated?",
        "options": [
          "Integrity because the data was copied without authorization",
          "Availability because customers can no longer trust the company",
          "Confidentiality because customer data was disclosed to an unauthorized party",
          "Non-repudiation because the employee denied taking the data"
        ],
        "correct": 2,
        "explanation": "This is a CONFIDENTIALITY violation - information was disclosed to someone unauthorized to access it (the former employee had no business need for customer data after leaving). The data wasn't modified (integrity) and remained available (availability). Non-repudiation isn't part of the CIA triad."
      }
    },
    {
      "section_id": "D1-L002-S02",
      "title": "Integrity: Trust What You See",
      "content": "Integrity ensures that data remains accurate, consistent, and unmodified except by authorized processes. When integrity fails, you can't trust that data is accurate.\n\n**What Integrity Protects**\n- Data accuracy: Financial records, medical data, inventory\n- System configuration: Settings, policies, baselines\n- Software authenticity: Code, updates, patches\n- Transaction validity: Orders, transfers, approvals\n- Audit trails: Logs, records, evidence\n\n**Types of Integrity**\n\n**Data Integrity**\n- Accuracy of information content\n- Protection from unauthorized modification\n- Detection of accidental changes\n\n**System Integrity**\n- Correct operation of systems\n- Unmodified configurations\n- Trusted system state\n\n**Source Integrity (Authenticity)**\n- Data comes from claimed source\n- Messages are from stated sender\n- Software is from legitimate developer\n\n**Threats to Integrity**\n\n1. **Unauthorized Modification**\n   - Attackers altering database records\n   - Malware modifying system files\n   - Insiders changing logs\n\n2. **Man-in-the-Middle Attacks**\n   - Intercepting and altering communications\n   - Modifying transactions in transit\n   - Injecting malicious content\n\n3. **Malware**\n   - Trojans modifying files\n   - Ransomware encrypting (destroying integrity)\n   - Rootkits hiding changes\n\n4. **Supply Chain Attacks**\n   - Compromised software updates\n   - Backdoored hardware\n   - Modified open-source libraries\n\n5. **Accidental Changes**\n   - User errors\n   - Application bugs\n   - Hardware failures\n\n**Controls for Integrity**\n\n**Hashing**: Detecting modifications\n- MD5, SHA-256, SHA-3\n- File integrity monitoring\n- Download verification\n\n**Digital Signatures**: Verifying source and integrity\n- Code signing\n- Email signing (S/MIME, PGP)\n- Document signing\n\n**Access Controls**: Preventing unauthorized changes\n- Write permissions\n- Change management processes\n- Separation of duties\n\n**Version Control**: Tracking and reverting changes\n- Git for code\n- Configuration management\n- Database transaction logs\n\n**Input Validation**: Preventing invalid data\n- Application-level checks\n- Database constraints\n- Format verification",

      "key_points": [
        "Integrity ensures data accuracy and prevents unauthorized modification",
        "Hashing detects changes but doesn't prevent them",
        "Digital signatures verify both integrity AND authenticity (source)",
        "Supply chain attacks compromise integrity of software and hardware",
        "Version control enables detection and reversal of changes"
      ],

      "real_world_example": {
        "scenario": "SolarWinds supply chain attack",
        "company": "SolarWinds (affecting thousands of customers)",
        "application": "In 2020, attackers compromised SolarWinds' build process, injecting malicious code into the Orion software update. Because the update was signed by SolarWinds (legitimate signature), 18,000 organizations installed the backdoor. INTEGRITY FAILURE: The software's integrity was compromised at the source. Traditional integrity controls (checking the signature) passed because the attack happened before signing. LESSON: Integrity controls must cover the entire supply chain, not just the final product."
      },

      "career_callout": {
        "role": "Incident Responder",
        "insight": "When investigating a compromise, one of your first questions is 'what was modified?' You'll use file integrity monitoring (FIM) alerts, compare systems against known-good baselines, and examine logs for unauthorized changes. Understanding integrity helps you identify the scope of an incident and what needs to be restored from trusted sources."
      },

      "visualization": {
        "type": "ascii_diagram",
        "title": "Integrity Control Flow",
        "diagram": [
          "   SENDER                                    RECEIVER",
          "   ======                                    ========",
          "                                                     ",
          "   Original     Hash        Transmit     Hash        ",
          "   Message  --> Algorithm   ========>    Algorithm   ",
          "      |            |                         |       ",
          "      |            v                         v       ",
          "      |        HASH VALUE                HASH VALUE  ",
          "      |            |                         |       ",
          "      |            |        Compare          |       ",
          "      |            +--------> ? <------------+       ",
          "      |                       |                      ",
          "      |                       v                      ",
          "      |              MATCH = Integrity OK            ",
          "      |              MISMATCH = Modified!            ",
          "      |                                              ",
          "      +--- Digital Signature adds AUTHENTICITY ---+  ",
          "          (proves WHO sent it, not just integrity)   "
        ]
      },

      "exam_tips": [
        "Hashing = integrity verification (detects changes)",
        "Digital signatures = integrity + authenticity (detects changes AND verifies sender)",
        "Encryption = confidentiality (not primarily integrity)",
        "Supply chain attacks are integrity attacks at the source",
        "File Integrity Monitoring (FIM) is a key detective control for integrity"
      ],

      "glossary_terms": [
        {
          "term": "Integrity",
          "definition": "The security principle ensuring that data remains accurate, consistent, and unmodified except by authorized users and processes.",
          "exam_note": "Trust data accuracy. Hashing detects changes. Digital signatures verify source."
        },
        {
          "term": "Hashing",
          "definition": "A one-way cryptographic function that produces a fixed-size output (hash) from any input, used to verify data integrity.",
          "exam_note": "NOT encryption (one-way, can't reverse). MD5 (weak), SHA-256 (strong). Same input = same hash."
        },
        {
          "term": "Digital Signature",
          "definition": "A cryptographic technique that verifies both the integrity of a message and the identity of the sender using asymmetric cryptography.",
          "exam_note": "Provides integrity AND authenticity. Uses private key to sign, public key to verify."
        },
        {
          "term": "File Integrity Monitoring (FIM)",
          "definition": "A security control that monitors and detects changes to critical system files, configurations, and content.",
          "exam_note": "Detective control for integrity. Compares current state to baseline. Alerts on changes."
        }
      ],

      "knowledge_check": {
        "question": "An attacker intercepts a wire transfer request and changes the destination account number before it reaches the bank. The bank processes the modified transfer. Which CIA principle was primarily violated?",
        "options": [
          "Confidentiality because the attacker saw the transfer details",
          "Integrity because the transfer data was modified without authorization",
          "Availability because the legitimate recipient didn't receive funds",
          "Authentication because the attacker pretended to be the sender"
        ],
        "correct": 1,
        "explanation": "This is primarily an INTEGRITY violation - the data was modified in transit. While confidentiality was also compromised (attacker saw the data) and the outcome affected availability of funds, the attack mechanism was modification of data (integrity). Digital signatures on transactions would have detected this modification."
      }
    },
    {
      "section_id": "D1-L002-S03",
      "title": "Availability: Access When Needed",
      "content": "Availability ensures that systems and data are accessible to authorized users when needed. When availability fails, business operations stop.\n\n**What Availability Protects**\n- System uptime: Servers, applications, services\n- Data accessibility: Files, databases, records\n- Network connectivity: Communications, transactions\n- Business operations: Everything that depends on IT\n\n**Measuring Availability**\n\n**Uptime Percentages (The 'Nines')**\n- 99% = 3.65 days downtime/year\n- 99.9% (three nines) = 8.76 hours/year\n- 99.99% (four nines) = 52.56 minutes/year\n- 99.999% (five nines) = 5.26 minutes/year\n\n**Key Metrics**\n- MTBF (Mean Time Between Failures): How often failures occur\n- MTTR (Mean Time To Repair): How long to fix failures\n- RTO (Recovery Time Objective): Maximum acceptable downtime\n- RPO (Recovery Point Objective): Maximum acceptable data loss\n\n**Threats to Availability**\n\n1. **Denial of Service (DoS/DDoS)**\n   - Overwhelming resources\n   - Exhausting bandwidth\n   - Application-layer attacks\n\n2. **Ransomware**\n   - Encrypting data (making it unavailable)\n   - Locking systems\n   - Threatening deletion\n\n3. **Hardware Failures**\n   - Disk crashes\n   - Power supply failures\n   - Network equipment failures\n\n4. **Natural Disasters**\n   - Floods, fires, earthquakes\n   - Power outages\n   - Building damage\n\n5. **Human Error**\n   - Accidental deletion\n   - Misconfiguration\n   - Maintenance mistakes\n\n**Controls for Availability**\n\n**Redundancy**: Eliminating single points of failure\n- RAID for disk redundancy\n- Clustered servers\n- Redundant network paths\n- Geographic distribution\n\n**Backups**: Enabling recovery\n- Full, incremental, differential\n- Offsite and cloud backup\n- Regular testing\n\n**Failover Systems**: Automatic recovery\n- Hot, warm, cold sites\n- Load balancers\n- Automatic failover\n\n**DDoS Protection**: Preventing resource exhaustion\n- Traffic scrubbing\n- CDN distribution\n- Rate limiting\n\n**Disaster Recovery Planning**: Documented recovery\n- Recovery procedures\n- Testing and exercises\n- Communication plans",

      "key_points": [
        "Availability ensures authorized access to systems and data when needed",
        "Uptime is measured in 'nines' - each nine significantly reduces allowed downtime",
        "MTBF, MTTR, RTO, and RPO are key availability metrics",
        "Redundancy eliminates single points of failure",
        "Backups enable recovery but must be tested regularly"
      ],

      "real_world_example": {
        "scenario": "Colonial Pipeline ransomware shutdown",
        "company": "Colonial Pipeline",
        "application": "In May 2021, ransomware forced Colonial Pipeline to shut down 5,500 miles of pipeline supplying 45% of East Coast fuel. While the attackers targeted billing systems (not operational technology), the company shut down operations for six days to prevent spread. IMPACT: Gas shortages across Southeast US, panic buying, national emergency declaration. AVAILABILITY FAILURE: Even systems not directly attacked became unavailable due to caution. LESSON: Availability planning must consider dependencies and cascading failures."
      },

      "career_callout": {
        "role": "Security Engineer",
        "insight": "You'll design systems with specific availability requirements - five nines for critical financial systems, three nines for internal apps. Understanding RTO/RPO helps you select appropriate backup and failover solutions. When availability requirements conflict with budget, you'll help leadership understand the true cost of downtime."
      },

      "visualization": {
        "type": "ascii_diagram",
        "title": "The Availability Nines",
        "diagram": [
          "+------------+------------------+------------------------+",
          "| Uptime %   | Downtime/Year    | Example Use Case       |",
          "+------------+------------------+------------------------+",
          "| 99%        | 3.65 days        | Internal tools         |",
          "| 99.9%      | 8.76 hours       | Business applications  |",
          "| 99.99%     | 52.56 minutes    | E-commerce platforms   |",
          "| 99.999%    | 5.26 minutes     | Financial trading      |",
          "| 99.9999%   | 31.5 seconds     | Emergency services     |",
          "+------------+------------------+------------------------+",
          "",
          "Each additional 'nine' typically 10x the cost!"
        ]
      },

      "exam_tips": [
        "Know the availability nines and what each represents",
        "RTO = how long can we be down; RPO = how much data can we lose",
        "RAID provides availability (redundancy), not backup (recovery from deletion)",
        "DDoS attacks target AVAILABILITY",
        "Ransomware attacks AVAILABILITY (and confidentiality if data exfiltrated)"
      ],

      "glossary_terms": [
        {
          "term": "Availability",
          "definition": "The security principle ensuring that systems and data are accessible to authorized users when needed.",
          "exam_note": "Access when needed. Redundancy prevents failures. Backups enable recovery."
        },
        {
          "term": "RTO (Recovery Time Objective)",
          "definition": "The maximum acceptable length of time that a system can be offline after a failure or disaster.",
          "exam_note": "How long can we be down? Drives failover/recovery solution selection."
        },
        {
          "term": "RPO (Recovery Point Objective)",
          "definition": "The maximum acceptable amount of data loss measured in time, determining backup frequency.",
          "exam_note": "How much data can we lose? Drives backup frequency. 1-hour RPO = hourly backups."
        },
        {
          "term": "MTTR (Mean Time To Repair)",
          "definition": "The average time required to repair a failed component or system.",
          "exam_note": "How long to fix? Lower MTTR = better availability. Automation reduces MTTR."
        }
      ],

      "knowledge_check": {
        "question": "A hospital's electronic health record system must be available 99.99% of the time to support patient care. The IT team is selecting a backup solution. If their RTO is 15 minutes and RPO is 1 hour, which backup approach is most appropriate?",
        "options": [
          "Daily full backups with weekly offsite rotation",
          "Real-time replication with automatic failover to a hot site",
          "Hourly incremental backups with same-day restoration capability",
          "Monthly full backups stored in a secure vault"
        ],
        "correct": 1,
        "explanation": "With 99.99% uptime (only 52 minutes downtime/year allowed) and a 15-minute RTO, they need automatic failover - there's no time for manual restoration. Real-time replication meets the 1-hour RPO (actually exceeds it with near-zero data loss). Daily or monthly backups can't meet a 15-minute RTO, and hourly backups can't support only 52 minutes annual downtime with manual recovery."
      }
    },
    {
      "section_id": "D1-L002-S04",
      "title": "Balancing the CIA Triad",
      "content": "The three principles of CIA often create tension - strengthening one can weaken others. Security professionals must balance these competing requirements based on business needs.\n\n**CIA Conflicts**\n\n**Confidentiality vs. Availability**\n- Strong encryption can slow systems (reduce availability)\n- Complex access controls can lock out legitimate users\n- Security measures that require manual approval delay access\n- Example: MFA adds security but can lock users out if they lose their phone\n\n**Integrity vs. Availability**\n- Strict change controls slow down operations\n- Extensive validation checks add latency\n- Requiring approvals before changes delays response\n- Example: Requiring three approvals for firewall changes slows incident response\n\n**Confidentiality vs. Integrity**\n- Encryption can make integrity verification harder\n- Strong access controls may prevent audit access\n- Generally less conflict between these two\n\n**Finding the Right Balance**\n\n**Know Your Business Requirements**\n- What data/systems are most critical?\n- What's the cost of downtime vs. breach?\n- What does compliance require?\n- What do customers expect?\n\n**Different Systems, Different Priorities**\n\n*E-commerce Site*:\n- Availability is CRITICAL (downtime = lost revenue)\n- Confidentiality is HIGH (customer data)\n- Integrity is HIGH (transactions must be accurate)\n\n*Healthcare Records*:\n- Confidentiality is CRITICAL (patient privacy, HIPAA)\n- Integrity is CRITICAL (wrong data = wrong treatment)\n- Availability is HIGH (but can have brief downtime)\n\n*Public Website*:\n- Availability is HIGH (brand visibility)\n- Integrity is MEDIUM (defacement embarrassing but not catastrophic)\n- Confidentiality is LOW (public information)\n\n**Making Trade-off Decisions**\n\n1. Identify stakeholder requirements\n2. Assess risk for each CIA component\n3. Understand regulatory requirements\n4. Evaluate business impact of failures\n5. Document decisions and rationale\n6. Implement appropriate controls\n7. Monitor and adjust as needed",

      "key_points": [
        "CIA principles often conflict - strengthening one can weaken others",
        "Different systems have different CIA priority orders",
        "Balance decisions should be based on business requirements and risk",
        "Trade-offs must be documented and approved by stakeholders",
        "The 'right' balance depends on context and regulatory requirements"
      ],

      "real_world_example": {
        "scenario": "Balancing CIA for a trading platform",
        "company": "Pinnacle Financial Services",
        "application": "Pinnacle's trading platform required careful CIA balance: AVAILABILITY (Primary) - Traders need instant access; milliseconds matter. System designed for 99.999% uptime with multiple redundant paths. INTEGRITY (Critical) - Trades must execute accurately. Every transaction logged, verified, and auditable. Checksums on all data. CONFIDENTIALITY (High) - Client positions are sensitive but secondary to execution. Encryption used everywhere but optimized to minimize latency. TRADE-OFF DECISION: Chose slightly weaker encryption algorithm (still secure) to reduce latency by 3ms. Documented and approved by risk committee."
      },

      "career_callout": {
        "role": "GRC Analyst",
        "insight": "You'll often mediate CIA trade-off discussions. When IT wants to lock down systems (confidentiality) and business wants easy access (availability), you help find the balance by quantifying risks. Your risk assessments translate technical security into business terms that leadership understands."
      },

      "exam_tips": [
        "Know that CIA components can conflict with each other",
        "Questions may present scenarios asking which CIA principle should be PRIORITIZED",
        "Healthcare scenarios often prioritize confidentiality (HIPAA)",
        "Financial trading scenarios often prioritize availability (downtime = lost money)",
        "The 'best' answer considers business context, not just technical security"
      ],

      "glossary_terms": [
        {
          "term": "CIA Trade-off",
          "definition": "The process of balancing competing security requirements when strengthening one CIA principle may weaken another.",
          "exam_note": "Context matters. Business requirements drive priorities. Document decisions."
        },
        {
          "term": "Business Impact Analysis (BIA)",
          "definition": "A process that identifies critical business functions and the impact of their disruption, informing CIA priority decisions.",
          "exam_note": "Helps determine which CIA principle matters most for each system."
        }
      ],

      "knowledge_check": {
        "question": "A hospital is implementing a new system for tracking controlled substance medications. Regulations require detailed audit trails of all access, and patient safety depends on accurate inventory. Nurses complain that the new system is slower than paper. Which CIA priority order is most appropriate?",
        "options": [
          "Availability first (nurses need quick access for patient care)",
          "Confidentiality first (controlled substances are sensitive)",
          "Integrity first (accurate tracking prevents diversion and ensures patient safety)",
          "All three are equal (no priority needed)"
        ],
        "correct": 2,
        "explanation": "For controlled substance tracking, INTEGRITY is paramount - inaccurate records could mean drugs are diverted (stolen) or patients receive wrong doses. Regulations require accurate audit trails (integrity). While availability matters for workflow, some delay is acceptable if it ensures accuracy. Confidentiality matters but is secondary to ensuring the right drugs go to the right patients."
      }
    },
    {
      "section_id": "D1-L002-S05",
      "title": "CIA in Practice: Applying the Framework",
      "content": "Understanding how to apply CIA thinking in real scenarios prepares you for both the exam and professional security work.\n\n**CIA Analysis Process**\n\n1. **Identify the Asset**: What are we protecting?\n2. **Assess CIA Requirements**: How important is each principle?\n3. **Identify Threats**: What could compromise each principle?\n4. **Select Controls**: What protects each principle?\n5. **Evaluate Trade-offs**: Are there conflicts to resolve?\n6. **Document and Monitor**: Track decisions and effectiveness\n\n**Mapping Controls to CIA**\n\n**Confidentiality Controls**\n- Encryption (primary)\n- Access controls\n- Data classification\n- Physical security\n- Clean desk policy\n\n**Integrity Controls**\n- Hashing (primary for detection)\n- Digital signatures (authenticity + integrity)\n- Input validation\n- Version control\n- Change management\n\n**Availability Controls**\n- Redundancy (primary)\n- Backups\n- Load balancing\n- DDoS protection\n- Disaster recovery\n\n**Extended Security Concepts**\n\nBeyond CIA, security professionals use additional concepts:\n\n**Authentication**: Proving identity (who you are)\n**Authorization**: Permissions after authentication (what you can do)\n**Accounting**: Logging actions (what you did)\n- Together called AAA (Triple-A)\n\n**Non-Repudiation**: Cannot deny an action\n- Achieved through digital signatures\n- Important for transactions and legal matters\n\n**Privacy**: Control over personal information\n- Related to but distinct from confidentiality\n- Focus on individual rights and consent\n\n**CIA and Incident Response**\n\nWhen incidents occur, classify by CIA impact:\n- \"We had a confidentiality breach\" = data exposure\n- \"We had an integrity incident\" = data modification\n- \"We had an availability incident\" = system outage\n\nThis classification helps:\n- Prioritize response (what's the business impact?)\n- Select appropriate response actions\n- Communicate clearly with stakeholders\n- Track metrics by incident type",

      "key_points": [
        "Apply systematic CIA analysis to any security scenario",
        "Know which controls map to which CIA principles",
        "AAA (Authentication, Authorization, Accounting) extends CIA concepts",
        "Non-repudiation prevents denial of actions (digital signatures)",
        "Classify incidents by CIA impact for clear communication"
      ],

      "real_world_example": {
        "scenario": "CIA analysis for new customer portal",
        "company": "GlobalRetail Inc.",
        "application": "When GlobalRetail built their customer portal, security performed CIA analysis: CONFIDENTIALITY - Customer PII, payment info, order history. Controls: TLS encryption, tokenized payment data, RBAC limiting employee access, data masking in non-production. INTEGRITY - Order accuracy, pricing, inventory. Controls: Database constraints, transaction logging, input validation, code signing for deployments. AVAILABILITY - 99.9% uptime required during business hours. Controls: Multi-AZ deployment, auto-scaling, DDoS protection, hourly backups. TRADE-OFF: Chose cached product pages (slightly stale data) for performance over real-time inventory (accepted small integrity risk for availability gain)."
      },

      "career_callout": {
        "role": "Penetration Tester",
        "insight": "Your penetration test reports should categorize findings by CIA impact. A SQL injection vulnerability might enable data theft (confidentiality), data modification (integrity), or database destruction (availability). Framing findings in CIA terms helps clients understand and prioritize remediation."
      },

      "visualization": {
        "type": "ascii_diagram",
        "title": "CIA Controls Mapping",
        "diagram": [
          "+------------------+------------------+------------------+",
          "| CONFIDENTIALITY  |    INTEGRITY     |  AVAILABILITY    |",
          "+------------------+------------------+------------------+",
          "| Encryption       | Hashing          | Redundancy       |",
          "| Access Controls  | Digital Sigs     | Backups          |",
          "| Classification   | Input Validation | Load Balancing   |",
          "| Physical Security| Version Control  | DDoS Protection  |",
          "| Data Masking     | Change Mgmt      | Failover         |",
          "| Clean Desk       | Audit Trails     | DR Planning      |",
          "+------------------+------------------+------------------+",
          "",
          "          SUPPORTING CONCEPTS (AAA + Non-Repudiation)",
          "     +------------------------------------------------+",
          "     | Authentication | Authorization | Accounting    |",
          "     | (Who are you?) | (What can do?)| (What did?)   |",
          "     +------------------------------------------------+",
          "     | Non-Repudiation: Cannot deny actions (digital  |",
          "     | signatures provide proof of origin/integrity)  |",
          "     +------------------------------------------------+"
        ]
      },

      "exam_tips": [
        "AAA = Authentication, Authorization, Accounting",
        "Non-repudiation is achieved through digital signatures",
        "Know which controls primarily protect which CIA principle",
        "Incident classification by CIA helps communicate impact",
        "Privacy is related to but distinct from confidentiality"
      ],

      "glossary_terms": [
        {
          "term": "AAA (Authentication, Authorization, Accounting)",
          "definition": "A security framework combining identity verification (authentication), permission management (authorization), and activity logging (accounting).",
          "exam_note": "Often implemented together. RADIUS and TACACS+ are AAA protocols."
        },
        {
          "term": "Non-Repudiation",
          "definition": "A security property ensuring that an entity cannot deny having performed an action, typically achieved through digital signatures.",
          "exam_note": "Cannot deny sending a message or making a transaction. Digital signatures provide this."
        },
        {
          "term": "Privacy",
          "definition": "The right of individuals to control how their personal information is collected, used, and shared.",
          "exam_note": "Related to confidentiality but focuses on individual rights and consent, not just data protection."
        }
      ],

      "knowledge_check": {
        "question": "A user sends a digitally signed email to their bank authorizing a wire transfer. After the transfer is completed, they claim they never sent the email. The bank can prove they did because of the digital signature. Which security property does this demonstrate?",
        "options": [
          "Confidentiality because the email was encrypted",
          "Integrity because the email wasn't modified",
          "Availability because the email was delivered",
          "Non-repudiation because the sender cannot deny sending the signed message"
        ],
        "correct": 3,
        "explanation": "This is NON-REPUDIATION - the digital signature proves the sender authorized the message, preventing them from denying (repudiating) it later. While digital signatures also provide integrity (proving the message wasn't modified), the scenario specifically asks about proving the sender sent it, which is non-repudiation."
      }
    }
  ],

  "deep_dive": {
    "title": "Hands-On Lab: Implementing CIA Controls on Linux",
    "introduction": "Practice implementing controls that protect each CIA principle on a Linux system.",
    "prerequisites": [
      "Linux VM (Ubuntu 22.04 LTS recommended)",
      "Sudo access",
      "OpenSSL installed"
    ],
    "labs": [
      {
        "lab_id": "LAB-002-1",
        "title": "Lab 1: Protecting Confidentiality with Encryption",
        "objective": "Encrypt sensitive files using GPG",
        "estimated_time": "15 minutes",
        "steps": [
          {
            "step": 1,
            "instruction": "Create a sensitive file",
            "command": "echo 'SECRET: API_KEY=sk-abc123xyz789' > ~/secret.txt",
            "expected_output": "(no output)",
            "explanation": "This represents sensitive data that needs confidentiality protection"
          },
          {
            "step": 2,
            "instruction": "Generate a GPG key pair (if you don't have one)",
            "command": "gpg --gen-key",
            "expected_output": "(follow prompts - enter name, email, passphrase)",
            "explanation": "Creates public/private key pair for asymmetric encryption"
          },
          {
            "step": 3,
            "instruction": "Encrypt the file",
            "command": "gpg --encrypt --recipient your@email.com ~/secret.txt",
            "expected_output": "(creates secret.txt.gpg)",
            "explanation": "File is now encrypted - confidentiality protected"
          },
          {
            "step": 4,
            "instruction": "Verify encryption (try to read encrypted file)",
            "command": "cat ~/secret.txt.gpg",
            "expected_output": "(garbled binary data)",
            "explanation": "Encrypted content is unreadable without the key"
          },
          {
            "step": 5,
            "instruction": "Decrypt the file",
            "command": "gpg --decrypt ~/secret.txt.gpg",
            "expected_output": "SECRET: API_KEY=sk-abc123xyz789",
            "explanation": "With the private key, you can recover the original content"
          },
          {
            "step": 6,
            "instruction": "Securely delete the plaintext file",
            "command": "shred -u ~/secret.txt",
            "expected_output": "(no output)",
            "explanation": "shred overwrites the file before deletion, preventing recovery"
          }
        ],
        "control_mapping": {
          "principle": "Confidentiality",
          "control_type": "Technical/Preventive",
          "frameworks": ["CIS Control 3.11", "NIST 800-53 SC-13"]
        }
      },
      {
        "lab_id": "LAB-002-2",
        "title": "Lab 2: Verifying Integrity with Hashing",
        "objective": "Use hashing to verify file integrity",
        "estimated_time": "10 minutes",
        "steps": [
          {
            "step": 1,
            "instruction": "Create a configuration file",
            "command": "echo 'max_connections=100' > ~/config.txt",
            "expected_output": "(no output)",
            "explanation": "This represents a critical configuration file"
          },
          {
            "step": 2,
            "instruction": "Generate SHA-256 hash (baseline)",
            "command": "sha256sum ~/config.txt > ~/config.txt.sha256",
            "expected_output": "(no output - creates hash file)",
            "explanation": "This hash represents the known-good state"
          },
          {
            "step": 3,
            "instruction": "View the hash",
            "command": "cat ~/config.txt.sha256",
            "expected_output": "abc123... config.txt (your hash will differ)",
            "explanation": "This is the baseline hash to compare against"
          },
          {
            "step": 4,
            "instruction": "Verify integrity (should pass)",
            "command": "sha256sum -c ~/config.txt.sha256",
            "expected_output": "config.txt: OK",
            "explanation": "File matches the baseline - integrity verified"
          },
          {
            "step": 5,
            "instruction": "Simulate unauthorized modification",
            "command": "echo 'max_connections=999' > ~/config.txt",
            "expected_output": "(no output)",
            "explanation": "An attacker might change configuration values"
          },
          {
            "step": 6,
            "instruction": "Verify integrity again (should fail)",
            "command": "sha256sum -c ~/config.txt.sha256",
            "expected_output": "config.txt: FAILED\nsha256sum: WARNING: 1 computed checksum did NOT match",
            "explanation": "Hash mismatch indicates the file was modified - integrity compromised"
          }
        ],
        "control_mapping": {
          "principle": "Integrity",
          "control_type": "Technical/Detective",
          "frameworks": ["CIS Control 3.14", "NIST 800-53 SI-7"]
        }
      },
      {
        "lab_id": "LAB-002-3",
        "title": "Lab 3: Testing Availability with Service Monitoring",
        "objective": "Monitor service availability and test recovery",
        "estimated_time": "15 minutes",
        "steps": [
          {
            "step": 1,
            "instruction": "Install a web server for testing",
            "command": "sudo apt update && sudo apt install -y nginx",
            "expected_output": "(installation output)",
            "explanation": "nginx will be our test service for availability monitoring"
          },
          {
            "step": 2,
            "instruction": "Check service status",
            "command": "sudo systemctl status nginx",
            "expected_output": "Active: active (running)",
            "explanation": "Service is available - availability control working"
          },
          {
            "step": 3,
            "instruction": "Test HTTP availability",
            "command": "curl -I http://localhost",
            "expected_output": "HTTP/1.1 200 OK",
            "explanation": "HTTP 200 confirms the service is responding"
          },
          {
            "step": 4,
            "instruction": "Simulate service failure",
            "command": "sudo systemctl stop nginx",
            "expected_output": "(no output)",
            "explanation": "Simulating an availability incident"
          },
          {
            "step": 5,
            "instruction": "Verify service is down",
            "command": "curl -I http://localhost 2>&1 | head -1",
            "expected_output": "curl: (7) Failed to connect",
            "explanation": "Service unavailable - availability compromised"
          },
          {
            "step": 6,
            "instruction": "Restore availability",
            "command": "sudo systemctl start nginx && sudo systemctl status nginx",
            "expected_output": "Active: active (running)",
            "explanation": "Service restored - availability recovered"
          }
        ],
        "control_mapping": {
          "principle": "Availability",
          "control_type": "Technical/Corrective",
          "frameworks": ["CIS Control 11.1", "NIST 800-53 CP-2"]
        }
      }
    ]
  },

  "practice_platforms": {
    "title": "Where to Practice CIA Concepts",
    "platforms": [
      {
        "name": "TryHackMe",
        "url": "https://tryhackme.com",
        "relevant_rooms": ["Intro to Cryptography", "Linux Fundamentals", "Hashing"]
      },
      {
        "name": "CryptoHack",
        "url": "https://cryptohack.org",
        "best_for": "Deep dive into cryptography for confidentiality/integrity"
      },
      {
        "name": "OverTheWire: Bandit",
        "url": "https://overthewire.org/wargames/bandit/",
        "best_for": "Linux security fundamentals, file permissions"
      }
    ]
  },

  "hands_on_activity": {
    "title": "CIA Impact Assessment",
    "objective": "Analyze a scenario and assess CIA impacts",
    "scenario": "A mid-sized hospital has the following systems: Electronic Health Records (EHR), Patient Billing System, Public Website, Internal Email, and Medical Device Network (IV pumps, monitors). For each system, rank the CIA priorities and justify your reasoning.",
    "steps": [
      "List each system",
      "Rank CIA (1=highest, 3=lowest) for each",
      "Identify the top threat to each CIA component",
      "Recommend one key control for the highest-priority principle",
      "Document any trade-offs required"
    ],
    "expected_outcome": "A matrix showing CIA priorities for each system with justified reasoning",
    "reflection_questions": [
      "Did any system have equal priorities for all three principles?",
      "How did regulatory requirements (HIPAA) influence your decisions?",
      "What happens if you optimize for one principle at the expense of others?",
      "How would priorities change in an emergency (natural disaster)?"
    ]
  },

  "what_would_you_do": {
    "scenario": "The Encryption Debate",
    "context": "You're the security manager at a financial services firm. The development team wants to implement end-to-end encryption for all customer communications, which would prevent even internal security teams from monitoring for fraud or compliance violations. The compliance team is concerned this violates regulatory requirements for transaction monitoring.",
    "question": "How do you balance confidentiality (customer privacy) with integrity monitoring (fraud detection)?",
    "options": [
      {
        "id": "a",
        "text": "Implement full end-to-end encryption - customer privacy is paramount",
        "is_best": false,
        "feedback": "While this maximizes confidentiality, it prevents the company from meeting regulatory obligations for fraud monitoring. Regulators could impose significant fines.",
        "consequences": "Six months later, a fraud scheme goes undetected because monitoring couldn't see encrypted communications. Regulatory audit finds compliance gaps."
      },
      {
        "id": "b",
        "text": "No encryption - security team needs full visibility for monitoring",
        "is_best": false,
        "feedback": "This fails basic confidentiality requirements. Customer data in transit would be vulnerable, potentially violating data protection regulations.",
        "consequences": "A man-in-the-middle attack exposes thousands of customer transactions. Data breach notification required."
      },
      {
        "id": "c",
        "text": "Implement encryption with compliant key escrow allowing authorized monitoring under documented procedures",
        "is_best": true,
        "feedback": "This balances confidentiality (data encrypted in transit) with integrity monitoring (authorized access for fraud detection). Documented procedures ensure accountability.",
        "consequences": "Customer data is protected, fraud monitoring continues, and regulatory requirements are met. Clear audit trail shows authorized access only."
      },
      {
        "id": "d",
        "text": "Let the compliance team and development team work it out themselves",
        "is_best": false,
        "feedback": "Abdicating the decision leaves the organization in limbo and doesn't address the fundamental security architecture question.",
        "consequences": "Months of debate with no resolution. Meanwhile, neither encryption nor proper monitoring is implemented."
      }
    ],
    "key_lesson": "Real-world security requires balancing competing principles. The 'right' answer usually involves finding solutions that address multiple requirements rather than maximizing one at the expense of others. Document decisions and get stakeholder buy-in."
  },

  "summary": {
    "key_takeaways": [
      "Confidentiality protects data from unauthorized disclosure - encryption is the primary control",
      "Integrity ensures data accuracy and prevents unauthorized modification - hashing and digital signatures are key controls",
      "Availability ensures systems are accessible when needed - redundancy and backups are essential",
      "CIA principles often conflict - security professionals must balance based on business requirements",
      "Classify incidents by CIA impact for clear communication and appropriate response"
    ],
    "exam_essentials": [
      "Know controls that map to each CIA principle",
      "Understand CIA trade-offs and how to prioritize based on context",
      "Hashing = integrity; Encryption = confidentiality; Redundancy = availability",
      "Digital signatures provide both integrity AND authenticity",
      "AAA = Authentication, Authorization, Accounting; Non-repudiation = can't deny actions"
    ],
    "connection_to_next": "The CIA Triad tells us WHAT to protect. The next lesson covers Authentication Methods - HOW we verify identity before granting access to confidential data and systems."
  },

  "related_content": {
    "simulations": ["D1-SIM-002_Security_Concepts"],
    "remediation": ["D1-REM-001_Policy_Fundamentals"],
    "next_lesson": "D1-LESSON-003_Authentication_Methods",
    "previous_lesson": "D1-LESSON-001_Security_Controls_Fundamentals"
  }
}
