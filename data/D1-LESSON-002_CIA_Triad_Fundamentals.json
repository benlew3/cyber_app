{
  "lesson_id": "D1-LESSON-002",
  "domain": 1,
  "title": "CIA Triad and Security Fundamentals",
  "subtitle": "The Three Pillars Every Security Decision Protects",
  "version": "2.0-enhanced",
  "objectives_covered": ["1.2"],
  "estimated_duration": "90-120 minutes (core: 60 min, labs: 30-60 min)",
  "difficulty": "beginner",
  "prerequisites": ["D1-LESSON-001"],

  "skill_tree": {
    "position": {
      "domain": 1,
      "sequence": 2,
      "tier": "foundation"
    },
    "prerequisites": [
      {
        "lesson_id": "D1-LESSON-001",
        "title": "Security Controls Fundamentals",
        "why_needed": "Controls are HOW we protect things; CIA Triad is WHAT we protect"
      }
    ],
    "unlocks": [
      {
        "lesson_id": "D1-LESSON-003",
        "title": "Authentication Methods",
        "connection": "Authentication is the first step in AAA framework introduced here"
      },
      {
        "lesson_id": "D1-LESSON-004",
        "title": "Cryptographic Fundamentals",
        "connection": "Cryptography implements confidentiality and integrity controls"
      }
    ],
    "related_concepts": [
      {
        "topic": "Data Protection",
        "lesson": "D3-LESSON-008",
        "relationship": "CIA Triad drives data protection strategies"
      },
      {
        "topic": "Incident Response",
        "lesson": "D4-LESSON-002",
        "relationship": "Incidents are analyzed by CIA impact"
      },
      {
        "topic": "Risk Management",
        "lesson": "D5-LESSON-002",
        "relationship": "Risks are evaluated by potential CIA impact"
      }
    ],
    "builds_toward": [
      "CompTIA Security+ SY0-701 Certification",
      "CISSP Domain 1: Security and Risk Management",
      "All Security Certifications (CIA is universal)"
    ],
    "cascade_learning": {
      "this_lesson_establishes": [
        "CIA Triad framework (Confidentiality, Integrity, Availability)",
        "Non-repudiation concept",
        "AAA framework (Authentication, Authorization, Accounting)",
        "Data states (at rest, in transit, in use)",
        "RTO and RPO concepts"
      ],
      "builds_on_previous": {
        "D1-LESSON-001": "Controls are categorized by function (preventive, detective) - CIA explains WHAT they protect"
      },
      "concepts_used_later": {
        "D1-LESSON-003": "AAA framework deepens into authentication methods",
        "D1-LESSON-004": "Encryption (confidentiality) and hashing (integrity) in detail",
        "D3-LESSON-007": "RTO and RPO drive disaster recovery planning",
        "D4-LESSON-002": "Incident classification uses CIA impact assessment",
        "D5-LESSON-002": "Risk assessment evaluates potential CIA impact"
      }
    }
  },

  "role_relevance": {
    "soc_analyst": {
      "relevance": "critical",
      "percentage_of_job": "40-50%",
      "daily_usage": "Every alert you triage is assessed for CIA impact. 'Is this a confidentiality breach? Integrity violation? Availability threat?'",
      "specific_tasks": [
        "Classify alerts by CIA impact for prioritization",
        "Assess incident severity based on affected CIA properties",
        "Document CIA impact in incident reports",
        "Communicate technical impacts in business terms"
      ],
      "tools_youll_use": [
        "SIEM (alerting on CIA violations)",
        "DLP (confidentiality monitoring)",
        "File Integrity Monitoring (integrity detection)",
        "Uptime monitoring (availability tracking)"
      ]
    },
    "incident_responder": {
      "relevance": "critical",
      "percentage_of_job": "35-45%",
      "daily_usage": "Incident severity classification, impact assessment, recovery prioritization all use CIA framework",
      "specific_tasks": [
        "Determine incident scope by CIA impact",
        "Prioritize recovery based on availability needs",
        "Assess data exposure (confidentiality)",
        "Verify data integrity post-incident"
      ],
      "tools_youll_use": [
        "Forensic tools (integrity verification)",
        "Hash comparison utilities",
        "Backup/recovery systems (availability)",
        "Encryption verification tools"
      ]
    },
    "security_engineer": {
      "relevance": "critical",
      "percentage_of_job": "60-70%",
      "daily_usage": "Every control you design addresses one or more CIA properties",
      "specific_tasks": [
        "Design controls that address specific CIA requirements",
        "Implement encryption (confidentiality) and hashing (integrity)",
        "Build redundancy and failover (availability)",
        "Balance CIA tradeoffs in architecture decisions"
      ],
      "tools_youll_use": [
        "Encryption tools and key management",
        "Load balancers and clustering (availability)",
        "PKI and certificate management",
        "Integrity verification systems"
      ]
    },
    "grc_analyst": {
      "relevance": "critical",
      "percentage_of_job": "50-60%",
      "daily_usage": "Map controls to CIA objectives, assess compliance requirements by CIA impact",
      "specific_tasks": [
        "Map regulatory requirements to CIA objectives",
        "Assess control effectiveness for each CIA property",
        "Document CIA considerations in risk assessments",
        "Evaluate vendor security by CIA criteria"
      ],
      "tools_youll_use": [
        "GRC platforms (control mapping)",
        "Risk assessment frameworks",
        "Compliance tracking systems"
      ]
    },
    "penetration_tester": {
      "relevance": "high",
      "percentage_of_job": "30-40%",
      "daily_usage": "Frame findings by CIA impact to communicate business risk",
      "specific_tasks": [
        "Identify vulnerabilities by CIA impact",
        "Demonstrate confidentiality breaches (data access)",
        "Show integrity violations (data modification)",
        "Test availability impacts (DoS potential)",
        "Write findings with CIA-framed business impact"
      ],
      "tools_youll_use": [
        "Penetration testing tools",
        "Data exfiltration demonstration tools",
        "DoS testing tools (with authorization)"
      ]
    }
  },

  "introduction": {
    "hook": "Every security decision you'll ever make—whether choosing a firewall, designing an authentication system, or responding to an incident—ultimately comes down to protecting three things: keeping secrets secret, ensuring data hasn't been tampered with, and making sure systems are accessible when needed. These three pillars—Confidentiality, Integrity, and Availability—form the foundation of information security. Miss any one of them, and your security program has a critical gap.",
    
    "learning_goals": [
      "Apply the CIA Triad to analyze security scenarios and identify protection gaps",
      "Distinguish between confidentiality, integrity, and availability controls and threats",
      "Explain non-repudiation and its role in security and legal accountability",
      "Implement the AAA framework (Authentication, Authorization, Accounting) in access control",
      "Differentiate between data states (at rest, in transit, in use) and their protection needs",
      "Calculate and apply RTO and RPO concepts for disaster recovery planning",
      "Recognize how Security+ exam questions test CIA Triad concepts"
    ],
    
    "why_it_matters": {
      "career_impact": "The CIA Triad isn't just theory—it's the lens through which security professionals view every problem. When a SOC analyst triages an alert, they're assessing CIA impact. When a security engineer designs a system, they're ensuring CIA across all components. When an auditor evaluates controls, they're mapping them to CIA objectives.",
      "business_connection": "The 2023 IBM Cost of a Data Breach Report found that breaches affecting all three CIA properties cost 30% more to remediate. Understanding these concepts helps you communicate security value in business terms.",
      "exam_relevance": "Expect 4-6 questions directly testing CIA concepts, plus many more that require applying CIA thinking to scenarios."
    },
    
    "exam_weight": {
      "domain": "Domain 1: General Security Concepts (12%)",
      "estimated_questions": "4-6 questions directly, plus application in many others",
      "question_types": [
        "Scenario: 'Which CIA element was compromised?'",
        "Definition: 'What provides integrity verification?'",
        "Distinction: 'Encryption protects ___; hashing protects ___'",
        "Application: 'To meet this requirement, implement what?'"
      ],
      "high_yield_topics": [
        "Encryption = Confidentiality; Hashing = Integrity distinction",
        "RTO vs RPO definitions",
        "Digital signatures provide integrity + authentication + non-repudiation",
        "MFA requires different factor CATEGORIES",
        "RADIUS vs TACACS+ differences"
      ]
    }
  },

  "sections": [
    {
      "section_id": "D1-L002-S01",
      "title": "Confidentiality: Keeping Secrets Secret",
      "estimated_time": "18 minutes",
      
      "content": {
        "overview": "Confidentiality ensures that information is accessible only to authorized individuals, entities, or processes. It's about preventing unauthorized disclosure—keeping secrets from those who shouldn't have them.",
        
        "core_concepts": [
          {
            "concept": "Why Confidentiality Matters",
            "explanation": "Confidentiality breaches have real-world consequences that extend far beyond IT.",
            "impacts": [
              {
                "impact": "Identity theft",
                "from": "Exposed personal data (SSN, addresses, financial info)",
                "real_cost": "Average identity theft victim spends 200+ hours and $1,000+ resolving"
              },
              {
                "impact": "Competitive disadvantage",
                "from": "Leaked trade secrets, pricing, strategies",
                "real_cost": "Trade secret theft costs US companies $225-600 billion annually"
              },
              {
                "impact": "Regulatory penalties",
                "from": "Disclosed protected information (PHI, PII, PCI)",
                "real_cost": "GDPR fines up to €20 million or 4% global revenue"
              },
              {
                "impact": "Reputational damage",
                "from": "Public disclosure of private data",
                "real_cost": "Stock drops averaging 7.5% after major breach announcements"
              }
            ]
          },
          {
            "concept": "Threats to Confidentiality",
            "categories": [
              {
                "category": "Technical Threats",
                "threats": [
                  {
                    "threat": "Network eavesdropping",
                    "how_it_works": "Attacker captures network traffic using packet sniffers (Wireshark) to read unencrypted data",
                    "what_would_happen_if": "Without encryption, all passwords, emails, and data traversing the network are readable"
                  },
                  {
                    "threat": "Man-in-the-middle (MITM) attacks",
                    "how_it_works": "Attacker positions between two parties, intercepting and potentially modifying traffic",
                    "what_would_happen_if": "Attacker sees all communication and can steal credentials in real-time"
                  },
                  {
                    "threat": "SQL injection",
                    "how_it_works": "Attacker injects malicious SQL to extract database contents",
                    "what_would_happen_if": "Entire database can be dumped, exposing all stored data"
                  },
                  {
                    "threat": "Malware data exfiltration",
                    "how_it_works": "Malware collects and sends sensitive data to attacker-controlled servers",
                    "what_would_happen_if": "Continuous data theft until malware is detected and removed"
                  }
                ]
              },
              {
                "category": "Human Threats",
                "threats": [
                  {
                    "threat": "Social engineering",
                    "how_it_works": "Attacker manipulates people into revealing information",
                    "what_would_happen_if": "Bypasses all technical controls—human gives away the secrets"
                  },
                  {
                    "threat": "Insider threats",
                    "how_it_works": "Authorized users intentionally or accidentally expose data",
                    "what_would_happen_if": "Hardest to detect because access is legitimate"
                  },
                  {
                    "threat": "Shoulder surfing",
                    "how_it_works": "Attacker observes screens or keyboards to capture information",
                    "what_would_happen_if": "Passwords, account numbers, sensitive data captured visually"
                  },
                  {
                    "threat": "Dumpster diving",
                    "how_it_works": "Attacker recovers discarded documents containing sensitive information",
                    "what_would_happen_if": "Paper records with confidential data become accessible"
                  }
                ]
              }
            ]
          },
          {
            "concept": "Controls for Confidentiality",
            "controls": [
              {
                "control": "Encryption",
                "type": "Technical",
                "function": "Primary confidentiality control - transforms readable data into unreadable ciphertext",
                "how_it_works": {
                  "mechanism": "Mathematical algorithms scramble data using a key. Only someone with the correct key can reverse the process and read the data.",
                  "analogy": "Like putting a message in a locked box where only the key holder can open it"
                },
                "implementations": [
                  {
                    "data_state": "Data at Rest",
                    "techniques": ["Full-disk encryption (BitLocker, FileVault)", "Database encryption (TDE)", "File-level encryption"],
                    "purpose": "Protect stored data from physical theft or unauthorized access"
                  },
                  {
                    "data_state": "Data in Transit",
                    "techniques": ["TLS/SSL for web traffic", "VPN for network traffic", "S/MIME or PGP for email"],
                    "purpose": "Protect data moving across networks from interception"
                  },
                  {
                    "data_state": "Data in Use",
                    "techniques": ["Secure enclaves", "Homomorphic encryption (emerging)", "Trusted execution environments"],
                    "purpose": "Protect data while being actively processed"
                  }
                ]
              },
              {
                "control": "Access Controls",
                "type": "Technical/Operational",
                "function": "Limit who can access information based on authorization",
                "how_it_works": {
                  "mechanism": "Define rules about who can access what resources. System enforces rules before granting access.",
                  "analogy": "Like a bouncer with a list of who's allowed into different VIP areas"
                },
                "models": [
                  {"model": "RBAC", "description": "Permissions based on job role (most common)"},
                  {"model": "MAC", "description": "System-enforced based on security labels"},
                  {"model": "DAC", "description": "Owner decides who can access their resources"},
                  {"model": "ABAC", "description": "Dynamic rules based on attributes (user, resource, context)"}
                ]
              },
              {
                "control": "Data Classification",
                "type": "Managerial/Operational",
                "function": "Categorize data by sensitivity to apply appropriate protections",
                "how_it_works": {
                  "mechanism": "Label data based on sensitivity level. Each level has defined handling requirements.",
                  "analogy": "Like sorting mail into different bins that each get different treatment"
                },
                "classification_schemes": [
                  {
                    "type": "Government",
                    "levels": ["Unclassified", "Confidential", "Secret", "Top Secret"],
                    "basis": "Potential damage to national security"
                  },
                  {
                    "type": "Commercial",
                    "levels": ["Public", "Internal", "Confidential", "Restricted"],
                    "basis": "Potential business impact if disclosed"
                  }
                ]
              }
            ]
          },
          {
            "concept": "Data States",
            "explanation": "Confidentiality must be maintained across all data states",
            "states": [
              {
                "state": "At Rest",
                "definition": "Data stored in databases, file systems, backups",
                "protection": "Encryption (FDE, database encryption), access controls, physical security",
                "example": "Customer database on server, backup tapes in storage"
              },
              {
                "state": "In Transit",
                "definition": "Data moving across networks between systems",
                "protection": "TLS, VPN, secure protocols (HTTPS, SFTP, SSH)",
                "example": "Web form submission, email transmission, API calls"
              },
              {
                "state": "In Use",
                "definition": "Data actively being processed in memory or displayed",
                "protection": "Memory protection, secure enclaves, screen privacy",
                "example": "Document open in application, data being computed"
              }
            ]
          }
        ],

        "what_would_happen_if": {
          "scenario": "What if you protected data at rest but not in transit?",
          "consequence": "Data would be protected when stored but exposed whenever moved. Attackers on the network could intercept all data being transmitted—like having a safe but carrying valuables in a clear bag when moving them.",
          "real_example": "The Firesheep attack (2010) demonstrated this perfectly—it captured unencrypted session cookies from users on public WiFi, allowing attackers to hijack sessions for Facebook, Twitter, and other sites that encrypted passwords but not session data.",
          "lesson": "Protection must cover all three data states. A gap in any state creates an attack vector."
        }
      },

      "deep_dive": {
        "title": "Technical Deep Dive: Encryption Algorithms and Key Management",
        "expandable": true,
        "content": {
          "symmetric_encryption": {
            "description": "Same key for encryption and decryption",
            "algorithms": [
              {
                "name": "AES (Advanced Encryption Standard)",
                "key_sizes": ["128-bit", "192-bit", "256-bit"],
                "status": "Current standard, widely used",
                "use_cases": "File encryption, disk encryption, database encryption"
              },
              {
                "name": "3DES (Triple DES)",
                "key_sizes": ["168-bit effective"],
                "status": "Legacy, being phased out",
                "use_cases": "Legacy systems, some financial applications"
              }
            ],
            "advantage": "Fast, efficient for large data",
            "challenge": "Key distribution - how do both parties get the same key securely?"
          },
          "asymmetric_encryption": {
            "description": "Public key encrypts, private key decrypts (or vice versa)",
            "algorithms": [
              {
                "name": "RSA",
                "key_sizes": ["2048-bit minimum", "4096-bit recommended"],
                "status": "Widely used, quantum-vulnerable",
                "use_cases": "Key exchange, digital signatures, certificate encryption"
              },
              {
                "name": "ECC (Elliptic Curve Cryptography)",
                "key_sizes": ["256-bit equivalent to 3072-bit RSA"],
                "status": "Modern, efficient",
                "use_cases": "Mobile devices, IoT, modern TLS"
              }
            ],
            "advantage": "Solves key distribution problem",
            "challenge": "Slow, computationally expensive"
          },
          "hybrid_approach": {
            "description": "Most real-world systems use both",
            "how_it_works": [
              "Use asymmetric encryption to securely exchange a symmetric key",
              "Use symmetric encryption for the actual data (faster)",
              "Example: TLS handshake uses RSA/ECDHE to establish AES session key"
            ]
          },
          "linux_commands": {
            "title": "Encryption Practice Commands (Linux)",
            "commands": [
              {
                "command": "openssl aes-256-cbc -in file.txt -out file.enc",
                "description": "Encrypt a file with AES-256"
              },
              {
                "command": "openssl aes-256-cbc -d -in file.enc -out file.txt",
                "description": "Decrypt a file"
              },
              {
                "command": "gpg -c file.txt",
                "description": "Encrypt with GPG (symmetric)"
              },
              {
                "command": "gpg --gen-key",
                "description": "Generate GPG key pair"
              }
            ]
          }
        }
      },

      "career_spotlight": {
        "role": "Security Engineer",
        "title": "A Day in the Life: Implementing Data Encryption for a Healthcare App",
        "scenario": {
          "time": "Tuesday, 10:00 AM",
          "situation": "Your company is launching a patient portal. You're responsible for ensuring patient data confidentiality meets HIPAA requirements.",
          "your_actions": [
            {
              "step": 1,
              "action": "Identify data requiring protection",
              "details": "You map all PHI (Protected Health Information): patient names, SSN, diagnoses, medications, appointment history. This drives what needs encryption."
            },
            {
              "step": 2,
              "action": "Design encryption at rest",
              "details": "Database: Transparent Data Encryption (TDE) with AES-256. File storage: Server-side encryption. Backups: Encrypted before transfer to backup location."
            },
            {
              "step": 3,
              "action": "Design encryption in transit",
              "details": "TLS 1.3 required for all connections. No fallback to older versions. Certificate pinning in mobile app. Internal service-to-service communication also encrypted."
            },
            {
              "step": 4,
              "action": "Implement key management",
              "details": "Use AWS KMS for key management. Separate keys for different data types. Key rotation every 90 days. Access to keys requires MFA and approval."
            },
            {
              "step": 5,
              "action": "Configure access controls",
              "details": "RBAC model: Doctors see their patients, nurses see their assigned patients, billing sees financial data only, admins don't see PHI. Audit logging on all access."
            },
            {
              "step": 6,
              "action": "Test and document",
              "details": "Penetration test confirms encryption effective. Document controls for HIPAA audit. Create runbook for key management procedures."
            }
          ],
          "outcome": "Patient data is protected at rest and in transit. Access is controlled and audited. HIPAA compliance is documented and demonstrable. Security controls work without impacting user experience."
        },
        "skills_demonstrated": [
          "Encryption implementation",
          "Key management",
          "Access control design",
          "Compliance mapping"
        ]
      },

      "memory_hooks": {
        "mnemonic": "Confidentiality = KEEPING SECRETS",
        "analogy": {
          "concept": "Confidentiality is like envelope security for letters",
          "mapping": [
            "Open postcard = No encryption (anyone can read)",
            "Sealed envelope = Basic protection (hard to read without opening)",
            "Locked box = Encryption (need key to access)",
            "Only you have the key = Access control (authorization)"
          ]
        },
        "common_mistakes": [
          {
            "mistake": "Confusing encryption with hashing",
            "why_wrong": "Encryption is reversible (decrypt with key). Hashing is one-way (can't unhash). Encryption = confidentiality. Hashing = integrity.",
            "memory_aid": "Encryption: lock and unlock with key. Hashing: fingerprint—unique but can't recreate original."
          },
          {
            "mistake": "Thinking password masking provides confidentiality",
            "why_wrong": "Masking (****) only hides display. Data in transit and at rest needs encryption, not just screen masking.",
            "memory_aid": "Masking = hiding from shoulder surfers. Encryption = hiding from network attackers."
          }
        ]
      },

      "micro_checks": [
        {
          "type": "fill_in_blank",
          "position": "after_encryption",
          "question": "__________ is the primary technical control for confidentiality.",
          "answer": "Encryption",
          "hint": "What transforms readable data into unreadable ciphertext?"
        },
        {
          "type": "quick_recall",
          "position": "after_data_states",
          "question": "What are the three data states?",
          "answer": "At rest, in transit, in use",
          "hint": "Where can data be: stored, moving, or being..."
        },
        {
          "type": "application",
          "position": "end_of_section",
          "question": "An attacker intercepts and reads emails between executives. Which CIA element was primarily compromised?",
          "answer": "Confidentiality (unauthorized disclosure)",
          "hint": "Was data exposed (C), modified (I), or unavailable (A)?"
        }
      ],

      "key_points": [
        "Confidentiality prevents unauthorized disclosure of information",
        "Encryption is the primary technical control for confidentiality",
        "Access controls limit who can view information based on authorization",
        "Data classification determines appropriate protection levels",
        "Confidentiality must be maintained in all data states: at rest, in transit, in use"
      ],

      "must_remember_for_exam": [
        {
          "fact": "Encryption protects CONFIDENTIALITY",
          "why_tested": "Critical distinction from hashing (integrity)"
        },
        {
          "fact": "Three data states: at rest, in transit, in use",
          "why_tested": "Questions often ask which control protects which state"
        },
        {
          "fact": "Data classification levels: Unclassified → Confidential → Secret → Top Secret",
          "why_tested": "Government classification is commonly tested"
        }
      ],

      "real_world_example": {
        "scenario": "Protecting patient health information in a hospital",
        "company": "MedCare Health Systems",
        "challenge": "2,000 clinical staff need access to patient records while maintaining HIPAA compliance.",
        "controls_implemented": {
          "encryption": "AES-256 for records at rest, TLS 1.3 for all data in transit",
          "access_controls": "Role-based access—nurses see their patients, physicians see their specialty",
          "classification": "PHI marked as Restricted, specific handling procedures required",
          "physical": "Privacy screens on workstations, badge access to medical records rooms"
        },
        "result": "Authorized staff can efficiently access needed information while unauthorized access is prevented and detected."
      },

      "exam_tips": [
        "Encryption protects CONFIDENTIALITY; hashing protects INTEGRITY—don't confuse them",
        "When a question mentions 'preventing unauthorized access to data,' think confidentiality",
        "Data classification is a CONFIDENTIALITY control—it determines who can access what",
        "Steganography (hiding data within other data) is a confidentiality technique"
      ],

      "glossary_terms": [
        {
          "term": "Confidentiality",
          "definition": "The security principle ensuring that information is accessible only to authorized individuals, entities, or processes, preventing unauthorized disclosure.",
          "exam_note": "First letter of CIA. Think 'keeping secrets secret' or 'preventing unauthorized disclosure.'"
        },
        {
          "term": "Data at Rest",
          "definition": "Data that is stored in databases, file systems, or other storage media and is not actively being transmitted or processed.",
          "exam_note": "Protected by encryption like full-disk encryption (FDE) or database encryption."
        },
        {
          "term": "Data in Transit",
          "definition": "Data that is actively moving across a network or between systems.",
          "also_known_as": "Data in motion",
          "exam_note": "Protected by TLS, VPNs, and secure protocols."
        },
        {
          "term": "Data Classification",
          "definition": "The process of categorizing data based on its sensitivity level to determine appropriate handling and protection requirements.",
          "exam_note": "Know government levels (Unclassified → Top Secret) and that classification drives protection."
        }
      ],

      "knowledge_check": {
        "question": "A company discovers that an attacker intercepted and read emails between executives discussing a planned acquisition. Which element of the CIA Triad was PRIMARILY compromised?",
        "options": [
          "Integrity, because the attacker may have modified the emails",
          "Availability, because the emails were delayed during interception",
          "Confidentiality, because unauthorized access to the email content occurred",
          "Non-repudiation, because the executives can't prove they sent the emails"
        ],
        "correct": 2,
        "explanation": "Confidentiality was compromised because unauthorized access to the email content occurred. The attacker READ the emails—this is unauthorized disclosure.",
        "wrong_answer_analysis": [
          {
            "option": 0,
            "why_tempting": "Interception might include modification",
            "why_wrong": "The question says 'intercepted and read'—no modification mentioned. Reading = confidentiality."
          },
          {
            "option": 1,
            "why_tempting": "Interception could cause delays",
            "why_wrong": "No indication of service disruption. Reading emails doesn't affect availability."
          },
          {
            "option": 3,
            "why_tempting": "Email authenticity might be questioned",
            "why_wrong": "Non-repudiation is about proving actions occurred. The issue here is disclosure, not proof of sending."
          }
        ]
      }
    },

    {
      "section_id": "D1-L002-S02",
      "title": "Integrity: Ensuring Trustworthy Data",
      "estimated_time": "18 minutes",
      
      "content": {
        "overview": "Integrity ensures that data remains accurate, complete, and unaltered except by authorized processes. It's about trusting that what you're seeing is what was intended—that data hasn't been tampered with.",
        
        "core_concepts": [
          {
            "concept": "Why Integrity Matters",
            "explanation": "Integrity violations can have consequences ranging from inconvenience to life-threatening.",
            "impacts": [
              {
                "impact": "Financial fraud",
                "from": "Altered transaction records, modified invoices",
                "real_example": "Attacker modifies wire transfer amount from $10,000 to $100,000"
              },
              {
                "impact": "Medical errors",
                "from": "Modified patient data, changed medication dosages",
                "real_example": "Altered allergy record leads to wrong prescription"
              },
              {
                "impact": "System compromise",
                "from": "Tampered configurations, modified executables",
                "real_example": "Modified system files hide malware presence"
              },
              {
                "impact": "Legal issues",
                "from": "Modified evidence, altered logs",
                "real_example": "Tampered audit logs inadmissible in court"
              }
            ]
          },
          {
            "concept": "Threats to Integrity",
            "categories": [
              {
                "category": "Intentional Modification",
                "threats": [
                  {
                    "threat": "Data manipulation attacks",
                    "how_it_works": "Attacker modifies data to commit fraud or cause harm",
                    "example": "Changing bank account numbers in invoices"
                  },
                  {
                    "threat": "Malware modifying system files",
                    "how_it_works": "Malware changes OS files to hide presence or maintain persistence",
                    "example": "Rootkit modifying kernel to hide processes"
                  },
                  {
                    "threat": "Man-in-the-middle modification",
                    "how_it_works": "Attacker intercepts and alters data in transit",
                    "example": "Modifying download to include malware"
                  },
                  {
                    "threat": "SQL injection modification",
                    "how_it_works": "Attacker injects SQL to UPDATE or DELETE records",
                    "example": "Changing prices in product database"
                  }
                ]
              },
              {
                "category": "Unintentional Modification",
                "threats": [
                  {
                    "threat": "Hardware failures",
                    "how_it_works": "Disk errors, memory corruption causing data changes",
                    "example": "Bit rot corrupting stored files over time"
                  },
                  {
                    "threat": "Software bugs",
                    "how_it_works": "Application errors causing incorrect data writes",
                    "example": "Race condition causing partial record updates"
                  },
                  {
                    "threat": "Transmission errors",
                    "how_it_works": "Network issues causing data corruption in transit",
                    "example": "Packet corruption changing file contents"
                  },
                  {
                    "threat": "Human error",
                    "how_it_works": "Mistakes during data entry or modification",
                    "example": "Typo in financial record"
                  }
                ]
              }
            ]
          },
          {
            "concept": "Controls for Integrity",
            "controls": [
              {
                "control": "Hashing",
                "type": "Technical",
                "function": "Creates fixed-size 'fingerprints' that detect any modification",
                "how_it_works": {
                  "mechanism": "Hash function processes data through mathematical algorithm, producing fixed-size output. Any change to input—even one bit—produces completely different hash.",
                  "analogy": "Like a unique fingerprint for data. Change anything and the fingerprint is completely different.",
                  "key_property": "One-way function—can't reverse hash to get original data",
                  "example_flow": "Original file → Hash function → Hash value (e.g., 'abc123') → Store hash → Later: Rehash file → Compare → Match = unmodified"
                },
                "algorithms": [
                  {
                    "algorithm": "MD5",
                    "output": "128-bit hash",
                    "status": "WEAK - Collisions found - Don't use for security",
                    "still_used_for": "Checksums, non-security verification"
                  },
                  {
                    "algorithm": "SHA-1",
                    "output": "160-bit hash",
                    "status": "DEPRECATED - Collisions demonstrated",
                    "still_used_for": "Legacy systems only"
                  },
                  {
                    "algorithm": "SHA-256 (SHA-2 family)",
                    "output": "256-bit hash",
                    "status": "CURRENT STANDARD",
                    "used_for": "Digital signatures, certificates, integrity verification"
                  },
                  {
                    "algorithm": "SHA-3",
                    "output": "Variable (224-512 bits)",
                    "status": "CURRENT STANDARD (newest)",
                    "used_for": "Modern implementations, post-quantum preparation"
                  }
                ],
                "use_cases": [
                  "File integrity verification (did download corrupt?)",
                  "Password storage (store hash, not password)",
                  "Digital forensics (prove evidence unaltered)",
                  "Change detection (file integrity monitoring)"
                ]
              },
              {
                "control": "Digital Signatures",
                "type": "Technical",
                "function": "Combines hashing with asymmetric encryption to prove integrity AND origin",
                "how_it_works": {
                  "mechanism": "Sender hashes message, encrypts hash with PRIVATE key (creating signature), attaches to message. Receiver decrypts with PUBLIC key, computes own hash, compares.",
                  "analogy": "Like signing a letter with a unique wax seal that only you can create but anyone can verify.",
                  "provides": ["Integrity (hash verifies content)", "Authentication (only private key holder could sign)", "Non-repudiation (signer can't deny signing)"]
                },
                "process": [
                  "1. Sender creates hash of message",
                  "2. Sender encrypts hash with their PRIVATE key (signature)",
                  "3. Sender attaches signature to message",
                  "4. Receiver decrypts signature with sender's PUBLIC key",
                  "5. Receiver creates own hash of received message",
                  "6. Receiver compares: match = verified"
                ],
                "critical_distinction": "Signing with PRIVATE key, verifying with PUBLIC key (opposite of encryption)"
              },
              {
                "control": "Input Validation",
                "type": "Technical",
                "function": "Prevents integrity violations at data entry point",
                "how_it_works": {
                  "mechanism": "Check all input before accepting: type, format, range, allowed characters. Reject or sanitize invalid input.",
                  "analogy": "Like a bouncer checking IDs—verify before letting data in."
                },
                "validation_types": [
                  "Type checking (is this really a number?)",
                  "Range checking (is value within acceptable bounds?)",
                  "Format validation (does email look like email?)",
                  "Sanitization (remove potentially harmful characters)"
                ]
              },
              {
                "control": "File Integrity Monitoring (FIM)",
                "type": "Technical (Detective)",
                "function": "Detects unauthorized file modifications",
                "how_it_works": {
                  "mechanism": "Baseline system creates hashes of important files. Monitor continuously compares current hashes to baseline. Alert on any change.",
                  "analogy": "Like a tripwire—any movement triggers an alarm."
                },
                "common_tools": ["Tripwire", "OSSEC", "AIDE", "Windows Defender FIM"],
                "role_relevance": {
                  "soc_analyst": "You'll see FIM alerts when files change unexpectedly—could be attacker or legitimate change",
                  "security_engineer": "You'll configure FIM to monitor critical system files and configurations"
                }
              }
            ]
          },
          {
            "concept": "Integrity vs. Confidentiality: Critical Distinction",
            "explanation": "These are different protections for different threats",
            "comparison": [
              {
                "aspect": "Question answered",
                "confidentiality": "Was data SEEN by unauthorized parties?",
                "integrity": "Was data CHANGED by unauthorized parties?"
              },
              {
                "aspect": "Primary control",
                "confidentiality": "Encryption",
                "integrity": "Hashing"
              },
              {
                "aspect": "Attack example",
                "confidentiality": "Reading intercepted emails",
                "integrity": "Modifying intercepted emails"
              },
              {
                "aspect": "Control goal",
                "confidentiality": "Hide data from unauthorized access",
                "integrity": "Detect if data was modified"
              }
            ],
            "exam_importance": "This distinction appears frequently. Know: Encryption = Confidentiality, Hashing = Integrity"
          }
        ],

        "what_would_happen_if": {
          "scenario": "What if you encrypted data but didn't verify integrity?",
          "consequence": "An attacker could modify the encrypted data (ciphertext). When decrypted, you'd get corrupted or malicious data and have no way to know it was modified. Encryption alone doesn't tell you if something changed.",
          "real_example": "Padding oracle attacks exploit this—attackers can modify encrypted data without knowing the key, and the system processes the corrupted decrypted result.",
          "lesson": "Modern encryption modes (like AES-GCM) combine encryption with authentication (integrity checking) for this reason."
        }
      },

      "deep_dive": {
        "title": "Technical Deep Dive: Hashing in Practice",
        "expandable": true,
        "content": {
          "hash_properties": {
            "required_properties": [
              {
                "property": "Deterministic",
                "meaning": "Same input always produces same output",
                "importance": "Enables verification by comparing hashes"
              },
              {
                "property": "One-way (Pre-image resistant)",
                "meaning": "Cannot derive input from output",
                "importance": "Protects original data (passwords)"
              },
              {
                "property": "Collision resistant",
                "meaning": "Infeasible to find two inputs with same hash",
                "importance": "Prevents forgery attacks"
              },
              {
                "property": "Avalanche effect",
                "meaning": "Small input change = completely different output",
                "importance": "Even one-bit change is detectable"
              }
            ]
          },
          "linux_commands": {
            "title": "Hashing Practice Commands (Linux)",
            "commands": [
              {
                "command": "sha256sum file.txt",
                "description": "Generate SHA-256 hash of file"
              },
              {
                "command": "sha256sum -c file.sha256",
                "description": "Verify file against stored hash"
              },
              {
                "command": "echo -n 'password' | sha256sum",
                "description": "Hash a string"
              },
              {
                "command": "md5sum file.txt",
                "description": "Generate MD5 (for checksums only)"
              },
              {
                "command": "openssl dgst -sha256 file.txt",
                "description": "Hash with OpenSSL"
              }
            ],
            "practice_exercise": {
              "title": "Integrity Verification Exercise",
              "steps": [
                "Create a text file: echo 'Hello World' > test.txt",
                "Generate hash: sha256sum test.txt > test.sha256",
                "View hash: cat test.sha256",
                "Modify file: echo 'Hello World!' > test.txt (added !)",
                "Verify: sha256sum -c test.sha256",
                "Observe: FAILED (hash doesn't match)"
              ],
              "learning_point": "Even adding one character completely changes the hash"
            }
          },
          "digital_signature_demo": {
            "title": "Digital Signature with GPG",
            "commands": [
              {
                "command": "gpg --gen-key",
                "description": "Generate key pair (first time)"
              },
              {
                "command": "gpg --sign file.txt",
                "description": "Sign a file (creates file.txt.gpg)"
              },
              {
                "command": "gpg --verify file.txt.gpg",
                "description": "Verify signature"
              },
              {
                "command": "gpg --clearsign file.txt",
                "description": "Sign with readable output"
              }
            ]
          }
        }
      },

      "career_spotlight": {
        "role": "SOC Analyst",
        "title": "A Day in the Life: Investigating a File Integrity Alert",
        "scenario": {
          "time": "Wednesday, 11:30 PM",
          "situation": "Your FIM system alerts: '/etc/passwd was modified' on a production Linux server.",
          "your_actions": [
            {
              "step": 1,
              "action": "Assess the alert",
              "details": "You check the alert details: file modified at 11:27 PM, no scheduled changes, no change tickets for this server. This is suspicious."
            },
            {
              "step": 2,
              "action": "Review the change",
              "details": "You compare current /etc/passwd to the baseline. A new user 'admin2' was added with UID 0 (root privileges)."
            },
            {
              "step": 3,
              "action": "Correlate with other logs",
              "details": "You check authentication logs: SSH login from unusual IP at 11:25 PM using stolen credentials. Escalate to incident."
            },
            {
              "step": 4,
              "action": "Document findings",
              "details": "Timeline: 11:25 PM unauthorized SSH login → 11:27 PM /etc/passwd modified to add backdoor account. Clear integrity violation indicating compromise."
            }
          ],
          "outcome": "Your FIM detected an integrity violation that would otherwise have gone unnoticed. The attacker created a persistent backdoor by modifying a system file—a classic integrity attack."
        },
        "skills_demonstrated": [
          "FIM alert triage",
          "Log correlation",
          "Integrity violation detection",
          "Incident documentation"
        ]
      },

      "memory_hooks": {
        "mnemonic": "Integrity = TRUST THE DATA",
        "analogy": {
          "concept": "Integrity is like tamper-evident packaging",
          "mapping": [
            "Hash = Seal on medicine bottle (shows if opened)",
            "Digital signature = Wax seal with your unique stamp (proves who sealed it)",
            "FIM = Security camera on the shelf (detects any tampering)"
          ]
        },
        "common_mistakes": [
          {
            "mistake": "Thinking encryption provides integrity",
            "why_wrong": "Encryption hides data but doesn't detect modification. Encrypted data can still be altered.",
            "memory_aid": "Encryption = Lock on a box. Hashing = Tamper-evident seal. Both protect differently."
          },
          {
            "mistake": "Using MD5 or SHA-1 for security",
            "why_wrong": "Collisions found—attackers can create different files with same hash.",
            "memory_aid": "MD5 = Maybe Don't (use it). SHA-1 = Should Have Avoided (it). SHA-256 = Safe Hash Algorithm."
          }
        ]
      },

      "micro_checks": [
        {
          "type": "fill_in_blank",
          "position": "after_hashing",
          "question": "__________ creates fixed-size fingerprints to verify data hasn't been modified.",
          "answer": "Hashing",
          "hint": "One-way function that produces unique output for each input"
        },
        {
          "type": "comparison",
          "position": "after_distinction",
          "question": "Encryption protects ___; Hashing protects ___.",
          "answer": "Confidentiality; Integrity",
          "hint": "Hiding vs. verifying"
        },
        {
          "type": "application",
          "position": "end_of_section",
          "question": "A system administrator needs to verify a configuration file hasn't changed. What control?",
          "answer": "Compare current hash against known-good baseline hash",
          "hint": "How do you detect changes to data?"
        }
      ],

      "key_points": [
        "Integrity ensures data is accurate, complete, and unaltered except by authorized processes",
        "Hashing creates fingerprints that detect any modification",
        "Digital signatures prove both integrity AND authenticity (who sent it)",
        "Encryption protects confidentiality; hashing protects integrity—different purposes",
        "File Integrity Monitoring (FIM) is a detective control that alerts on unauthorized changes"
      ],

      "must_remember_for_exam": [
        {
          "fact": "HASHING = INTEGRITY (not confidentiality)",
          "why_tested": "Critical distinction from encryption"
        },
        {
          "fact": "MD5 = weak, SHA-1 = deprecated, SHA-256 = current standard",
          "why_tested": "Algorithm status is commonly tested"
        },
        {
          "fact": "Digital signatures provide integrity + authentication + non-repudiation",
          "why_tested": "Multiple choice often tests what digital signatures provide"
        }
      ],

      "glossary_terms": [
        {
          "term": "Integrity",
          "definition": "The security principle ensuring that data remains accurate, complete, and unaltered except by authorized modification.",
          "exam_note": "Second letter of CIA. Think 'data hasn't been tampered with.'"
        },
        {
          "term": "Hash Function",
          "definition": "A one-way mathematical function that converts input of any size into fixed-size output, where any change produces completely different hash.",
          "exam_note": "Hashing is ONE-WAY (can't reverse). Used for integrity and password storage."
        },
        {
          "term": "Digital Signature",
          "definition": "A cryptographic technique using the sender's private key to create a signature proving both integrity and identity.",
          "exam_note": "Provides INTEGRITY + AUTHENTICATION + NON-REPUDIATION. Sign with private, verify with public."
        },
        {
          "term": "File Integrity Monitoring (FIM)",
          "definition": "A security control that detects file changes by comparing current hashes against known-good baselines.",
          "exam_note": "Detective control. Tripwire is a classic FIM example."
        }
      ],

      "knowledge_check": {
        "question": "A system administrator needs to verify that a configuration file hasn't been modified since it was last approved. Which control is MOST appropriate?",
        "options": [
          "Encrypt the file with AES-256 to prevent unauthorized viewing",
          "Compare the file's current hash against the known-good baseline hash",
          "Store the file on a server with strong access controls",
          "Create a backup copy of the file for comparison"
        ],
        "correct": 1,
        "explanation": "Comparing the current hash to a known-good baseline detects any modifications, verifying integrity. Hashing is the standard method for integrity verification.",
        "wrong_answer_analysis": [
          {
            "option": 0,
            "why_tempting": "Encryption sounds secure",
            "why_wrong": "Encryption protects confidentiality, not integrity detection. Encrypted files can still be modified."
          },
          {
            "option": 2,
            "why_tempting": "Access controls prevent unauthorized changes",
            "why_wrong": "Access controls are preventive but don't detect if changes occurred (maybe through authorized account)."
          },
          {
            "option": 3,
            "why_tempting": "Backup comparison could work",
            "why_wrong": "Less efficient than hashing and doesn't provide cryptographic proof. Backup could also be modified."
          }
        ]
      }
    },

    {
      "section_id": "D1-L002-S03",
      "title": "Availability: Ensuring Access When Needed",
      "estimated_time": "15 minutes",
      
      "content": {
        "overview": "Availability ensures that systems, data, and resources are accessible to authorized users when needed. It's about uptime, reliability, and resilience—making sure technology works when people need it.",
        
        "core_concepts": [
          {
            "concept": "Why Availability Matters",
            "explanation": "Downtime has real costs measured in money, safety, and reputation.",
            "impacts": [
              {
                "impact": "Revenue loss",
                "from": "E-commerce downtime",
                "real_cost": "Amazon estimates $34 million/hour in revenue during outages"
              },
              {
                "impact": "Patient safety",
                "from": "Unavailable medical systems",
                "real_cost": "Hospital ransomware attacks linked to patient deaths"
              },
              {
                "impact": "Productivity loss",
                "from": "Inaccessible business applications",
                "real_cost": "Average employee loses 30+ min/day to IT issues"
              },
              {
                "impact": "Contractual penalties",
                "from": "SLA violations",
                "real_cost": "Cloud providers pay millions in SLA credits annually"
              }
            ]
          },
          {
            "concept": "Threats to Availability",
            "categories": [
              {
                "category": "Intentional Attacks",
                "threats": [
                  {
                    "threat": "Denial of Service (DoS/DDoS)",
                    "how_it_works": "Overwhelm systems with traffic or requests until they can't serve legitimate users",
                    "what_would_happen_if": "Website becomes unreachable. Business operations halt."
                  },
                  {
                    "threat": "Ransomware",
                    "how_it_works": "Encrypt systems and data, rendering them inaccessible until ransom paid",
                    "what_would_happen_if": "All systems offline. No access to data. Operations stop."
                  },
                  {
                    "threat": "Sabotage",
                    "how_it_works": "Intentional destruction of infrastructure by insider or attacker",
                    "what_would_happen_if": "Critical systems destroyed. Extended recovery time."
                  }
                ]
              },
              {
                "category": "Unintentional Failures",
                "threats": [
                  {
                    "threat": "Hardware failures",
                    "how_it_works": "Disk crashes, power supply failures, memory errors",
                    "what_would_happen_if": "System offline until hardware replaced."
                  },
                  {
                    "threat": "Software bugs",
                    "how_it_works": "Application crashes, memory leaks, infinite loops",
                    "what_would_happen_if": "Service unavailable until bug fixed or system restarted."
                  },
                  {
                    "threat": "Natural disasters",
                    "how_it_works": "Floods, fires, earthquakes affecting data centers",
                    "what_would_happen_if": "Entire facility offline. Need disaster recovery."
                  },
                  {
                    "threat": "Human error",
                    "how_it_works": "Misconfigurations, accidental deletions",
                    "what_would_happen_if": "Service disruption until error corrected."
                  }
                ]
              }
            ]
          },
          {
            "concept": "Controls for Availability",
            "controls": [
              {
                "control": "Redundancy",
                "type": "Technical",
                "function": "Eliminate single points of failure by duplicating critical components",
                "how_it_works": {
                  "mechanism": "If one component fails, another takes over. Multiple copies of critical resources.",
                  "analogy": "Like having a spare tire—if one fails, you have a backup."
                },
                "types": [
                  {
                    "type": "Server redundancy",
                    "implementations": ["Clustering", "Load balancing", "Active-passive failover"],
                    "benefit": "Server failure doesn't stop service"
                  },
                  {
                    "type": "Storage redundancy",
                    "implementations": ["RAID arrays", "SAN replication", "Multiple copies"],
                    "benefit": "Disk failure doesn't lose data"
                  },
                  {
                    "type": "Network redundancy",
                    "implementations": ["Multiple ISPs", "Redundant paths", "BGP failover"],
                    "benefit": "Network failure doesn't disconnect"
                  },
                  {
                    "type": "Power redundancy",
                    "implementations": ["UPS", "Generators", "Dual power supplies"],
                    "benefit": "Power failure doesn't stop systems"
                  },
                  {
                    "type": "Geographic redundancy",
                    "implementations": ["Multiple data centers", "DR sites", "Cloud regions"],
                    "benefit": "Site failure doesn't stop business"
                  }
                ]
              },
              {
                "control": "Fault Tolerance",
                "type": "Technical",
                "function": "Continue operating despite component failures",
                "how_it_works": {
                  "mechanism": "System designed to handle failures automatically without human intervention.",
                  "key_distinction": "Goes beyond redundancy—fault-tolerant systems AUTOMATICALLY continue without interruption."
                },
                "examples": [
                  "RAID 5/6 continues operating during disk failure",
                  "Hot standby servers take over instantly",
                  "Self-healing systems restart failed components"
                ]
              },
              {
                "control": "Backups",
                "type": "Operational",
                "function": "Create copies of data for recovery",
                "how_it_works": {
                  "mechanism": "Regular copies of data stored separately. Restore from backup after data loss."
                },
                "backup_types": [
                  {
                    "type": "Full Backup",
                    "description": "Complete copy of all data",
                    "pros": "Simple restoration",
                    "cons": "Time and storage intensive"
                  },
                  {
                    "type": "Incremental Backup",
                    "description": "Only data changed since last backup",
                    "pros": "Fast, minimal storage",
                    "cons": "Restoration requires all increments"
                  },
                  {
                    "type": "Differential Backup",
                    "description": "Data changed since last FULL backup",
                    "pros": "Faster restoration than incremental",
                    "cons": "Grows larger over time"
                  }
                ],
                "3_2_1_rule": {
                  "description": "Best practice for backup strategy",
                  "rule": "3 copies of data, 2 different media types, 1 offsite",
                  "example": "Original + local backup (different disk) + cloud backup"
                }
              },
              {
                "control": "Disaster Recovery",
                "type": "Technical/Operational",
                "function": "Plan and prepare for major disruptions",
                "key_metrics": [
                  {
                    "metric": "Recovery Time Objective (RTO)",
                    "definition": "Maximum acceptable downtime",
                    "question_answered": "How long can we be down?",
                    "example": "RTO of 4 hours means service must be restored within 4 hours of failure"
                  },
                  {
                    "metric": "Recovery Point Objective (RPO)",
                    "definition": "Maximum acceptable data loss (measured in time)",
                    "question_answered": "How much data can we lose?",
                    "example": "RPO of 1 hour means we can lose up to 1 hour of data, so backup at least hourly"
                  }
                ],
                "site_types": [
                  {
                    "type": "Hot Site",
                    "description": "Fully equipped, ready immediately",
                    "recovery_time": "Minutes to hours",
                    "cost": "Highest"
                  },
                  {
                    "type": "Warm Site",
                    "description": "Partially equipped, needs data restore",
                    "recovery_time": "Hours to days",
                    "cost": "Medium"
                  },
                  {
                    "type": "Cold Site",
                    "description": "Basic facilities only, needs everything",
                    "recovery_time": "Days to weeks",
                    "cost": "Lowest"
                  }
                ]
              }
            ]
          }
        ],

        "what_would_happen_if": {
          "scenario": "What if RTO is 4 hours but you can only recover in 8 hours?",
          "consequence": "Business operations exceed acceptable downtime. Revenue loss, SLA violations, customer impact, and potential business failure if outage is critical enough. RTO isn't a suggestion—it's a business requirement.",
          "lesson": "DR planning must match or beat RTO/RPO targets. If you can't meet them, either invest in better recovery capabilities or adjust business expectations."
        }
      },

      "deep_dive": {
        "title": "Technical Deep Dive: RAID Levels",
        "expandable": true,
        "content": {
          "raid_overview": {
            "definition": "Redundant Array of Independent Disks - combines multiple disks for performance and/or redundancy",
            "levels": [
              {
                "level": "RAID 0",
                "name": "Striping",
                "description": "Data split across disks, no redundancy",
                "minimum_disks": 2,
                "fault_tolerance": "None - any disk failure loses all data",
                "use_case": "Performance only, non-critical data"
              },
              {
                "level": "RAID 1",
                "name": "Mirroring",
                "description": "Data duplicated on two disks",
                "minimum_disks": 2,
                "fault_tolerance": "1 disk can fail",
                "use_case": "Critical data, simple redundancy"
              },
              {
                "level": "RAID 5",
                "name": "Striping with distributed parity",
                "description": "Data and parity spread across all disks",
                "minimum_disks": 3,
                "fault_tolerance": "1 disk can fail",
                "use_case": "Balance of performance, capacity, redundancy"
              },
              {
                "level": "RAID 6",
                "name": "Striping with double parity",
                "description": "Like RAID 5 but can survive 2 disk failures",
                "minimum_disks": 4,
                "fault_tolerance": "2 disks can fail",
                "use_case": "Large arrays where rebuild time is long"
              },
              {
                "level": "RAID 10",
                "name": "Mirrored stripes",
                "description": "RAID 1 + RAID 0 combined",
                "minimum_disks": 4,
                "fault_tolerance": "1 disk per mirror",
                "use_case": "High performance and redundancy"
              }
            ]
          },
          "exam_focus": "Know RAID 0 has NO redundancy, RAID 1 mirrors, RAID 5 uses parity (survives 1 failure)"
        }
      },

      "memory_hooks": {
        "mnemonic": "Availability = UPTIME",
        "rto_rpo_distinction": {
          "rto": "Recovery TIME Objective = How long can we be DOWN? (downtime)",
          "rpo": "Recovery POINT Objective = How much DATA can we lose? (data loss)",
          "memory_aid": "RTO = Time down. RPO = Point (in time) you recover TO."
        },
        "common_mistakes": [
          {
            "mistake": "Confusing RTO and RPO",
            "why_wrong": "They measure different things—RTO is downtime, RPO is data loss",
            "memory_aid": "RTO = 'Response TIME' (how fast you recover). RPO = 'Recovery POINT' (how far back you go)."
          },
          {
            "mistake": "Thinking RAID 0 provides redundancy",
            "why_wrong": "RAID 0 is striping only—NO redundancy. Any disk failure loses everything.",
            "memory_aid": "RAID 0 = 0 redundancy."
          }
        ]
      },

      "key_points": [
        "Availability ensures systems and data are accessible when authorized users need them",
        "Redundancy eliminates single points of failure",
        "RTO = maximum acceptable downtime; RPO = maximum acceptable data loss",
        "Hot site = immediate failover; Warm = hours; Cold = days",
        "3-2-1 backup rule: 3 copies, 2 media types, 1 offsite"
      ],

      "must_remember_for_exam": [
        {
          "fact": "RTO = maximum downtime; RPO = maximum data loss",
          "why_tested": "Definition questions are common"
        },
        {
          "fact": "Hot site = fastest/most expensive; Cold site = slowest/cheapest",
          "why_tested": "Site type comparison questions"
        },
        {
          "fact": "RAID 0 = no redundancy; RAID 1 = mirroring; RAID 5 = parity",
          "why_tested": "RAID levels frequently tested"
        }
      ],

      "knowledge_check": {
        "question": "A company's RTO is 4 hours and RPO is 1 hour. Their database server fails at 3:00 PM and the last backup was at 2:00 PM. Based on their objectives, which statement is correct?",
        "options": [
          "They must restore service by 7:00 PM and can accept losing data back to 2:00 PM",
          "They must restore service by 4:00 PM and can accept losing data back to 2:00 PM",
          "They must restore service by 7:00 PM and must recover all data up to 3:00 PM",
          "They must restore service within 1 hour and can lose up to 4 hours of data"
        ],
        "correct": 0,
        "explanation": "RTO of 4 hours means service must be restored within 4 hours (3 PM + 4 = 7 PM). RPO of 1 hour means up to 1 hour of data loss is acceptable, so losing back to 2 PM (1 hour before failure) is within limits.",
        "wrong_answer_analysis": [
          {
            "option": 1,
            "why_tempting": "4 PM is 1 hour after failure",
            "why_wrong": "That would be a 1-hour RTO, not 4-hour. They have 4 hours total."
          },
          {
            "option": 2,
            "why_tempting": "Recovering all data sounds better",
            "why_wrong": "RPO of 1 hour means they can ACCEPT 1 hour of loss. Zero loss isn't required."
          },
          {
            "option": 3,
            "why_tempting": "Confused RTO and RPO values",
            "why_wrong": "Values are swapped. RTO = time (4 hours), RPO = data (1 hour)."
          }
        ]
      }
    },

    {
      "section_id": "D1-L002-S04",
      "title": "Non-Repudiation: Proving Actions Occurred",
      "estimated_time": "12 minutes",
      
      "content": {
        "overview": "Non-repudiation prevents individuals from denying actions they performed. It provides undeniable proof that a specific action was taken by a specific entity—essential for legal accountability and audit trails.",
        
        "core_concepts": [
          {
            "concept": "Non-Repudiation vs. Authentication",
            "explanation": "These are related but different",
            "distinction": [
              {
                "aspect": "Authentication",
                "purpose": "Verifies identity at a point in time",
                "question": "Are you who you claim to be?",
                "limitation": "Someone could claim their credentials were stolen"
              },
              {
                "aspect": "Non-repudiation",
                "purpose": "Provides proof that can be verified later",
                "question": "Can you deny you did this?",
                "strength": "Cryptographic proof that specific person acted"
              }
            ]
          },
          {
            "concept": "Achieving Non-Repudiation",
            "mechanisms": [
              {
                "mechanism": "Digital Signatures",
                "description": "Primary technical mechanism",
                "how_it_works": {
                  "process": [
                    "User signs with their PRIVATE key (only they possess)",
                    "Signature can be verified with their PUBLIC key",
                    "Valid signature = that specific private key was used",
                    "Private key holder cannot deny signing"
                  ],
                  "key_point": "If your private key signed it and your key wasn't compromised, YOU signed it."
                }
              },
              {
                "mechanism": "PKI and Certificate Authorities",
                "description": "Binds identities to public keys",
                "how_it_works": {
                  "process": [
                    "CA verifies identity before issuing certificate",
                    "Certificate binds public key to verified identity",
                    "Signature verification confirms key holder's identity"
                  ],
                  "key_point": "CA establishes trust that this public key belongs to this person."
                }
              },
              {
                "mechanism": "Timestamps",
                "description": "Proves WHEN action occurred",
                "how_it_works": "Trusted timestamping services provide cryptographically signed proof of timing"
              },
              {
                "mechanism": "Audit Logs",
                "description": "Records WHO did WHAT and WHEN",
                "requirements": "Tamper-evident logging, write-once storage, integrity protection"
              }
            ]
          }
        ],

        "what_would_happen_if": {
          "scenario": "What if you used shared credentials?",
          "consequence": "Non-repudiation is impossible. If five people share a password, any of them could have taken an action. None can be proven individually responsible. This is why shared accounts violate security best practices.",
          "lesson": "Non-repudiation requires individual accountability—each person must have unique credentials, ideally with digital signatures for critical actions."
        }
      },

      "key_points": [
        "Non-repudiation prevents denial of actions by providing undeniable proof",
        "Digital signatures are the primary mechanism for technical non-repudiation",
        "Shared credentials destroy non-repudiation—anyone with access could have acted",
        "PKI and CAs bind identities to keys for verification",
        "Audit logs and timestamps support non-repudiation by recording who did what and when"
      ],

      "must_remember_for_exam": [
        {
          "fact": "Digital signatures provide non-repudiation (encryption alone does NOT)",
          "why_tested": "Common distinction question"
        },
        {
          "fact": "Private key signatures = non-repudiation (only key holder could sign)",
          "why_tested": "Tests understanding of digital signature mechanism"
        }
      ],

      "knowledge_check": {
        "question": "An employee claims they didn't authorize a large purchase order, despite records showing it was submitted from their account. Which control would provide the STRONGEST evidence they DID authorize it?",
        "options": [
          "Audit logs showing the purchase order was submitted from their workstation",
          "Multi-factor authentication records showing they logged in before submission",
          "A digital signature on the purchase order created with their private key",
          "Video surveillance showing them at their desk when the order was submitted"
        ],
        "correct": 2,
        "explanation": "A digital signature created with the employee's private key provides non-repudiation—cryptographic proof that their specific key was used. Only they should possess their private key.",
        "wrong_answer_analysis": [
          {
            "option": 0,
            "why_tempting": "Logs show where it came from",
            "why_wrong": "Someone else could have used their workstation. Logs show source, not person."
          },
          {
            "option": 1,
            "why_tempting": "MFA proves they logged in",
            "why_wrong": "MFA proves login but not who submitted the specific order after login."
          },
          {
            "option": 3,
            "why_tempting": "Video shows physical presence",
            "why_wrong": "Shows they were there but not that they submitted the specific order."
          }
        ]
      }
    },

    {
      "section_id": "D1-L002-S05",
      "title": "AAA Framework: Authentication, Authorization, and Accounting",
      "estimated_time": "15 minutes",
      
      "content": {
        "overview": "The AAA framework provides a systematic approach to access control: verifying identity (Authentication), determining permissions (Authorization), and tracking activity (Accounting). These three functions work together to control and monitor access.",
        
        "core_concepts": [
          {
            "concept": "Authentication: Who Are You?",
            "definition": "Verifying the claimed identity of a user, device, or process",
            "authentication_factors": [
              {
                "factor": "Something you know",
                "examples": ["Password", "PIN", "Security questions"],
                "weakness": "Can be guessed, stolen, or shared"
              },
              {
                "factor": "Something you have",
                "examples": ["Smart card", "Hardware token", "Phone"],
                "weakness": "Can be lost, stolen, or cloned"
              },
              {
                "factor": "Something you are",
                "examples": ["Fingerprint", "Retina", "Face"],
                "weakness": "Can't be changed if compromised"
              },
              {
                "factor": "Somewhere you are",
                "examples": ["GPS location", "IP address", "Network"],
                "weakness": "Can be spoofed"
              },
              {
                "factor": "Something you do",
                "examples": ["Typing pattern", "Walking gait", "Voice"],
                "weakness": "Can vary, may have false rejections"
              }
            ],
            "mfa_critical_concept": {
              "definition": "Multi-Factor Authentication requires factors from DIFFERENT categories",
              "is_mfa": ["Password + SMS code (know + have)", "Card + PIN (have + know)", "Fingerprint + token (are + have)"],
              "is_not_mfa": ["Two passwords (both 'know')", "Security questions + password (both 'know')"],
              "exam_importance": "HIGH - 'Two passwords is NOT MFA' is a classic exam question"
            }
          },
          {
            "concept": "Authorization: What Can You Do?",
            "definition": "Determining what authenticated users are permitted to access",
            "key_point": "Authorization happens AFTER authentication—must prove identity before getting permissions",
            "models": [
              {
                "model": "DAC (Discretionary Access Control)",
                "description": "Owner determines who can access",
                "example": "File owner sets permissions"
              },
              {
                "model": "MAC (Mandatory Access Control)",
                "description": "System-enforced based on security labels",
                "example": "Military classification levels"
              },
              {
                "model": "RBAC (Role-Based Access Control)",
                "description": "Permissions based on job function",
                "example": "HR role can access HR systems"
              },
              {
                "model": "ABAC (Attribute-Based Access Control)",
                "description": "Dynamic rules based on attributes",
                "example": "Department + time + location determines access"
              }
            ],
            "least_privilege": {
              "definition": "Users should have only minimum permissions necessary",
              "why_important": "Limits damage from compromised accounts or insider threats"
            }
          },
          {
            "concept": "Accounting: What Did You Do?",
            "definition": "Tracking and recording user activities for audit, billing, or security",
            "what_to_track": [
              "Session information (login/logout times)",
              "Resource usage (bandwidth, storage, compute)",
              "Actions performed (files accessed, commands executed)",
              "Changes made (configurations altered, data modified)"
            ],
            "uses": [
              "Forensic investigation after incidents",
              "Compliance audit evidence",
              "User behavior analytics",
              "Billing and chargeback"
            ]
          },
          {
            "concept": "AAA Protocols",
            "protocols": [
              {
                "protocol": "RADIUS",
                "full_name": "Remote Authentication Dial-In User Service",
                "characteristics": [
                  "Combines authentication and authorization in Access-Accept",
                  "UDP-based (ports 1812/1813)",
                  "Encrypts only the password, not entire session"
                ],
                "common_use": "Network access (VPN, WiFi)"
              },
              {
                "protocol": "TACACS+",
                "full_name": "Terminal Access Controller Access-Control System Plus",
                "characteristics": [
                  "Separates authentication, authorization, and accounting",
                  "TCP-based (port 49)",
                  "Encrypts entire packet"
                ],
                "common_use": "Device administration (routers, switches)"
              }
            ],
            "comparison": {
              "radius": "UDP, encrypts password only, combines auth/authz",
              "tacacs_plus": "TCP, encrypts entire packet, separates AAA functions"
            }
          }
        ]
      },

      "memory_hooks": {
        "mnemonic": "AAA order: Who are you? → What can you do? → What did you do?",
        "radius_vs_tacacs": {
          "radius": "RADIUS = Remote dial-in = UDP = Simple",
          "tacacs": "TACACS+ = Cisco-developed = TCP = Thorough encryption"
        }
      },

      "key_points": [
        "Authentication verifies identity (who you are)",
        "Authorization determines permissions (what you can do)",
        "Accounting tracks activities (what you did)",
        "MFA requires factors from DIFFERENT categories (two passwords is NOT MFA)",
        "RADIUS is UDP-based, encrypts password only; TACACS+ is TCP-based, encrypts entire packet"
      ],

      "must_remember_for_exam": [
        {
          "fact": "AAA order: Authentication → Authorization → Accounting",
          "why_tested": "Order questions are common"
        },
        {
          "fact": "Two passwords is NOT MFA—must be different factor categories",
          "why_tested": "Classic exam trap"
        },
        {
          "fact": "RADIUS = UDP, encrypts password; TACACS+ = TCP, encrypts all",
          "why_tested": "Protocol comparison questions"
        }
      ],

      "knowledge_check": {
        "question": "A user logs in with username/password, then scans their fingerprint. After authentication, the system checks group membership to determine network share access. Finally, file access is logged. Which sequence describes this?",
        "options": [
          "Accounting → Authentication → Authorization",
          "Authorization → Authentication → Accounting",
          "Authentication → Authorization → Accounting",
          "Authentication → Accounting → Authorization"
        ],
        "correct": 2,
        "explanation": "AAA sequence: Authentication (verify identity with password + fingerprint), then Authorization (determine permissions from group membership), then Accounting (log file access). You must know WHO before determining WHAT they can do, and track WHAT THEY DID for audit.",
        "wrong_answer_analysis": [
          {
            "option": 0,
            "why_tempting": "Might confuse order",
            "why_wrong": "Can't track what someone did before knowing who they are"
          },
          {
            "option": 1,
            "why_tempting": "Authorization sounds first",
            "why_wrong": "Must authenticate before authorizing—how do you give permissions without knowing identity?"
          },
          {
            "option": 3,
            "why_tempting": "Logging might happen throughout",
            "why_wrong": "While logging can happen throughout, authorization must precede accounting of authorized actions"
          }
        ]
      }
    }
  ],

  "hands_on_labs": {
    "browser_labs": [
      {
        "lab_id": "lab-cia-classification",
        "title": "CIA Impact Classification Challenge",
        "type": "scenario_classification",
        "difficulty": "beginner",
        "estimated_time": "15 minutes",
        "description": "Review 10 security incidents and classify each by primary CIA impact. Immediate feedback on your classification.",
        "scenarios": [
          {"scenario": "Attacker reads customer database", "answer": "Confidentiality", "rationale": "Unauthorized disclosure"},
          {"scenario": "Ransomware encrypts all servers", "answer": "Availability", "rationale": "Systems inaccessible"},
          {"scenario": "Attacker modifies financial records", "answer": "Integrity", "rationale": "Unauthorized modification"},
          {"scenario": "DDoS attack takes website offline", "answer": "Availability", "rationale": "Service unavailable"},
          {"scenario": "Employee emails customer list to competitor", "answer": "Confidentiality", "rationale": "Unauthorized disclosure"}
        ]
      },
      {
        "lab_id": "lab-hash-verification",
        "title": "File Integrity Verification Simulator",
        "type": "interactive_demo",
        "difficulty": "beginner",
        "estimated_time": "10 minutes",
        "description": "Upload or create files, generate hashes, modify files, and observe how hash changes. Demonstrates integrity verification in action.",
        "learning_objective": "Understand how hashing detects modifications"
      },
      {
        "lab_id": "lab-cia-fill-blank",
        "title": "CIA Terminology Challenge",
        "type": "fill_in_blank",
        "difficulty": "beginner",
        "estimated_time": "10 minutes",
        "questions": [
          {"sentence": "__________ ensures data hasn't been modified.", "answer": "Integrity"},
          {"sentence": "__________ protects confidentiality by making data unreadable.", "answer": "Encryption"},
          {"sentence": "__________ is maximum acceptable downtime.", "answer": "RTO"},
          {"sentence": "__________ is maximum acceptable data loss.", "answer": "RPO"},
          {"sentence": "Digital signatures provide integrity, authentication, and __________.", "answer": "non-repudiation"}
        ]
      }
    ],

    "external_labs": [
      {
        "resource": "CyberDefenders",
        "lab_name": "Hash Analysis Challenge",
        "url": "https://cyberdefenders.org/",
        "cost": "Free",
        "estimated_time": "1-2 hours",
        "description": "Practice using hash values to verify file integrity in forensic investigation scenarios.",
        "what_youll_learn": ["Hash verification", "Integrity checking in forensics", "Tool usage"],
        "role_relevance": ["incident_responder", "soc_analyst"]
      },
      {
        "resource": "TryHackMe",
        "lab_name": "Cryptography Basics",
        "url": "https://tryhackme.com/room/cryptographyintro",
        "cost": "Free",
        "estimated_time": "2 hours",
        "description": "Hands-on introduction to encryption and hashing concepts.",
        "what_youll_learn": ["Symmetric vs asymmetric encryption", "Hashing algorithms", "Digital signatures"],
        "role_relevance": ["security_engineer", "soc_analyst"]
      }
    ],

    "tools_introduction": [
      {
        "tool": "HashCalc / HashMyFiles",
        "category": "Integrity Verification",
        "purpose": "Calculate and verify file hashes",
        "platforms": ["Windows"],
        "role_relevance": ["incident_responder", "security_engineer"],
        "getting_started": {
          "steps": [
            "Download HashCalc (free) from slavasoft.com",
            "Open application and select file to hash",
            "Choose algorithm (recommend SHA-256)",
            "Compare output to known-good hash"
          ]
        }
      },
      {
        "tool": "sha256sum / md5sum",
        "category": "Integrity Verification",
        "purpose": "Command-line hash calculation",
        "platforms": ["Linux", "macOS", "Windows (WSL)"],
        "role_relevance": ["incident_responder", "security_engineer", "soc_analyst"],
        "getting_started": {
          "commands": [
            "sha256sum filename.txt - Generate hash",
            "sha256sum -c hashfile.txt - Verify against stored hash",
            "echo -n 'text' | sha256sum - Hash a string"
          ]
        }
      }
    ]
  },

  "summary": {
    "key_takeaways": [
      "CIA Triad (Confidentiality, Integrity, Availability) forms the foundation of all security decisions",
      "Confidentiality prevents unauthorized disclosure—encryption is the primary control",
      "Integrity ensures data hasn't been tampered with—hashing and digital signatures are key controls",
      "Availability ensures systems work when needed—redundancy, backups, and fault tolerance are critical",
      "Non-repudiation provides undeniable proof of actions—digital signatures enable this",
      "AAA (Authentication, Authorization, Accounting) controls and tracks access to resources"
    ],
    "exam_essentials": [
      "Encryption = Confidentiality; Hashing = Integrity (critical distinction!)",
      "RTO = maximum downtime; RPO = maximum data loss",
      "Digital signatures provide integrity + authentication + non-repudiation",
      "MFA requires factors from DIFFERENT categories (two passwords is NOT MFA)",
      "RADIUS = UDP, encrypts password only; TACACS+ = TCP, encrypts entire packet",
      "AAA sequence: Authentication THEN Authorization THEN Accounting"
    ],
    "career_connections": {
      "soc_analyst": "Every alert you triage is assessed by CIA impact. Master this lens.",
      "incident_responder": "Incident severity is determined by CIA impact. Recovery prioritizes availability.",
      "security_engineer": "Every control you design addresses CIA. Balance all three in architecture.",
      "grc_analyst": "Map controls to CIA objectives. Assess risks by potential CIA impact.",
      "penetration_tester": "Frame findings by CIA impact to communicate business risk."
    },
    "connection_to_next": "Now that you understand CIA Triad and AAA, the next lesson dives deeper into authentication methods—the critical first 'A' that determines who can access your protected resources. You'll learn about authentication factors, MFA implementations, and identity verification technologies."
  },

  "related_content": {
    "simulations": ["D1-SIM-002"],
    "remediation": ["D1-REM-001"],
    "next_lesson": "D1-LESSON-003",
    "previous_lesson": "D1-LESSON-001",
    "related_topics": [
      {"topic": "Authentication Methods", "lesson": "D1-LESSON-003", "relationship": "Deep dive into AAA authentication"},
      {"topic": "Cryptography", "lesson": "D1-LESSON-004", "relationship": "Technical implementation of confidentiality/integrity"},
      {"topic": "Data Protection", "lesson": "D3-LESSON-008", "relationship": "CIA applied to data lifecycle"},
      {"topic": "Incident Response", "lesson": "D4-LESSON-002", "relationship": "CIA impact assessment in IR"}
    ]
  }
}
