{
  "lab_id": "TOOL-LAB-012",
  "tool_name": "MISP",
  "tool_category": "Threat Intelligence",
  "version": "1.0",
  
  "metadata": {
    "difficulty": "advanced",
    "estimated_time": "3-4 hours",
    "last_updated": "2025-01-14",
    "author": "Security+ Training System"
  },
  
  "overview": {
    "tagline": "Open Source Threat Intelligence Platform",
    "description": "MISP (Malware Information Sharing Platform) is a threat intelligence platform for sharing, storing, and correlating IOCs. It enables organizations to share threat data with trusted partners and consume feeds from the community. Essential for mature security operations.",
    "official_site": "https://www.misp-project.org/",
    "download_url": "https://github.com/MISP/MISP",
    "license": "Open Source (AGPL)",
    "platforms": ["Linux", "Docker"],
    "why_learn": "Threat intelligence operationalizes IOC sharing. MISP is the standard platform used by ISACs, governments, and enterprises worldwide."
  },
  
  "security_plus_relevance": {
    "domains": [2, 4],
    "objectives": ["2.1", "2.4", "4.1", "4.4"],
    "exam_topics": [
      "Threat intelligence sources",
      "Indicator of compromise management",
      "Information sharing organizations",
      "Security operations"
    ]
  },
  
  "career_relevance": {
    "soc_analyst": {
      "relevance": "high",
      "percentage_of_job": "15-25%",
      "usage": "Consuming threat intel feeds, IOC enrichment"
    },
    "incident_responder": {
      "relevance": "high",
      "percentage_of_job": "20-25%",
      "usage": "Sharing IOCs from incidents, consuming community intel"
    },
    "security_engineer": {
      "relevance": "high",
      "percentage_of_job": "15-20%",
      "usage": "Integrating threat feeds into security tools"
    },
    "penetration_tester": {
      "relevance": "low",
      "percentage_of_job": "5%",
      "usage": "Understanding threat actor TTPs"
    },
    "grc_analyst": {
      "relevance": "medium",
      "percentage_of_job": "10-15%",
      "usage": "Threat landscape reporting, risk assessment"
    }
  },
  
  "prerequisites": {
    "knowledge": [
      "Understanding of IOCs (IPs, domains, hashes)",
      "Basic threat intelligence concepts",
      "REST API familiarity helpful"
    ],
    "tools_needed": [
      "Docker (recommended) or Linux VM",
      "Web browser",
      "Network access"
    ],
    "estimated_setup_time": "45-60 minutes"
  },
  
  "quick_start": {
    "installation_steps": [
      {
        "step": 1,
        "title": "Deploy with Docker",
        "instructions": "git clone https://github.com/MISP/misp-docker\ncd misp-docker\ndocker-compose up -d",
        "verification": "Containers running"
      },
      {
        "step": 2,
        "title": "Access Web Interface",
        "instructions": "Browse to https://localhost\nDefault: admin@admin.test / admin",
        "verification": "Login screen appears"
      },
      {
        "step": 3,
        "title": "Change Default Password",
        "instructions": "First login forces password change.\nSet a strong password.",
        "verification": "Dashboard accessible"
      }
    ],
    "first_run": "Create event → Add attributes → Publish → Share",
    "verification": "Event visible in events list"
  },
  
  "core_concepts": [
    {
      "concept_id": "events",
      "title": "Events",
      "explanation": "Events are containers for related threat data - an incident, campaign, or threat actor. Contains attributes (IOCs), objects, and context.",
      "why_it_matters": "Events organize threat intel for sharing and correlation.",
      "exam_tip": "Threat intelligence platforms organize IOCs into events/incidents"
    },
    {
      "concept_id": "attributes",
      "title": "Attributes",
      "explanation": "Individual IOCs: IP addresses, domains, hashes, URLs, etc. Each has type, value, category, and sharing settings.",
      "why_it_matters": "Attributes are the actionable IOCs for detection.",
      "exam_tip": "IOCs include IPs, domains, URLs, file hashes, email addresses"
    },
    {
      "concept_id": "taxonomies",
      "title": "Taxonomies & Tags",
      "explanation": "Standardized classification systems for categorizing threat data. TLP, admiralty code, threat type.",
      "why_it_matters": "Consistent tagging enables filtering and analysis.",
      "exam_tip": "TLP (Traffic Light Protocol) controls sharing scope"
    },
    {
      "concept_id": "feeds",
      "title": "Feeds & Sync",
      "explanation": "MISP can pull threat data from external feeds and sync with other MISP instances for community sharing.",
      "why_it_matters": "Feeds provide continuous threat intelligence updates.",
      "exam_tip": "Threat feeds provide automated IOC updates"
    }
  ],
  
  "mini_projects": [
    {
      "project_id": "project-1",
      "title": "Setting Up Your Threat Intel Platform",
      "difficulty": "beginner",
      "estimated_time": "60-90 minutes",
      "description": "Deploy MISP, configure basic settings, and create your first threat event.",
      "learning_objectives": [
        "Deploy MISP platform",
        "Configure organizations and users",
        "Create threat events",
        "Add IOC attributes"
      ],
      "scenario": "Your SOC needs a threat intelligence platform. Set up MISP for the team.",
      
      "setup": {
        "files_needed": [],
        "environment": "Docker installed"
      },
      
      "tasks": [
        {
          "task_id": "task-1",
          "title": "Deploy MISP",
          "instructions": "Using Docker:\n\ngit clone https://github.com/MISP/misp-docker\ncd misp-docker\ndocker-compose up -d\n\nWait 5-10 minutes for initialization",
          "hints": ["Check logs: docker-compose logs -f", "Database takes time to initialize"],
          "expected_result": "MISP accessible at https://localhost",
          "common_mistakes": ["Not waiting for full startup"]
        },
        {
          "task_id": "task-2",
          "title": "Configure Organization",
          "instructions": "1. Login as admin\n2. Administration → Organizations\n3. Edit your organization name\n4. Add organization description\n5. Set sector and nationality",
          "hints": ["Organization defines your sharing identity", "Partners see this info"],
          "expected_result": "Organization configured",
          "common_mistakes": ["Generic organization name"]
        },
        {
          "task_id": "task-3",
          "title": "Create Your First Event",
          "instructions": "1. Click 'Add Event'\n2. Info: 'Phishing Campaign - Finance Theme'\n3. Set threat level and analysis status\n4. Add distribution (your org only)\n5. Save",
          "hints": ["Events group related IOCs", "Set TLP appropriately"],
          "expected_result": "Event created",
          "common_mistakes": ["Wrong distribution setting"]
        },
        {
          "task_id": "task-4",
          "title": "Add Attributes (IOCs)",
          "instructions": "In your event:\n1. Add Attribute\n2. Type: ip-dst, Value: 192.168.1.100\n3. Type: domain, Value: evil-phish.com\n4. Type: md5, Value: [hash]\n5. Save each",
          "hints": ["Select correct attribute type", "Add context in comments"],
          "expected_result": "Multiple IOCs added",
          "common_mistakes": ["Wrong attribute type"]
        },
        {
          "task_id": "task-5",
          "title": "Tag and Publish",
          "instructions": "1. Add taxonomy tags (TLP:AMBER)\n2. Add threat type tags\n3. Change analysis to 'Completed'\n4. Publish event",
          "hints": ["Tags enable filtering", "Published events can be shared"],
          "expected_result": "Tagged, published event",
          "common_mistakes": ["Publishing before complete"]
        }
      ],
      
      "challenge_questions": [
        {
          "question": "What does TLP:AMBER mean for sharing?",
          "answer": "Share with members of your organization and partners",
          "explanation": "TLP controls who can receive the information"
        }
      ],
      
      "takeaways": [
        "MISP organizes threat intelligence into events",
        "Attributes are individual IOCs",
        "Tags enable classification and filtering",
        "Distribution controls sharing scope"
      ]
    },
    {
      "project_id": "project-2",
      "title": "Consuming Threat Feeds",
      "difficulty": "intermediate",
      "estimated_time": "60-90 minutes",
      "description": "Configure external threat feeds to automatically import IOCs into your MISP instance.",
      "learning_objectives": [
        "Configure external feeds",
        "Enable and fetch feeds",
        "Filter and search IOCs",
        "Export IOCs for tools"
      ],
      "scenario": "Enhance your threat intel with community feeds and automate IOC updates.",
      
      "setup": {
        "files_needed": [],
        "environment": "MISP running with admin access"
      },
      
      "tasks": [
        {
          "task_id": "task-1",
          "title": "Enable Default Feeds",
          "instructions": "1. Sync Actions → Feeds\n2. Find 'CIRCL OSINT Feed'\n3. Enable the feed\n4. Save configuration",
          "hints": ["Start with one feed", "Some feeds require API keys"],
          "expected_result": "Feed enabled",
          "common_mistakes": ["Enabling too many feeds"]
        },
        {
          "task_id": "task-2",
          "title": "Fetch Feed Data",
          "instructions": "1. Select enabled feed\n2. Click 'Fetch and store all feed data'\n3. Wait for completion\n4. Check event count",
          "hints": ["First fetch takes time", "Large feeds = many events"],
          "expected_result": "Feed data imported",
          "common_mistakes": ["Canceling mid-fetch"]
        },
        {
          "task_id": "task-3",
          "title": "Search and Filter",
          "instructions": "1. Go to Events list\n2. Use filters: org, tags, attribute value\n3. Search for specific IP or domain\n4. Export matching results",
          "hints": ["Filters combine with AND", "Advanced search for complex queries"],
          "expected_result": "Filtered view of relevant IOCs",
          "common_mistakes": ["Not using filters effectively"]
        },
        {
          "task_id": "task-4",
          "title": "Export for Detection",
          "instructions": "Export IOCs for your SIEM:\n1. Select events/attributes\n2. Export as CSV or STIX\n3. Or use REST API for automation",
          "hints": ["Different formats for different tools", "API enables automation"],
          "expected_result": "IOC export file",
          "common_mistakes": ["Wrong export format"]
        },
        {
          "task_id": "task-5",
          "title": "Schedule Automatic Fetch",
          "instructions": "1. Administration → Scheduled Tasks\n2. Enable feed fetch schedule\n3. Set frequency (daily recommended)\n4. Test scheduled task",
          "hints": ["Automation keeps feeds current", "Monitor for errors"],
          "expected_result": "Automated feed updates",
          "common_mistakes": ["Too frequent updates"]
        }
      ],
      
      "challenge_questions": [
        {
          "question": "Why use multiple threat feeds?",
          "answer": "Different feeds cover different threat actors and regions",
          "explanation": "Feed diversity improves coverage"
        }
      ],
      
      "takeaways": [
        "Feeds automate threat intelligence collection",
        "Quality over quantity for feeds",
        "Export formats match target tools",
        "Automation keeps intel current"
      ]
    },
    {
      "project_id": "project-3",
      "title": "Threat Intelligence Operations",
      "difficulty": "advanced",
      "estimated_time": "90-120 minutes",
      "description": "Integrate MISP with security tools, correlate events, and build threat intel workflows.",
      "learning_objectives": [
        "Integrate MISP with SIEM",
        "Correlate events across sources",
        "Build automated workflows",
        "Create threat reports"
      ],
      "scenario": "Operationalize your threat intel program with tool integration and automation.",
      
      "setup": {
        "files_needed": [],
        "environment": "MISP with populated data"
      },
      
      "tasks": [
        {
          "task_id": "task-1",
          "title": "API Integration Setup",
          "instructions": "1. Get API key from profile\n2. Test API: curl -H 'Authorization: [key]' https://localhost/events\n3. Create automation user (optional)\n4. Document API endpoints needed",
          "hints": ["API key = sensitive", "Different keys for different integrations"],
          "expected_result": "Working API access",
          "common_mistakes": ["Exposing API key"]
        },
        {
          "task_id": "task-2",
          "title": "SIEM Integration",
          "instructions": "Configure SIEM to pull from MISP:\n1. Create threat intel feed in SIEM\n2. Configure MISP API endpoint\n3. Map MISP attributes to SIEM fields\n4. Test correlation",
          "hints": ["Most SIEMs have MISP integration", "Test with known IOC"],
          "expected_result": "MISP IOCs in SIEM",
          "common_mistakes": ["Field mapping errors"]
        },
        {
          "task_id": "task-3",
          "title": "Event Correlation",
          "instructions": "Use MISP correlation:\n1. Enable correlation in settings\n2. Check related events\n3. View correlation graph\n4. Identify campaign connections",
          "hints": ["Correlation finds related events", "Graph shows relationships"],
          "expected_result": "Correlated event clusters",
          "common_mistakes": ["Ignoring correlations"]
        },
        {
          "task_id": "task-4",
          "title": "Automated Alerting",
          "instructions": "Set up alerts:\n1. Create saved search\n2. Configure email alerts\n3. Set up webhook for Slack/Teams\n4. Test alert delivery",
          "hints": ["Alert on high-value IOCs", "Don't alert on everything"],
          "expected_result": "Working alert notifications",
          "common_mistakes": ["Alert fatigue"]
        },
        {
          "task_id": "task-5",
          "title": "Create Threat Report",
          "instructions": "Build threat landscape report:\n1. Export events for time period\n2. Summarize by threat type\n3. Include key IOCs\n4. Add trend analysis",
          "hints": ["Monthly reports show trends", "Focus on actionable intel"],
          "expected_result": "Professional threat report",
          "common_mistakes": ["Too much detail"]
        }
      ],
      
      "challenge_questions": [
        {
          "question": "How does correlation help threat analysis?",
          "answer": "Links related events revealing campaigns and actor patterns",
          "explanation": "Correlation connects dots across separate incidents"
        }
      ],
      
      "takeaways": [
        "API integration enables automation",
        "SIEM integration operationalizes IOCs",
        "Correlation reveals hidden connections",
        "Reports communicate risk to leadership"
      ]
    }
  ],
  
  "external_resources": [
    {
      "platform": "MISP Project",
      "name": "Official Documentation",
      "url": "https://www.misp-project.org/documentation/",
      "cost": "Free",
      "difficulty": "all",
      "estimated_time": "Reference",
      "description": "Complete MISP documentation"
    },
    {
      "platform": "CIRCL",
      "name": "MISP Training",
      "url": "https://www.circl.lu/services/misp-training-materials/",
      "cost": "Free",
      "difficulty": "all",
      "estimated_time": "Varies",
      "description": "Official MISP training materials"
    }
  ],
  
  "cheat_sheet": {
    "sections": [
      {
        "title": "TLP Classifications",
        "commands": [
          { "command": "TLP:RED", "description": "Not for disclosure - restricted to participants" },
          { "command": "TLP:AMBER", "description": "Limited disclosure - org and clients" },
          { "command": "TLP:GREEN", "description": "Community - share with peers" },
          { "command": "TLP:WHITE/CLEAR", "description": "Unlimited - public disclosure OK" }
        ]
      },
      {
        "title": "Common Attribute Types",
        "commands": [
          { "command": "ip-dst", "description": "Destination IP address" },
          { "command": "ip-src", "description": "Source IP address" },
          { "command": "domain", "description": "Domain name" },
          { "command": "url", "description": "Full URL" },
          { "command": "md5/sha1/sha256", "description": "File hashes" },
          { "command": "email-src", "description": "Sender email address" },
          { "command": "filename", "description": "Malicious filename" }
        ]
      },
      {
        "title": "API Endpoints",
        "commands": [
          { "command": "GET /events", "description": "List events" },
          { "command": "GET /events/view/[id]", "description": "Get event details" },
          { "command": "POST /events/add", "description": "Create event" },
          { "command": "GET /attributes/restSearch", "description": "Search attributes" }
        ]
      }
    ]
  },
  
  "knowledge_check": [
    {
      "question": "What is the purpose of a threat intelligence platform like MISP?",
      "options": [
        "Replace antivirus software",
        "Share and manage IOCs with the security community",
        "Block malware automatically",
        "Monitor network traffic"
      ],
      "correct": 1,
      "explanation": "TIPs like MISP enable sharing, storing, and correlating threat indicators"
    },
    {
      "question": "What does TLP:AMBER indicate?",
      "options": [
        "Public information",
        "Share with organization and partners only",
        "Top secret classification",
        "Do not share with anyone"
      ],
      "correct": 1,
      "explanation": "TLP:AMBER allows sharing with your organization and trusted partners"
    },
    {
      "question": "What is an 'event' in MISP?",
      "options": [
        "A log entry",
        "A container grouping related IOCs and context",
        "A network connection",
        "A user login"
      ],
      "correct": 1,
      "explanation": "Events group related threat data (attributes) with context about an incident or campaign"
    }
  ],
  
  "next_steps": {
    "related_labs": ["TOOL-LAB-009", "TOOL-LAB-003"],
    "related_lessons": ["D2-LESSON-001", "D4-LESSON-001"],
    "certifications": [
      "GIAC Cyber Threat Intelligence (GCTI)",
      "CompTIA CySA+"
    ],
    "advanced_topics": [
      "MISP modules and enrichment",
      "STIX/TAXII integration",
      "Threat actor tracking",
      "ISAC participation"
    ]
  }
}
