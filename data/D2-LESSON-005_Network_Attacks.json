{
  "lesson_id": "D2-LESSON-005",
  "domain": 2,
  "title": "Network-Based Attacks",
  "subtitle": "Network Exploitation: From Sniffing to DDoS",
  "version": "2.0-enhanced",
  "objectives_covered": ["2.4"],
  "estimated_duration": "90-120 minutes",
  "difficulty": "intermediate",
  "prerequisites": ["D2-LESSON-002"],

  "skill_tree": {
    "position": {"domain": 2, "sequence": 5, "tier": "intermediate"},
    "prerequisites": [{"lesson_id": "D2-LESSON-002", "title": "Threat Vectors", "why_needed": "Network is a key attack vector"}],
    "unlocks": [{"lesson_id": "D3-LESSON-003", "title": "Network Security", "connection": "Defenses against network attacks"}],
    "cascade_learning": {
      "this_lesson_establishes": ["Network attack types", "Protocol vulnerabilities", "DoS/DDoS mechanisms", "MITM techniques"],
      "concepts_used_later": {"D3-LESSON-003": "Network security controls", "D4-LESSON-001": "Network-based detection"}
    }
  },

  "role_relevance": {
    "soc_analyst": {"relevance": "critical", "percentage_of_job": "45-55%", "daily_tasks": ["Monitor network alerts", "Identify attack patterns", "Analyze network anomalies"]},
    "incident_responder": {"relevance": "high", "percentage_of_job": "35-45%", "daily_tasks": ["Trace network attacks", "Contain compromised systems", "Analyze packet captures"]},
    "security_engineer": {"relevance": "critical", "percentage_of_job": "50-60%", "daily_tasks": ["Configure network defenses", "Implement segmentation", "Deploy IDS/IPS"]},
    "grc_analyst": {"relevance": "medium", "percentage_of_job": "15-25%", "daily_tasks": ["Assess network security controls", "Document network risks"]},
    "penetration_tester": {"relevance": "critical", "percentage_of_job": "55-65%", "daily_tasks": ["Conduct network attacks", "Test network defenses", "Identify network vulnerabilities"]}
  },

  "introduction": {
    "hook": "In 2016, the Mirai botnet launched a DDoS attack that took down major websites including Twitter, Netflix, and Reddit. The attack generated traffic from millions of compromised IoT devicesâ€”cameras, routers, DVRs. Network attacks can paralyze organizations and even impact internet infrastructure.",
    "exam_weight": {"estimated_questions": "6-8", "high_yield_topics": ["DoS vs DDoS", "ARP poisoning", "DNS attacks", "On-path/MITM attacks"]}
  },

  "sections": [
    {
      "section_id": "D2-L005-S01",
      "title": "Denial of Service Attacks",
      "estimated_time": "15 minutes",
      "content": {
        "overview": "DoS attacks overwhelm systems to deny legitimate access. DDoS uses multiple sources for greater impact.",
        "core_concepts": [
          {
            "concept": "DoS vs DDoS",
            "dos": {"sources": "Single source", "mitigation": "Block source IP"},
            "ddos": {"sources": "Multiple distributed sources (botnet)", "mitigation": "Much harderâ€”many IPs"},
            "key_distinction": "DDoS = Distributed, uses many compromised systems"
          },
          {
            "concept": "Attack Categories",
            "categories": [
              {"category": "Volumetric", "method": "Flood bandwidth", "examples": "UDP flood, ICMP flood, Amplification"},
              {"category": "Protocol", "method": "Exploit protocol weaknesses", "examples": "SYN flood, Ping of Death"},
              {"category": "Application", "method": "Target application layer", "examples": "HTTP flood, Slowloris"}
            ]
          },
          {
            "concept": "Amplification Attacks",
            "mechanism": "Small request â†’ Large response; Spoof source IP",
            "amplifiers": [
              {"protocol": "DNS", "amplification": "Up to 70x"},
              {"protocol": "NTP", "amplification": "Up to 556x"},
              {"protocol": "Memcached", "amplification": "Up to 51,000x"}
            ],
            "key": "Response sent to spoofed victim IP"
          },
          {
            "concept": "SYN Flood",
            "mechanism": "Send SYN packets, never complete handshake",
            "impact": "Exhausts server connection resources",
            "defense": "SYN cookies, rate limiting"
          }
        ]
      },
      "memory_hooks": {
        "mnemonic": "VPA = Volumetric, Protocol, Application (DoS types)",
        "analogy": "DoS is like one person blocking a door. DDoS is like a flash mob blocking all entrances."
      },
      "must_remember_for_exam": [
        {"fact": "DoS = single source; DDoS = distributed (multiple sources)", "why_tested": "Key distinction"},
        {"fact": "Amplification uses spoofed IPs and protocols that give large responses", "why_tested": "Attack mechanism"},
        {"fact": "SYN flood exhausts connection resources", "why_tested": "Common attack"},
        {"fact": "Three categories: Volumetric, Protocol, Application", "why_tested": "Classification"}
      ],
      "key_points": ["DoS = single source; DDoS = distributed botnet", "Amplification: small request â†’ large response to spoofed victim", "SYN flood exhausts connection table", "Three types: volumetric, protocol, application"],
      "knowledge_check": {
        "question": "Attackers send small DNS queries to open resolvers with the victim's spoofed IP. The resolvers send large responses to the victim. This is:",
        "options": ["SYN flood", "DNS amplification attack", "ARP poisoning", "DNS hijacking"],
        "correct": 1,
        "explanation": "DNS amplification uses open resolvers to multiply traffic. Small query generates large response sent to spoofed victim IP.",
        "wrong_answer_analysis": [
          {"option": 0, "why_wrong": "SYN flood uses TCP handshake, not DNS"},
          {"option": 2, "why_wrong": "ARP poisoning is for MITM, not DoS"},
          {"option": 3, "why_wrong": "DNS hijacking redirects queries, not amplifies"}
        ]
      }
    },
    {
      "section_id": "D2-L005-S02",
      "title": "Man-in-the-Middle (On-Path) Attacks",
      "estimated_time": "15 minutes",
      "content": {
        "overview": "Attacker positions between two parties to intercept or modify communications.",
        "core_concepts": [
          {
            "concept": "On-Path Attack (MITM)",
            "definition": "Attacker intercepts communications between two parties",
            "capabilities": ["Eavesdrop on traffic", "Modify data in transit", "Inject malicious content", "Steal credentials"],
            "note": "CompTIA now prefers 'on-path attack' over 'man-in-the-middle'"
          },
          {
            "concept": "ARP Poisoning/Spoofing",
            "mechanism": "Send fake ARP responses to associate attacker's MAC with gateway IP",
            "result": "Traffic intended for gateway goes through attacker",
            "detection": "Static ARP entries, ARP inspection"
          },
          {
            "concept": "DNS Attacks",
            "attacks": [
              {"attack": "DNS Poisoning", "mechanism": "Insert false records in DNS cache", "result": "Users redirected to malicious sites"},
              {"attack": "DNS Hijacking", "mechanism": "Compromise DNS server or settings", "result": "Control over name resolution"}
            ]
          },
          {
            "concept": "SSL/TLS Attacks",
            "attacks": [
              {"attack": "SSL Stripping", "mechanism": "Downgrade HTTPS to HTTP", "defense": "HSTS"},
              {"attack": "Certificate Spoofing", "mechanism": "Present fake certificate", "defense": "Certificate pinning, CA verification"}
            ]
          }
        ]
      },
      "must_remember_for_exam": [
        {"fact": "On-path attack = MITM (attacker between two parties)", "why_tested": "Terminology"},
        {"fact": "ARP poisoning associates attacker's MAC with gateway IP", "why_tested": "Attack mechanism"},
        {"fact": "DNS poisoning inserts false records in cache", "why_tested": "Attack mechanism"},
        {"fact": "SSL stripping downgrades HTTPS to HTTP", "why_tested": "Attack technique"}
      ],
      "key_points": ["On-path (MITM) intercepts communications between parties", "ARP poisoning redirects traffic through attacker", "DNS poisoning inserts false records", "SSL stripping downgrades encryption"],
      "knowledge_check": {
        "question": "An attacker sends false ARP responses, making systems believe the attacker's MAC is the default gateway. This is:",
        "options": ["DNS poisoning", "ARP spoofing", "MAC flooding", "VLAN hopping"],
        "correct": 1,
        "explanation": "ARP spoofing/poisoning sends fake ARP responses to redirect traffic through attacker.",
        "wrong_answer_analysis": [
          {"option": 0, "why_wrong": "DNS poisoning affects name resolution, not ARP"},
          {"option": 2, "why_wrong": "MAC flooding overwhelms switch tables"},
          {"option": 3, "why_wrong": "VLAN hopping crosses VLAN boundaries"}
        ]
      }
    },
    {
      "section_id": "D2-L005-S03",
      "title": "Network Reconnaissance and Sniffing",
      "estimated_time": "10 minutes",
      "content": {
        "overview": "Attackers gather network information and capture traffic for analysis.",
        "core_concepts": [
          {
            "concept": "Network Scanning",
            "techniques": [
              {"technique": "Port Scanning", "purpose": "Identify open ports/services", "tools": "Nmap"},
              {"technique": "Service Enumeration", "purpose": "Identify service versions", "risk": "Reveals vulnerabilities"},
              {"technique": "OS Fingerprinting", "purpose": "Identify operating systems", "risk": "Target-specific attacks"}
            ]
          },
          {
            "concept": "Packet Sniffing",
            "definition": "Capture and analyze network traffic",
            "requirements": ["Promiscuous mode (capture all traffic)", "Network position (hub, span port, ARP poisoning)"],
            "tools": "Wireshark, tcpdump"
          },
          {
            "concept": "Passive vs Active Reconnaissance",
            "passive": "Observe without interaction (harder to detect)",
            "active": "Interact with target systems (more detectable)"
          }
        ]
      },
      "must_remember_for_exam": [
        {"fact": "Port scanning identifies open ports/services", "why_tested": "Reconnaissance technique"},
        {"fact": "Promiscuous mode captures all network traffic", "why_tested": "Sniffing requirement"},
        {"fact": "Passive recon = observe without interaction", "why_tested": "Recon distinction"}
      ],
      "key_points": ["Port scanning finds open services", "Packet sniffing requires promiscuous mode or network position", "Passive recon is harder to detect than active"]
    },
    {
      "section_id": "D2-L005-S04",
      "title": "Other Network Attacks",
      "estimated_time": "10 minutes",
      "content": {
        "overview": "Additional network-layer attacks targeting various protocols and services.",
        "core_concepts": [
          {
            "concept": "Replay Attack",
            "mechanism": "Capture and retransmit valid data",
            "example": "Retransmit captured authentication token",
            "defense": "Timestamps, nonces, session tokens"
          },
          {
            "concept": "MAC Attacks",
            "attacks": [
              {"attack": "MAC Flooding", "mechanism": "Overwhelm switch CAM table", "result": "Switch acts like hub (broadcasts all)"},
              {"attack": "MAC Spoofing", "mechanism": "Change MAC address", "purpose": "Bypass MAC filtering, impersonation"}
            ]
          },
          {
            "concept": "VLAN Hopping",
            "mechanism": "Access traffic on other VLANs",
            "techniques": ["Switch spoofing (fake trunk)", "Double tagging"],
            "defense": "Disable auto-trunking, native VLAN not used"
          }
        ]
      },
      "must_remember_for_exam": [
        {"fact": "Replay attack = capture and retransmit valid data", "why_tested": "Attack type"},
        {"fact": "MAC flooding makes switch broadcast all traffic", "why_tested": "Attack result"},
        {"fact": "VLAN hopping accesses other VLAN traffic", "why_tested": "Attack technique"}
      ],
      "key_points": ["Replay attacks retransmit captured valid data", "MAC flooding overwhelms switch, causes broadcast", "VLAN hopping crosses VLAN boundaries"]
    }
  ],

  "summary": {
    "key_takeaways": [
      "DoS = single source; DDoS = distributed (botnet)",
      "Amplification: small request â†’ large response to spoofed victim",
      "On-path (MITM) intercepts communications between two parties",
      "ARP poisoning associates attacker MAC with gateway IP",
      "DNS poisoning inserts false records in cache"
    ],
    "exam_essentials": [
      "DoS = single source; DDoS = distributed",
      "Amplification attacks use DNS, NTP, Memcached",
      "ARP spoofing = redirect traffic through attacker",
      "DNS poisoning = false cache entries",
      "Replay attack = retransmit captured data"
    ]
  },

  "related_content": {
    "simulations": ["D2-SIM-002"],
    "next_lesson": "D2-LESSON-006",
    "previous_lesson": "D2-LESSON-004"
  }
}
