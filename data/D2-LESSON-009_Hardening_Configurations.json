{
  "lesson_id": "D2-LESSON-009",
  "domain": 2,
  "title": "Hardening and Secure Configurations",
  "subtitle": "Reducing Attack Surface Through Secure Configuration",
  "version": "2.0-enhanced",
  "objectives_covered": ["2.5"],
  "estimated_duration": "75-90 minutes",
  "difficulty": "intermediate",
  "prerequisites": ["D2-LESSON-002"],

  "skill_tree": {
    "position": {"domain": 2, "sequence": 9, "tier": "intermediate"},
    "prerequisites": [{"lesson_id": "D2-LESSON-002", "title": "Threat Vectors", "why_needed": "Hardening reduces attack vectors"}],
    "unlocks": [{"lesson_id": "D3-LESSON-002", "title": "Infrastructure Security", "connection": "Hardening applied to infrastructure"}]
  },

  "role_relevance": {
    "soc_analyst": {"relevance": "medium", "percentage_of_job": "15-25%", "daily_tasks": ["Verify hardening compliance", "Identify misconfigurations"]},
    "security_engineer": {"relevance": "critical", "percentage_of_job": "50-60%", "daily_tasks": ["Implement hardening standards", "Configure secure baselines", "Automate configurations"]},
    "grc_analyst": {"relevance": "high", "percentage_of_job": "35-45%", "daily_tasks": ["Audit against benchmarks", "Report compliance status"]},
    "penetration_tester": {"relevance": "high", "percentage_of_job": "35-45%", "daily_tasks": ["Identify misconfigurations", "Test hardening effectiveness"]}
  },

  "introduction": {
    "hook": "Default configurations are designed for ease of use, not security. That default admin password, those unnecessary services, that overly permissive firewall rule—they're all attack vectors waiting to be exploited.",
    "exam_weight": {"estimated_questions": "4-6", "high_yield_topics": ["CIS benchmarks", "Secure baseline", "Least functionality", "Default credential risks"]}
  },

  "sections": [
    {
      "section_id": "D2-L009-S01",
      "title": "Hardening Fundamentals",
      "estimated_time": "12 minutes",
      "content": {
        "core_concepts": [
          {
            "concept": "Hardening Definition",
            "definition": "Process of securing systems by reducing attack surface and eliminating unnecessary functionality",
            "principle": "Least functionality—only enable what's needed"
          },
          {
            "concept": "Secure Baseline",
            "definition": "Documented, approved security configuration for a system type",
            "components": ["OS settings", "Services enabled/disabled", "User accounts", "Network configuration"],
            "benefit": "Consistent, repeatable security across all systems"
          },
          {
            "concept": "Configuration Standards",
            "standards": [
              {"standard": "CIS Benchmarks", "source": "Center for Internet Security", "type": "Comprehensive configuration guides"},
              {"standard": "DISA STIGs", "source": "Defense Information Systems Agency", "type": "US government security technical implementation guides"},
              {"standard": "Vendor Guides", "source": "Microsoft, Cisco, etc.", "type": "Platform-specific hardening"}
            ]
          }
        ]
      },
      "must_remember_for_exam": [
        {"fact": "Hardening = reducing attack surface, least functionality", "why_tested": "Definition"},
        {"fact": "Secure baseline = documented approved configuration", "why_tested": "Concept"},
        {"fact": "CIS Benchmarks = industry-standard hardening guides", "why_tested": "Standard"},
        {"fact": "DISA STIGs = US government security guides", "why_tested": "Standard"}
      ],
      "key_points": ["Hardening removes unnecessary functionality", "Secure baseline provides consistent configuration", "CIS Benchmarks and DISA STIGs are standard references"]
    },
    {
      "section_id": "D2-L009-S02",
      "title": "Common Hardening Actions",
      "estimated_time": "12 minutes",
      "content": {
        "core_concepts": [
          {
            "concept": "Hardening Checklist",
            "actions": [
              {"action": "Change default credentials", "why": "Known passwords are first attack attempt"},
              {"action": "Disable unnecessary services", "why": "Each service is potential attack vector"},
              {"action": "Remove unnecessary software", "why": "Less software = fewer vulnerabilities"},
              {"action": "Enable host firewall", "why": "Restrict network access to services"},
              {"action": "Apply latest patches", "why": "Fix known vulnerabilities"},
              {"action": "Configure logging", "why": "Enable detection and forensics"},
              {"action": "Restrict administrative access", "why": "Limit privileged accounts"},
              {"action": "Disable USB/removable media", "why": "Prevent physical attack vector"}
            ]
          },
          {
            "concept": "Application Hardening",
            "actions": [
              "Disable debug features in production",
              "Remove sample/default content",
              "Configure strong authentication",
              "Implement input validation",
              "Use secure communication (TLS)"
            ]
          }
        ]
      },
      "must_remember_for_exam": [
        {"fact": "Change default credentials - first step", "why_tested": "Critical action"},
        {"fact": "Disable unnecessary services - reduce attack surface", "why_tested": "Core principle"},
        {"fact": "Least functionality principle", "why_tested": "Key concept"}
      ],
      "key_points": ["Change defaults, disable unnecessary services", "Apply patches, configure logging", "Least functionality principle"]
    }
  ],

  "summary": {
    "exam_essentials": [
      "Hardening = reduce attack surface, least functionality",
      "Secure baseline = documented approved configuration",
      "CIS Benchmarks = industry hardening standards",
      "Change default credentials immediately",
      "Disable unnecessary services and software"
    ]
  },

  "related_content": {
    "next_lesson": "D2-LESSON-010",
    "previous_lesson": "D2-LESSON-008"
  }
}
