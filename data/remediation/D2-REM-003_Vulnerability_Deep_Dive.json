{
  "simulation_id": "D2-REM-003",
  "title": "Vulnerability Deep Dive",
  "domain": 2,
  "category": "remediation",
  "difficulty": "foundational",
  "time_estimate": "30-40 minutes",
  "passing_score": 200,
  "max_score": 250,
  
  "remediation_target": {
    "weakness": "Vulnerability assessment, CVSS scoring, and prioritization",
    "triggered_by": ["D2-SIM-002", "D2-SIM-005"],
    "objectives_addressed": ["2.3", "2.5"]
  },
  
  "exam_objectives": [
    {
      "id": "2.3",
      "description": "Explain various types of vulnerabilities",
      "coverage": ["application vulnerabilities", "OS vulnerabilities", "web vulnerabilities", "hardware vulnerabilities", "misconfigurations", "zero-day", "CVSS scoring"]
    },
    {
      "id": "2.5",
      "description": "Explain the purpose of mitigation techniques used to secure the enterprise",
      "coverage": ["patching", "hardening", "compensating controls", "segmentation", "input validation"]
    }
  ],
  
  "scenario_context": {
    "organization": "SecureLearn Training Institute",
    "setting": "Vulnerability Management Training Lab",
    "your_role": "Security Analyst Trainee",
    "environment": {
      "training_type": "Vulnerability Assessment and Prioritization Workshop",
      "resources": ["Vulnerability scanner results", "CVSS calculator", "Asset inventory", "Threat intelligence feeds"],
      "instructor": "Principal Security Engineer Marcus Webb"
    },
    "opening_narrative": "Welcome to the Vulnerability Management fundamentals course. Marcus greets you at the training center. 'Understanding vulnerabilities - what they are, how to assess their severity, and how to prioritize remediation - is fundamental to protecting any organization. Today we'll examine different vulnerability types, learn CVSS scoring, and practice making tough prioritization decisions. By the end, you'll be able to look at scan results and know exactly what needs attention first.'"
  },
  
  "artifacts": [
    {
      "id": "artifact_1",
      "title": "Vulnerability Types Reference",
      "type": "reference",
      "unlocks_at": "start",
      "content": {
        "vulnerability_categories": {
          "application_vulnerabilities": {
            "description": "Flaws in software applications",
            "types": [
              {
                "name": "Buffer Overflow",
                "description": "Writing data beyond allocated memory bounds",
                "impact": "Code execution, crashes, privilege escalation",
                "example": "Stack-based overflow in legacy C application"
              },
              {
                "name": "Race Condition",
                "description": "Timing-dependent behavior that can be exploited",
                "impact": "Privilege escalation, authentication bypass",
                "example": "TOCTOU (Time-of-Check to Time-of-Use) flaws"
              },
              {
                "name": "Memory Leak",
                "description": "Failure to release allocated memory",
                "impact": "Denial of service via resource exhaustion",
                "example": "Long-running process consuming increasing memory"
              },
              {
                "name": "Integer Overflow",
                "description": "Arithmetic operation exceeds maximum value",
                "impact": "Unexpected behavior, security bypass",
                "example": "Size calculation wrapping to small value"
              }
            ]
          },
          "web_vulnerabilities": {
            "description": "Flaws specific to web applications",
            "types": [
              {
                "name": "SQL Injection (SQLi)",
                "description": "Inserting SQL code via user input",
                "impact": "Data theft, authentication bypass, data manipulation",
                "example": "' OR '1'='1 in login form"
              },
              {
                "name": "Cross-Site Scripting (XSS)",
                "description": "Injecting malicious scripts into web pages",
                "impact": "Session hijacking, defacement, credential theft",
                "variants": ["Stored XSS", "Reflected XSS", "DOM-based XSS"]
              },
              {
                "name": "Cross-Site Request Forgery (CSRF)",
                "description": "Forcing authenticated user to perform unwanted actions",
                "impact": "Unauthorized actions on behalf of victim",
                "example": "Hidden form auto-submitting money transfer"
              },
              {
                "name": "Insecure Direct Object Reference (IDOR)",
                "description": "Accessing objects by manipulating identifiers",
                "impact": "Unauthorized data access",
                "example": "Changing /user/123 to /user/124"
              },
              {
                "name": "Server-Side Request Forgery (SSRF)",
                "description": "Making server request attacker-specified resources",
                "impact": "Internal network access, cloud metadata theft",
                "example": "URL parameter fetching internal services"
              }
            ]
          },
          "os_vulnerabilities": {
            "description": "Flaws in operating systems",
            "types": [
              {
                "name": "Privilege Escalation",
                "description": "Gaining higher privileges than intended",
                "variants": ["Vertical (user to admin)", "Horizontal (user to different user)"],
                "example": "Kernel exploit gaining root access"
              },
              {
                "name": "Unpatched Services",
                "description": "Missing security updates for OS components",
                "impact": "Known vulnerabilities remain exploitable",
                "example": "EternalBlue (MS17-010) on unpatched Windows"
              },
              {
                "name": "Default Credentials",
                "description": "Factory-set passwords not changed",
                "impact": "Easy unauthorized access",
                "example": "admin/admin on management interfaces"
              }
            ]
          },
          "hardware_vulnerabilities": {
            "description": "Flaws in physical components or firmware",
            "types": [
              {
                "name": "Firmware Vulnerabilities",
                "description": "Flaws in low-level device software",
                "impact": "Persistent compromise, difficult remediation",
                "example": "UEFI/BIOS vulnerabilities"
              },
              {
                "name": "Side-Channel Attacks",
                "description": "Exploiting physical implementation characteristics",
                "impact": "Information disclosure",
                "examples": ["Spectre", "Meltdown", "timing attacks"]
              },
              {
                "name": "Hardware Supply Chain",
                "description": "Compromised components from manufacturing",
                "impact": "Built-in backdoors, persistent access",
                "example": "Malicious chips inserted during manufacturing"
              }
            ]
          },
          "configuration_vulnerabilities": {
            "description": "Security weaknesses from improper setup",
            "types": [
              {
                "name": "Misconfiguration",
                "description": "Incorrect security settings",
                "examples": ["Open S3 buckets", "Disabled authentication", "Overly permissive firewall rules"],
                "impact": "Varies - data exposure to full compromise"
              },
              {
                "name": "Weak Encryption",
                "description": "Using outdated or weak cryptographic algorithms",
                "examples": ["MD5 for passwords", "SSL 3.0", "1024-bit RSA"],
                "impact": "Data exposure, authentication bypass"
              },
              {
                "name": "Missing Security Controls",
                "description": "Security features not enabled",
                "examples": ["No MFA", "Disabled logging", "No input validation"],
                "impact": "Easier exploitation of other vulnerabilities"
              }
            ]
          },
          "special_categories": {
            "zero_day": {
              "definition": "Vulnerability unknown to vendor with no available patch",
              "characteristics": ["No signature detection", "No patch available", "High value to attackers"],
              "response": "Compensating controls, monitoring, isolation"
            },
            "supply_chain": {
              "definition": "Vulnerabilities introduced through third-party components",
              "examples": ["Compromised libraries", "Backdoored updates", "Vulnerable dependencies"],
              "challenges": ["Visibility", "Trust relationships", "Cascading impact"]
            }
          }
        }
      }
    },
    {
      "id": "artifact_2",
      "title": "CVSS Scoring Guide",
      "type": "reference",
      "unlocks_at": "decision_2",
      "content": {
        "cvss_overview": {
          "name": "Common Vulnerability Scoring System",
          "current_version": "CVSS v3.1 (v4.0 released 2023)",
          "purpose": "Standardized vulnerability severity assessment",
          "score_range": "0.0 to 10.0",
          "severity_ratings": {
            "none": "0.0",
            "low": "0.1 - 3.9",
            "medium": "4.0 - 6.9",
            "high": "7.0 - 8.9",
            "critical": "9.0 - 10.0"
          }
        },
        "metric_groups": {
          "base_score": {
            "description": "Intrinsic vulnerability characteristics (constant)",
            "exploitability_metrics": {
              "attack_vector": {
                "options": ["Network (N)", "Adjacent (A)", "Local (L)", "Physical (P)"],
                "description": "How the vulnerability is exploited",
                "scoring": "Network = highest score (remotely exploitable)"
              },
              "attack_complexity": {
                "options": ["Low (L)", "High (H)"],
                "description": "Conditions beyond attacker's control",
                "scoring": "Low = higher score (easy to exploit)"
              },
              "privileges_required": {
                "options": ["None (N)", "Low (L)", "High (H)"],
                "description": "Level of access needed before exploiting",
                "scoring": "None = highest score (no authentication needed)"
              },
              "user_interaction": {
                "options": ["None (N)", "Required (R)"],
                "description": "Whether victim must take action",
                "scoring": "None = higher score (no user action needed)"
              }
            },
            "impact_metrics": {
              "confidentiality": {
                "options": ["None (N)", "Low (L)", "High (H)"],
                "description": "Impact to data confidentiality"
              },
              "integrity": {
                "options": ["None (N)", "Low (L)", "High (H)"],
                "description": "Impact to data integrity"
              },
              "availability": {
                "options": ["None (N)", "Low (L)", "High (H)"],
                "description": "Impact to system availability"
              },
              "scope": {
                "options": ["Unchanged (U)", "Changed (C)"],
                "description": "Whether impact extends beyond vulnerable component",
                "scoring": "Changed = higher score (affects other systems)"
              }
            }
          },
          "temporal_score": {
            "description": "Characteristics that change over time",
            "metrics": {
              "exploit_code_maturity": "Is exploit code available?",
              "remediation_level": "Is a fix available?",
              "report_confidence": "How certain is the vulnerability report?"
            }
          },
          "environmental_score": {
            "description": "Organization-specific factors",
            "metrics": {
              "modified_base_metrics": "Adjust for your environment",
              "security_requirements": "CIA importance in your context"
            }
          }
        },
        "example_scores": {
          "critical_example": {
            "vulnerability": "Unauthenticated remote code execution",
            "vector_string": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H",
            "score": "10.0 (Critical)",
            "breakdown": "Network exploitable, no complexity, no privileges, no user interaction, scope change, full CIA impact"
          },
          "medium_example": {
            "vulnerability": "Authenticated information disclosure",
            "vector_string": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N",
            "score": "4.3 (Medium)",
            "breakdown": "Network exploitable, low complexity, but requires auth, limited confidentiality impact only"
          }
        }
      }
    },
    {
      "id": "artifact_3",
      "title": "Vulnerability Prioritization Framework",
      "type": "reference",
      "unlocks_at": "decision_4",
      "content": {
        "prioritization_factors": {
          "cvss_is_not_enough": {
            "explanation": "CVSS measures technical severity, not actual risk",
            "additional_factors": [
              "Asset criticality - what does it protect/enable?",
              "Exposure - is it internet-facing or internal?",
              "Exploitability - is there active exploitation?",
              "Business context - what's the impact of compromise?"
            ]
          },
          "risk_based_prioritization": {
            "formula": "Risk = Likelihood Ã— Impact",
            "likelihood_factors": [
              "Exploit availability (PoC, weaponized, ITW)",
              "Attack vector accessibility",
              "Required privileges/complexity",
              "Threat actor targeting"
            ],
            "impact_factors": [
              "Asset business value",
              "Data sensitivity",
              "Regulatory implications",
              "Operational dependency"
            ]
          }
        },
        "prioritization_tiers": {
          "tier_1_immediate": {
            "timeframe": "24-72 hours",
            "criteria": [
              "Critical CVSS (9.0+) on internet-facing systems",
              "Active exploitation in the wild",
              "Affects critical business systems",
              "Trivial exploitation (no auth, no complexity)"
            ],
            "examples": ["Internet-facing RCE", "Actively exploited zero-day"]
          },
          "tier_2_urgent": {
            "timeframe": "1-2 weeks",
            "criteria": [
              "High CVSS (7.0-8.9) on important systems",
              "Public exploit available",
              "Medium criticality assets",
              "Requires some privileges but achievable"
            ],
            "examples": ["Auth required RCE", "High-value internal system vulnerability"]
          },
          "tier_3_standard": {
            "timeframe": "30 days",
            "criteria": [
              "Medium CVSS (4.0-6.9)",
              "Limited exposure",
              "Low criticality assets",
              "Complex exploitation"
            ],
            "examples": ["Internal-only vulnerabilities", "Complex exploit chains"]
          },
          "tier_4_scheduled": {
            "timeframe": "90 days or next maintenance",
            "criteria": [
              "Low CVSS (0.1-3.9)",
              "No known exploit",
              "Non-critical systems",
              "Physical access required"
            ],
            "examples": ["Physical access vulnerabilities", "Informational findings"]
          }
        },
        "exploit_maturity_priority": {
          "actively_exploited": {
            "description": "Known attacks using this vulnerability",
            "priority": "Highest - treat as emergency",
            "sources": ["CISA KEV", "Threat intelligence", "Vendor advisories"]
          },
          "weaponized_exploit": {
            "description": "Reliable exploit in attack frameworks",
            "priority": "Very High - expect attacks",
            "sources": ["Metasploit", "Exploit-DB", "Underground forums"]
          },
          "poc_available": {
            "description": "Proof of concept code published",
            "priority": "High - weaponization likely",
            "sources": ["GitHub", "Security conferences", "Researcher blogs"]
          },
          "theoretical": {
            "description": "No known exploit code",
            "priority": "Standard - based on CVSS and exposure",
            "sources": ["Vendor advisory only"]
          }
        }
      }
    },
    {
      "id": "artifact_4",
      "title": "Mitigation Techniques Reference",
      "type": "reference",
      "unlocks_at": "decision_6",
      "content": {
        "mitigation_hierarchy": {
          "remediate": {
            "description": "Fully fix the vulnerability",
            "methods": ["Apply vendor patch", "Upgrade software", "Rewrite vulnerable code"],
            "effectiveness": "Highest - eliminates vulnerability",
            "challenges": "May require downtime, testing, compatibility checks"
          },
          "mitigate": {
            "description": "Reduce risk without fully fixing",
            "methods": ["Configuration changes", "Disable vulnerable features", "Restrict access"],
            "effectiveness": "High - reduces exposure/exploitability",
            "challenges": "May impact functionality"
          },
          "compensate": {
            "description": "Add controls to protect vulnerable system",
            "methods": ["WAF rules", "Network segmentation", "Enhanced monitoring", "Additional authentication"],
            "effectiveness": "Medium - doesn't fix but protects",
            "challenges": "Requires ongoing maintenance, may be bypassed"
          },
          "accept": {
            "description": "Document and accept residual risk",
            "requirements": ["Management sign-off", "Risk justification", "Review timeline"],
            "when_appropriate": "Low risk, high remediation cost, planned decommission",
            "challenges": "Must be formally documented and time-limited"
          }
        },
        "common_mitigations": {
          "patching": {
            "description": "Apply vendor security updates",
            "best_practices": [
              "Test in non-production first",
              "Have rollback plan",
              "Prioritize by risk",
              "Maintain patch inventory"
            ],
            "challenges": ["Legacy systems", "Compatibility issues", "Downtime requirements"]
          },
          "hardening": {
            "description": "Secure configuration of systems",
            "techniques": [
              "Disable unnecessary services",
              "Remove default accounts",
              "Apply secure configuration baselines",
              "Enable security features"
            ],
            "standards": ["CIS Benchmarks", "DISA STIGs", "Vendor guidelines"]
          },
          "segmentation": {
            "description": "Isolate vulnerable or critical systems",
            "techniques": [
              "Network VLANs",
              "Firewall rules",
              "Micro-segmentation",
              "Air-gapping"
            ],
            "benefit": "Limits blast radius of compromise"
          },
          "input_validation": {
            "description": "Validate and sanitize user input",
            "techniques": [
              "Whitelist validation",
              "Parameterized queries",
              "Output encoding",
              "Input length limits"
            ],
            "prevents": ["SQL injection", "XSS", "Command injection", "Buffer overflow"]
          },
          "waf_ids_ips": {
            "description": "Web Application Firewall / Intrusion Prevention",
            "capabilities": [
              "Block known attack patterns",
              "Virtual patching",
              "Rate limiting",
              "Protocol validation"
            ],
            "limitations": ["Can be bypassed", "False positives", "Requires tuning"]
          }
        }
      }
    },
    {
      "id": "artifact_5",
      "title": "Vulnerability Management Lifecycle",
      "type": "reference",
      "unlocks_at": "decision_8",
      "content": {
        "lifecycle_phases": {
          "1_asset_discovery": {
            "description": "Know what you have",
            "activities": ["Network scanning", "Asset inventory", "Classification"],
            "importance": "Can't protect what you don't know about"
          },
          "2_vulnerability_scanning": {
            "description": "Identify vulnerabilities",
            "types": {
              "authenticated": "With credentials - deeper visibility",
              "unauthenticated": "External perspective - what attackers see",
              "agent_based": "Continuous monitoring via installed agent"
            },
            "frequency": "Weekly to monthly depending on criticality"
          },
          "3_assessment": {
            "description": "Evaluate and validate findings",
            "activities": [
              "Validate findings (reduce false positives)",
              "Calculate risk scores",
              "Map to assets and business context",
              "Prioritize based on risk"
            ]
          },
          "4_remediation": {
            "description": "Fix or mitigate vulnerabilities",
            "activities": [
              "Develop remediation plan",
              "Test patches/changes",
              "Deploy fixes",
              "Implement compensating controls"
            ]
          },
          "5_verification": {
            "description": "Confirm remediation success",
            "activities": [
              "Rescan to verify fix",
              "Validate compensating controls",
              "Update vulnerability status",
              "Document closure"
            ]
          },
          "6_reporting": {
            "description": "Track and communicate status",
            "metrics": [
              "Time to remediate by severity",
              "Vulnerability count trends",
              "Percentage within SLA",
              "Risk reduction over time"
            ],
            "audiences": ["Technical teams", "Management", "Auditors"]
          }
        },
        "common_challenges": {
          "scan_overload": {
            "problem": "Too many findings to address",
            "solution": "Risk-based prioritization, focus on crown jewels"
          },
          "legacy_systems": {
            "problem": "No patches available for old systems",
            "solution": "Compensating controls, isolation, planned replacement"
          },
          "business_resistance": {
            "problem": "Teams resist patching due to downtime fears",
            "solution": "Risk communication, scheduled maintenance windows, rollback plans"
          },
          "false_positives": {
            "problem": "Scanner reports vulnerabilities that don't exist",
            "solution": "Validation process, scanner tuning, authenticated scans"
          }
        }
      }
    }
  ],
  
  "decision_points": [
    {
      "id": "decision_1",
      "sequence": 1,
      "title": "Basic Vulnerability Classification",
      "narrative": "Marcus starts with fundamentals. 'A web application has a flaw where user input in a search field is directly inserted into a database query without sanitization. An attacker enters: ' OR '1'='1 and retrieves all records. What type of vulnerability is this?'",
      "question": "What type of vulnerability allows this attack?",
      "options": [
        {
          "id": "A",
          "text": "Cross-Site Scripting (XSS) - injecting malicious code",
          "is_correct": false,
          "points": 5,
          "feedback": {
            "short": "XSS involves injecting JavaScript, not SQL",
            "detailed": "XSS involves injecting malicious JavaScript that executes in victims' browsers. This attack injects SQL code that executes on the database server. The target (database vs. browser) and the language (SQL vs. JavaScript) distinguish these vulnerabilities.",
            "consequence": "Wrong mitigation focus - XSS defenses won't prevent SQL injection."
          }
        },
        {
          "id": "B",
          "text": "SQL Injection - inserting SQL code via user input",
          "is_correct": true,
          "points": 25,
          "feedback": {
            "short": "Correct! Classic SQL injection attack",
            "detailed": "This is SQL Injection (SQLi): user input is incorporated directly into SQL queries without proper sanitization or parameterization. The payload ' OR '1'='1 modifies the query logic to return all records. SQLi can lead to data theft, authentication bypass, and even command execution on the database server.",
            "consequence": "Correct identification enables proper remediation: parameterized queries, input validation, WAF rules."
          }
        },
        {
          "id": "C",
          "text": "Buffer Overflow - exceeding memory allocation",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "Buffer overflow involves memory, not query manipulation",
            "detailed": "Buffer overflow occurs when data exceeds allocated memory bounds, potentially overwriting adjacent memory and enabling code execution. This attack manipulates query LOGIC, not memory. The input isn't too long - it's SQL code designed to change query behavior.",
            "consequence": "Completely wrong vulnerability category."
          }
        },
        {
          "id": "D",
          "text": "Insecure Direct Object Reference (IDOR) - accessing unauthorized records",
          "is_correct": false,
          "points": 10,
          "feedback": {
            "short": "IDOR involves manipulating object identifiers",
            "detailed": "IDOR involves accessing objects by manipulating identifiers (like changing user ID from 123 to 124). While the RESULT might be similar (accessing unauthorized data), the METHOD is different. IDOR manipulates legitimate parameters; SQLi injects code that changes query behavior.",
            "consequence": "Different attack vector requires different defenses."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "What type of attack involves inserting database query commands into user input fields?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "SQL Injection inserts SQL code via user input. The payload ' OR '1'='1 is a classic SQLi test pattern."
        }
      ],
      "learning_note": "SQL Injection (SQLi) occurs when user input is incorporated directly into SQL queries without sanitization. Attackers inject SQL code that modifies query logic. Prevention: parameterized queries (prepared statements), input validation, stored procedures, least privilege database accounts, WAF rules."
    },
    {
      "id": "decision_2",
      "sequence": 2,
      "title": "CVSS Score Interpretation",
      "narrative": "'Understanding CVSS is essential,' Marcus explains. 'Here's a vulnerability: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H with a score of 9.8 Critical. What does this vector string tell us about the vulnerability?'",
      "question": "What does this CVSS 9.8 vector string indicate?",
      "options": [
        {
          "id": "A",
          "text": "Local vulnerability requiring physical access and user interaction",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "Vector shows opposite - network exploitable, no user interaction",
            "detailed": "The vector shows: AV:N (Network - remote exploitation), PR:N (No Privileges required), UI:N (No User Interaction needed). Physical access and user interaction would lower the score significantly. This vulnerability is remotely exploitable without any prerequisites.",
            "consequence": "Misunderstanding vulnerability accessibility."
          }
        },
        {
          "id": "B",
          "text": "Network exploitable, no authentication required, full system compromise possible",
          "is_correct": true,
          "points": 25,
          "feedback": {
            "short": "Correct! Critical remote vulnerability",
            "detailed": "The vector indicates: AV:N (Network - remote), AC:L (Low complexity - easy), PR:N (No privileges - unauthenticated), UI:N (No user interaction), C:H/I:H/A:H (High impact to Confidentiality, Integrity, Availability). This is the worst case: easy remote exploitation with complete system compromise. This is why it scores 9.8 Critical.",
            "consequence": "Correct understanding enables proper prioritization - this is Tier 1 immediate."
          }
        },
        {
          "id": "C",
          "text": "Medium severity requiring authenticated access",
          "is_correct": false,
          "points": 5,
          "feedback": {
            "short": "PR:N means NO privileges required",
            "detailed": "PR:N specifically means 'Privileges Required: None' - the attacker doesn't need any authentication. The 9.8 score is Critical, not Medium. Medium would be 4.0-6.9. This vulnerability is extremely severe.",
            "consequence": "Underestimating critical vulnerability severity."
          }
        },
        {
          "id": "D",
          "text": "High severity but only affects confidentiality",
          "is_correct": false,
          "points": 5,
          "feedback": {
            "short": "C:H/I:H/A:H means all three CIA components are impacted",
            "detailed": "The impact metrics C:H/I:H/A:H indicate HIGH impact to Confidentiality AND Integrity AND Availability. This means complete compromise of all three security pillars - not just confidentiality. Full CIA impact is why the score is so high.",
            "consequence": "Underestimating the scope of potential impact."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "Decode the metrics: AV=Attack Vector, PR=Privileges Required, UI=User Interaction, C/I/A=Impact. N=None/Network, L=Low, H=High."
        },
        {
          "level": 2,
          "cost": 5,
          "text": "AV:N (network), AC:L (low complexity), PR:N (no auth), UI:N (no user action), all high impacts = worst case remotely exploitable vulnerability."
        }
      ],
      "learning_note": "CVSS vector strings encode vulnerability characteristics. Key metrics: Attack Vector (N=network is worst), Privileges Required (N=none is worst), User Interaction (N=none is worst), Impact (H=high is worst). A 9.8 with AV:N/PR:N/UI:N and full CIA impact represents an easily exploitable critical vulnerability.",
      "unlocks_artifact": "artifact_2"
    },
    {
      "id": "decision_3",
      "sequence": 3,
      "title": "Zero-Day Understanding",
      "narrative": "Marcus presents a scenario: 'Your threat intelligence team alerts you: a new vulnerability has been discovered in your firewall vendor's software. It's being actively exploited by attackers. The vendor is aware but has not released a patch. What type of vulnerability is this?'",
      "question": "What type of vulnerability is this?",
      "options": [
        {
          "id": "A",
          "text": "Known vulnerability - vendor is aware of it",
          "is_correct": false,
          "points": 10,
          "feedback": {
            "short": "Known but unpatched with active exploitation = zero-day",
            "detailed": "While the vendor now knows about it, the defining characteristic is that NO PATCH EXISTS while it's being actively exploited. A 'known vulnerability' typically implies a patch is available. This is specifically a zero-day: the vendor has had 'zero days' to prepare defenses for their customers.",
            "consequence": "Waiting for patch when immediate compensating controls are needed."
          }
        },
        {
          "id": "B",
          "text": "Zero-day vulnerability - actively exploited with no available patch",
          "is_correct": true,
          "points": 25,
          "feedback": {
            "short": "Correct! Zero-day = exploited before patch exists",
            "detailed": "This is a zero-day vulnerability: it's being actively exploited 'in the wild' and no patch is available. The name comes from the vendor having 'zero days' to fix the issue before attacks began. Zero-days require immediate compensating controls (isolation, monitoring, workarounds) since patching isn't possible.",
            "consequence": "Correct identification triggers emergency response procedures and compensating control implementation."
          }
        },
        {
          "id": "C",
          "text": "Legacy vulnerability - affecting older software",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "Legacy refers to old/unsupported systems",
            "detailed": "Legacy vulnerabilities affect old systems that may no longer receive patches due to end-of-life. This scenario describes a CURRENT product where the vendor IS working on a fix but hasn't released it yet. The defining issue is active exploitation before patch availability = zero-day.",
            "consequence": "Wrong categorization delays appropriate response."
          }
        },
        {
          "id": "D",
          "text": "Theoretical vulnerability - no active exploitation yet",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "Scenario explicitly states active exploitation",
            "detailed": "The scenario states it's 'being actively exploited by attackers.' That's not theoretical - it's real-world attacks happening now. Active exploitation with no patch is the definition of a zero-day. Theoretical would mean the vulnerability was found but no exploits exist.",
            "consequence": "Underestimating active threat."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "What term describes a vulnerability being exploited before the vendor can provide a patch?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "Zero-day: actively exploited vulnerability with no available patch. Vendor has had 'zero days' to prepare defenses."
        }
      ],
      "learning_note": "Zero-day vulnerabilities are actively exploited before patches exist. Response requires: compensating controls (WAF rules, segmentation, disabling features), enhanced monitoring, threat intelligence tracking, and rapid patch deployment once available. Zero-days often come from: security researchers, threat intelligence, or incident discovery."
    },
    {
      "id": "decision_4",
      "sequence": 4,
      "title": "Risk-Based Prioritization",
      "narrative": "'CVSS alone doesn't tell the whole story,' Marcus explains. 'You have two vulnerabilities: Vuln A is CVSS 9.8 on an internal test server with no production data. Vuln B is CVSS 7.5 on your internet-facing payment processing system. Which should you prioritize?'",
      "question": "Which vulnerability should be prioritized for immediate remediation?",
      "options": [
        {
          "id": "A",
          "text": "Vuln A (CVSS 9.8) - higher severity always means higher priority",
          "is_correct": false,
          "points": 5,
          "feedback": {
            "short": "CVSS doesn't account for business context",
            "detailed": "CVSS measures technical severity in isolation, not actual business risk. A CVSS 9.8 on an isolated test server with no data represents LOW actual risk - there's nothing valuable to compromise and limited attack surface. CVSS must be combined with asset criticality and exposure to determine priority.",
            "consequence": "Resources spent on low-risk system while high-risk system remains vulnerable."
          }
        },
        {
          "id": "B",
          "text": "Vuln B (CVSS 7.5 on payment system) - business context makes it higher risk",
          "is_correct": true,
          "points": 25,
          "feedback": {
            "short": "Correct! Risk = CVSS + Asset Criticality + Exposure",
            "detailed": "True risk considers: vulnerability severity (CVSS), asset criticality (payment system = critical), and exposure (internet-facing = maximum exposure). Vuln B on a critical, exposed system represents much higher actual risk than Vuln A on a low-value, internal system. Risk-based prioritization accounts for business context.",
            "consequence": "Correct prioritization protects critical business assets first."
          }
        },
        {
          "id": "C",
          "text": "Both equally - both are high severity",
          "is_correct": false,
          "points": 10,
          "feedback": {
            "short": "Resources are limited - prioritization is necessary",
            "detailed": "In theory, both should be fixed. In practice, resources are limited and you must prioritize. 'Both equally' isn't helpful when you have to choose what to fix first. The payment system represents significantly higher business risk and should be addressed before the test server.",
            "consequence": "Lack of prioritization leads to inefficient resource allocation."
          }
        },
        {
          "id": "D",
          "text": "Neither - wait for more vulnerabilities to batch together",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "High severity vulnerabilities require prompt action",
            "detailed": "Both vulnerabilities are high severity and require action. 'Batching' might make sense for low-severity findings, but CVSS 7.5+ vulnerabilities, especially on critical systems, need prompt remediation. Waiting increases exposure time and risk of exploitation.",
            "consequence": "Delayed remediation increases exposure to attack."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "Consider: What's the business impact if each system is compromised? Which is more exposed to attackers?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "Risk = CVSS Ã— Asset Criticality Ã— Exposure. Internet-facing payment system with 7.5 > internal test server with 9.8."
        }
      ],
      "learning_note": "Risk-based prioritization combines CVSS with business context: asset criticality (what business process depends on it?), data sensitivity (what information is at risk?), and exposure (is it internet-facing?). A medium-CVSS vulnerability on a critical exposed system often represents more risk than a critical-CVSS vulnerability on an isolated test system.",
      "unlocks_artifact": "artifact_3"
    },
    {
      "id": "decision_5",
      "sequence": 5,
      "title": "Exploit Availability Impact",
      "narrative": "Marcus continues: 'Two vulnerabilities both scored CVSS 8.0. Vuln X has a Metasploit module available. Vuln Y has only a theoretical advisory from the vendor. How does exploit availability affect prioritization?'",
      "question": "How should exploit availability affect your prioritization?",
      "options": [
        {
          "id": "A",
          "text": "No effect - CVSS score is what matters for priority",
          "is_correct": false,
          "points": 5,
          "feedback": {
            "short": "Exploit availability significantly increases likelihood",
            "detailed": "CVSS base score doesn't account for whether exploits exist. A vulnerability with a weaponized Metasploit module can be exploited by anyone with basic skills, dramatically increasing likelihood of attack. Exploit availability is a critical prioritization factor beyond CVSS.",
            "consequence": "Equal treatment when actual risk levels are very different."
          }
        },
        {
          "id": "B",
          "text": "Vuln X (Metasploit) should be prioritized higher - weaponized exploit means imminent threat",
          "is_correct": true,
          "points": 25,
          "feedback": {
            "short": "Correct! Weaponized exploits dramatically increase likelihood",
            "detailed": "When a vulnerability has a Metasploit module, exploitation is trivial - attackers literally click a button. This dramatically increases likelihood of attack compared to a theoretical vulnerability requiring custom exploit development. Exploit maturity is a key prioritization factor: actively exploited > weaponized > PoC > theoretical.",
            "consequence": "Correct prioritization addresses imminent threats first."
          }
        },
        {
          "id": "C",
          "text": "Vuln Y (theoretical) should be prioritized - get ahead before exploits appear",
          "is_correct": false,
          "points": 10,
          "feedback": {
            "short": "Address current threats before potential future threats",
            "detailed": "While being proactive is good, when one vulnerability is actively weaponized and the other is theoretical, you must address the immediate threat first. Vuln X can be exploited RIGHT NOW by anyone. Vuln Y MIGHT be exploitable someday. Focus resources on current risk.",
            "consequence": "Ignoring active threat to address potential future threat."
          }
        },
        {
          "id": "D",
          "text": "Both should be deprioritized - 8.0 isn't critical",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "8.0 is HIGH severity requiring prompt attention",
            "detailed": "CVSS 8.0 is HIGH severity (7.0-8.9 range). Combined with a weaponized exploit, Vuln X is extremely dangerous. Deprioritizing based on 'not critical' ignores that HIGH severity vulnerabilities with public exploits are frequently exploited in attacks.",
            "consequence": "Leaving highly exploitable vulnerabilities unaddressed."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "How does having a point-and-click exploit tool change the likelihood someone will exploit a vulnerability?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "Exploit maturity hierarchy: Actively exploited > Weaponized (Metasploit) > PoC available > Theoretical. Higher maturity = higher priority."
        }
      ],
      "learning_note": "Exploit availability dramatically affects risk. Prioritization hierarchy: (1) Actively exploited in the wild, (2) Weaponized exploit (Metasploit, exploit kits), (3) Proof-of-concept available, (4) Theoretical/no known exploit. CISA's Known Exploited Vulnerabilities (KEV) catalog tracks actively exploited vulnerabilities requiring immediate attention."
    },
    {
      "id": "decision_6",
      "sequence": 6,
      "title": "Compensating Controls",
      "narrative": "'Sometimes you can't patch immediately,' Marcus notes. 'You have a critical SQL injection vulnerability in a legacy application. The vendor is out of business, no patch will ever exist, and the application supports a critical business process. What's your approach?'",
      "question": "How should you handle a critical vulnerability that cannot be patched?",
      "options": [
        {
          "id": "A",
          "text": "Accept the risk - nothing can be done without a patch",
          "is_correct": false,
          "points": 5,
          "feedback": {
            "short": "Compensating controls can reduce risk without patching",
            "detailed": "Risk acceptance should be a last resort after all mitigation options are exhausted. Compensating controls - WAF rules to block SQLi patterns, network segmentation, enhanced monitoring, input validation at the network layer - can significantly reduce risk even when patching isn't possible.",
            "consequence": "Unnecessary risk exposure when mitigations are available."
          }
        },
        {
          "id": "B",
          "text": "Implement compensating controls: WAF rules, segmentation, monitoring, input validation",
          "is_correct": true,
          "points": 25,
          "feedback": {
            "short": "Correct! Compensating controls protect when patching isn't possible",
            "detailed": "Compensating controls reduce risk without fixing the underlying vulnerability: WAF (block SQLi patterns at network layer), segmentation (limit who can reach the application), monitoring (detect exploitation attempts), prepared statements/input validation at proxy layer. Also: document the risk, plan for application replacement, and set review dates.",
            "consequence": "Risk significantly reduced while maintaining business operations. Plan for long-term replacement initiated."
          }
        },
        {
          "id": "C",
          "text": "Immediately shut down the application - security trumps business",
          "is_correct": false,
          "points": 10,
          "feedback": {
            "short": "Business continuity matters - find balanced solution",
            "detailed": "Shutting down a critical business application is a last resort, not a first response. Security's job is to enable business safely, not stop business entirely. Compensating controls can reduce risk to acceptable levels while the business plans for application replacement. Balance security with operational needs.",
            "consequence": "Business disruption when alternatives exist."
          }
        },
        {
          "id": "D",
          "text": "Ignore it - legacy applications aren't worth securing",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "Legacy applications often hold valuable data and access",
            "detailed": "Legacy applications often support critical business processes and contain valuable data. Attackers specifically target legacy systems because they're often less protected. The 'critical business process' mentioned makes this application high value. Ignoring it creates significant organizational risk.",
            "consequence": "Critical system left vulnerable, likely to be compromised."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "What security controls can reduce risk from a vulnerability even when you can't patch it?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "Compensating controls: WAF (block attack patterns), segmentation (limit access), monitoring (detect attacks), input validation (filter at network layer)."
        }
      ],
      "learning_note": "Compensating controls protect systems when patching isn't possible. Common compensating controls: WAF/virtual patching, network segmentation, enhanced monitoring/alerting, additional authentication, disable vulnerable features, input validation at network layer. Document risk acceptance with management sign-off and set timeline for long-term remediation (replacement).",
      "unlocks_artifact": "artifact_4"
    },
    {
      "id": "decision_7",
      "sequence": 7,
      "title": "Configuration vs Code Vulnerability",
      "narrative": "Marcus shows scan results: 'Your scan found two findings on the same web server. Finding 1: SSL 3.0 enabled (CVSS 4.3). Finding 2: Code injection vulnerability in custom application (CVSS 8.5). Which is a configuration issue vs. a code vulnerability?'",
      "question": "Which findings are configuration vs. code vulnerabilities?",
      "options": [
        {
          "id": "A",
          "text": "Both are configuration issues - they're both on the web server",
          "is_correct": false,
          "points": 5,
          "feedback": {
            "short": "Code injection is an application code flaw",
            "detailed": "Code injection vulnerabilities exist in the application source code - improper handling of user input. This requires code changes to fix (input validation, parameterized queries). SSL 3.0 is a configuration issue - the server is configured to allow an outdated protocol. Location doesn't determine type.",
            "consequence": "Wrong remediation approach - configuration change won't fix code vulnerability."
          }
        },
        {
          "id": "B",
          "text": "SSL 3.0 = configuration (disable protocol), Code injection = code (fix application)",
          "is_correct": true,
          "points": 25,
          "feedback": {
            "short": "Correct! Configuration vs code determines remediation approach",
            "detailed": "SSL 3.0 enabled is a CONFIGURATION vulnerability - the fix is changing server configuration to disable the deprecated protocol. Code injection is a CODE vulnerability - the fix requires modifying the application source code to properly validate/sanitize input. This distinction determines who fixes it and how.",
            "consequence": "Correct categorization routes to appropriate teams: sysadmin for configuration, developers for code."
          }
        },
        {
          "id": "C",
          "text": "Both are code vulnerabilities - they both affect the web application",
          "is_correct": false,
          "points": 5,
          "feedback": {
            "short": "SSL/TLS settings are server configuration",
            "detailed": "SSL/TLS protocol settings are web SERVER configuration, not application code. You fix it by modifying server settings (Apache, Nginx, IIS configuration files), not by writing code. The web application running on the server is separate from the server's TLS configuration.",
            "consequence": "Sending configuration issues to developers wastes time."
          }
        },
        {
          "id": "D",
          "text": "SSL 3.0 = code (protocol implementation), Code injection = configuration (input handling setting)",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "Reversed categorization",
            "detailed": "This is backwards. SSL 3.0 being enabled is a configuration choice (which protocols the server accepts). Code injection is a code flaw (how the application handles input). You don't need to modify code to disable SSL 3.0 - you change a configuration file.",
            "consequence": "Completely wrong remediation approach for both."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "Configuration issues are fixed by changing settings. Code issues require changing source code. Which is which?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "SSL 3.0: server setting to disable deprecated protocol = configuration. Code injection: fix how application handles input = code change."
        }
      ],
      "learning_note": "Configuration vulnerabilities (misconfigurations) are fixed by changing system settings: enabling/disabling features, adjusting parameters, hardening configurations. Code vulnerabilities require source code changes: fixing input validation, patching logic flaws, updating vulnerable functions. This distinction determines remediation responsibility (operations vs. development) and process (configuration change vs. code deployment)."
    },
    {
      "id": "decision_8",
      "sequence": 8,
      "title": "Vulnerability Scanning Types",
      "narrative": "'Different scan types serve different purposes,' Marcus explains. 'You want to understand what an external attacker sees when targeting your organization. What type of vulnerability scan should you run?'",
      "question": "What scan type shows the external attacker's perspective?",
      "options": [
        {
          "id": "A",
          "text": "Authenticated internal scan - provides the most complete results",
          "is_correct": false,
          "points": 10,
          "feedback": {
            "short": "Authenticated internal shows defender's view, not attacker's",
            "detailed": "Authenticated internal scans provide the most complete vulnerability inventory (useful!), but that's not what an external attacker sees. External attackers don't have credentials or internal network access. You need an unauthenticated external scan to see the attacker's view.",
            "consequence": "Don't see what attackers actually see."
          }
        },
        {
          "id": "B",
          "text": "Unauthenticated external scan - mimics what an internet attacker sees",
          "is_correct": true,
          "points": 25,
          "feedback": {
            "short": "Correct! Unauthenticated external = attacker perspective",
            "detailed": "Unauthenticated external scanning mimics an internet attacker: scanning from outside your network without credentials. This shows what's exposed and exploitable from the internet - your actual external attack surface. This should be run regularly in addition to internal scans.",
            "consequence": "Clear view of external attack surface - what attackers actually target."
          }
        },
        {
          "id": "C",
          "text": "Agent-based scan - continuous monitoring is most accurate",
          "is_correct": false,
          "points": 5,
          "feedback": {
            "short": "Agent-based requires installation on target systems",
            "detailed": "Agent-based scanning requires installing software on the systems being scanned. External attackers don't have agents installed on your systems. Agent-based scanning is excellent for comprehensive internal visibility but doesn't show the external attacker perspective.",
            "consequence": "Internal perspective, not external attacker view."
          }
        },
        {
          "id": "D",
          "text": "Passive scanning - doesn't interact with systems, safest option",
          "is_correct": false,
          "points": 5,
          "feedback": {
            "short": "Passive scanning only monitors traffic",
            "detailed": "Passive scanning monitors network traffic without sending probes - useful for detecting vulnerable systems by their traffic patterns. However, it can't actively identify vulnerabilities the way an attacker would (by probing). Active external scanning is needed to see the attacker's view.",
            "consequence": "Limited visibility of actual vulnerabilities."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "What perspective does an external attacker have? Outside your network, no credentials, probing your internet-facing systems."
        },
        {
          "level": 2,
          "cost": 5,
          "text": "Unauthenticated external scan: from internet, no credentials, targets external-facing systems = attacker's view."
        }
      ],
      "learning_note": "Scan types serve different purposes: Unauthenticated external (attacker's view of external attack surface), Authenticated internal (comprehensive internal inventory), Agent-based (continuous monitoring, patch verification), Passive (non-intrusive traffic analysis). Use external scans to validate what attackers can see and target.",
      "unlocks_artifact": "artifact_5"
    },
    {
      "id": "decision_9",
      "sequence": 9,
      "title": "False Positive Handling",
      "narrative": "Marcus presents a challenge: 'Your scan reports CVE-2024-1234 (critical RCE in Apache 2.4.49) on a web server. However, you check and the server is running Apache 2.4.52. The scanner is likely reporting a false positive. How do you handle this?'",
      "question": "How should you handle this potential false positive?",
      "options": [
        {
          "id": "A",
          "text": "Ignore the finding - it's obviously wrong",
          "is_correct": false,
          "points": 5,
          "feedback": {
            "short": "Never simply ignore - validate and document",
            "detailed": "Simply ignoring findings is dangerous - what if you're wrong? What if the version check was incorrect? Proper process requires validation and documentation. If it's truly a false positive, document why and mark as such. This creates an audit trail and ensures nothing slips through.",
            "consequence": "No documentation if finding was real, no process improvement for future scans."
          }
        },
        {
          "id": "B",
          "text": "Validate the finding, confirm version, document as false positive with evidence",
          "is_correct": true,
          "points": 25,
          "feedback": {
            "short": "Correct! Validate, verify, document",
            "detailed": "Proper false positive handling: (1) Validate the scanner finding against actual system state, (2) Verify using multiple methods (check installed version, examine files), (3) Document the evidence proving it's false, (4) Mark in vulnerability management system with explanation. This creates audit trail and helps tune scanning.",
            "consequence": "Clear documentation, audit trail maintained, future scans can be tuned."
          }
        },
        {
          "id": "C",
          "text": "Patch anyway - critical vulnerabilities should always be addressed",
          "is_correct": false,
          "points": 10,
          "feedback": {
            "short": "Unnecessary work if vulnerability doesn't exist",
            "detailed": "If the system is already on a patched version (2.4.52 vs vulnerable 2.4.49), there's nothing to patch - the vulnerability doesn't exist on this system. Treating false positives as real wastes resources and can cause unnecessary downtime. Validate first, then act.",
            "consequence": "Unnecessary change management, potential downtime for non-existent vulnerability."
          }
        },
        {
          "id": "D",
          "text": "Remove the scanner - too many false positives means it's not useful",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "One false positive doesn't invalidate the tool",
            "detailed": "All scanners produce some false positives - that's normal. The appropriate response is to validate findings and tune the scanner, not abandon it. One false positive doesn't mean the scanner is useless. Vulnerability scanning with validation is far better than no scanning.",
            "consequence": "Losing visibility into actual vulnerabilities."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "What's the proper process when you suspect a finding is incorrect?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "Validate â†’ Verify â†’ Document. Confirm actual system state, gather evidence, document decision with reasoning."
        }
      ],
      "learning_note": "False positive handling process: (1) Validate - check actual system state, (2) Verify - use multiple methods to confirm, (3) Document - record evidence and reasoning, (4) Update - mark in vulnerability management system. This maintains audit trail and helps improve scanner accuracy over time through tuning."
    },
    {
      "id": "decision_10",
      "sequence": 10,
      "title": "Comprehensive Prioritization",
      "narrative": "Marcus presents a final challenge with four vulnerabilities. Prioritize them:\n\nA: CVSS 9.8, internet-facing web app, Metasploit module available\nB: CVSS 10.0, isolated test server, no network connectivity, no exploit known\nC: CVSS 7.5, internal HR system with PII, PoC exploit on GitHub\nD: CVSS 6.5, internet-facing marketing site, actively being exploited per CISA KEV",
      "question": "What is the correct priority order from highest to lowest?",
      "options": [
        {
          "id": "A",
          "text": "B â†’ A â†’ C â†’ D (ordered by CVSS score)",
          "is_correct": false,
          "points": 5,
          "feedback": {
            "short": "CVSS alone doesn't determine priority",
            "detailed": "CVSS 10.0 sounds scary, but on an isolated test server with no network connectivity? Extremely low actual risk - no attacker can reach it. Meanwhile, D is actively being exploited but would be lowest priority by CVSS. Risk-based prioritization considers exposure, exploit status, and asset value - not just CVSS.",
            "consequence": "Addressing low-risk systems while active attacks continue on exposed systems."
          }
        },
        {
          "id": "B",
          "text": "D â†’ A â†’ C â†’ B (active exploitation first, then exposure and asset value)",
          "is_correct": true,
          "points": 25,
          "feedback": {
            "short": "Correct! Active exploitation trumps theoretical severity",
            "detailed": "Correct priority: D first (ACTIVELY exploited per CISA KEV - attacks happening NOW despite lower CVSS), A second (internet-facing + weaponized Metasploit = imminent threat), C third (internal but has PII + PoC exists = real risk), B last (isolated, no connectivity, no exploit = theoretical only). Real risk trumps theoretical severity.",
            "consequence": "Resources focused on actual threats in priority order."
          }
        },
        {
          "id": "C",
          "text": "A â†’ D â†’ B â†’ C (internet-facing first)",
          "is_correct": false,
          "points": 15,
          "feedback": {
            "short": "Active exploitation should trump potential exploitation",
            "detailed": "Internet exposure matters, but D is ACTIVELY BEING EXPLOITED per CISA KEV - meaning attacks are happening right now. A has a Metasploit module (could be exploited easily) but D has confirmed active attacks. Active exploitation always takes priority over potential exploitation.",
            "consequence": "Addressing potential threats before confirmed active attacks."
          }
        },
        {
          "id": "D",
          "text": "C â†’ A â†’ D â†’ B (PII data sensitivity first)",
          "is_correct": false,
          "points": 10,
          "feedback": {
            "short": "Data sensitivity matters but active exploitation is more urgent",
            "detailed": "PII is important to protect, but the HR system is internal with only a PoC (not weaponized, not actively exploited). D is actively being exploited NOW on an internet-facing system. Urgency of active attacks exceeds the sensitivity calculation for the internal system.",
            "consequence": "Active attacks continue while addressing internal theoretical risk."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "What vulnerability status represents the most immediate threat? Hint: 'actively being exploited' means attacks are happening NOW."
        },
        {
          "level": 2,
          "cost": 5,
          "text": "Priority order: Active exploitation (CISA KEV) > Weaponized + Exposed > PoC + Sensitive data > Theoretical + Isolated."
        }
      ],
      "learning_note": "Comprehensive prioritization combines: (1) Exploit status - active exploitation trumps all, (2) Exposure - internet-facing > internal, (3) Asset value - critical systems and sensitive data, (4) CVSS - technical severity as one factor. CISA KEV (Known Exploited Vulnerabilities) catalog indicates confirmed active exploitation requiring immediate attention regardless of CVSS."
    }
  ],
  
  "summary_teaching_points": [
    {
      "topic": "Vulnerability Types",
      "key_points": [
        "Web vulnerabilities: SQLi, XSS, CSRF, IDOR, SSRF",
        "Application vulnerabilities: buffer overflow, race conditions",
        "Configuration vulnerabilities: misconfigurations, weak encryption",
        "Zero-day: actively exploited with no available patch"
      ]
    },
    {
      "topic": "CVSS Scoring",
      "key_points": [
        "CVSS measures technical severity, not business risk",
        "Key metrics: Attack Vector, Privileges Required, User Interaction, Impact",
        "Score ranges: Critical (9.0+), High (7.0-8.9), Medium (4.0-6.9), Low (0.1-3.9)",
        "Vector strings encode all metrics for standardized communication"
      ]
    },
    {
      "topic": "Risk-Based Prioritization",
      "key_points": [
        "Risk = CVSS + Asset Criticality + Exposure + Exploit Availability",
        "Active exploitation (CISA KEV) = highest priority",
        "Weaponized exploits > PoC > Theoretical",
        "Internet-facing critical systems prioritized over isolated test systems"
      ]
    },
    {
      "topic": "Mitigation Strategies",
      "key_points": [
        "Remediate (patch) when possible",
        "Compensating controls when patching isn't possible",
        "Configuration vs code vulnerabilities require different remediation",
        "Document risk acceptance with management sign-off"
      ]
    },
    {
      "topic": "Vulnerability Management",
      "key_points": [
        "Different scan types serve different purposes",
        "Validate findings - handle false positives properly",
        "External unauthenticated scans show attacker perspective",
        "Continuous process: scan â†’ assess â†’ prioritize â†’ remediate â†’ verify"
      ]
    }
  ],
  
  "weakness_mapping": {
    "provides_foundation_for": ["D2-SIM-002", "D2-SIM-005"],
    "addresses_gaps": [
      "Vulnerability type classification",
      "CVSS score interpretation",
      "Risk-based prioritization",
      "Compensating controls",
      "Vulnerability management process"
    ]
  },
  
  "prerequisites": [],
  "unlocks": ["D2-SIM-002_retry", "D2-SIM-005_retry"],
  
  "metadata": {
    "version": "1.0",
    "created": "2024-02-13",
    "author": "Security+ Training System",
    "domain_alignment": "Domain 2: Threats, Vulnerabilities, and Mitigations",
    "job_role_alignment": ["Vulnerability Analyst", "Security Analyst", "Risk Analyst"],
    "learning_focus": "Vulnerability assessment and prioritization fundamentals"
  }
}
