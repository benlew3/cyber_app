{
  "simulation_id": "D4-REM-002",
  "title": "Incident Response Basics",
  "domain": 4,
  "category": "remediation",
  "difficulty": "foundational",
  "time_estimate": "20-25 minutes",
  "passing_score": 40,
  "max_score": 50,
  
  "target_weaknesses": [
    "Understanding the incident response lifecycle",
    "Knowing when to contain vs investigate",
    "Evidence handling and preservation",
    "Communication and escalation procedures"
  ],
  
  "exam_objectives": [
    {
      "id": "4.8",
      "description": "Explain appropriate incident response activities",
      "coverage": ["IR phases", "containment", "eradication", "recovery", "lessons learned"]
    },
    {
      "id": "4.9",
      "description": "Given a scenario, use data sources to support an investigation",
      "coverage": ["evidence collection", "chain of custody", "forensic principles"]
    }
  ],
  
  "scenario_context": {
    "setting": "Incident response training - learning IR fundamentals",
    "your_role": "Junior incident responder in training",
    "narrative": "Welcome to incident response training. Today we'll learn the fundamentals of responding to security incidents - the phases of response, how to preserve evidence, when to contain threats, and how to communicate effectively. These skills are essential for any security professional."
  },
  
  "teaching_modules": [
    {
      "id": "module_1",
      "title": "The Incident Response Lifecycle",
      "trigger": "before_decision_1",
      "content": {
        "concept": "Incident response follows a structured lifecycle with distinct phases",
        "phases": {
          "1_preparation": {
            "description": "Get ready BEFORE incidents happen",
            "activities": ["Create IR plan", "Train team", "Set up tools", "Establish communication plans"],
            "key_insight": "Most of incident response happens before incidents occur"
          },
          "2_detection_analysis": {
            "description": "Identify that an incident is occurring and understand it",
            "activities": ["Monitor alerts", "Validate incidents", "Determine scope", "Assess severity"],
            "key_insight": "Not every alert is an incident - analysis determines severity"
          },
          "3_containment": {
            "description": "Stop the incident from spreading or causing more damage",
            "activities": ["Isolate systems", "Block attackers", "Preserve evidence"],
            "key_insight": "Balance speed of containment with evidence preservation"
          },
          "4_eradication": {
            "description": "Remove the threat from the environment",
            "activities": ["Remove malware", "Reset credentials", "Patch vulnerabilities"],
            "key_insight": "Ensure complete removal - partial eradication leads to re-compromise"
          },
          "5_recovery": {
            "description": "Restore systems to normal operation",
            "activities": ["Restore from backup", "Verify integrity", "Monitor for recurrence"],
            "key_insight": "Recovery isn't complete until systems are verified clean and monitored"
          },
          "6_lessons_learned": {
            "description": "Improve based on what happened",
            "activities": ["Document timeline", "Identify improvements", "Update procedures"],
            "key_insight": "Every incident is a learning opportunity"
          }
        }
      }
    },
    {
      "id": "module_2",
      "title": "Evidence Preservation",
      "trigger": "before_decision_2",
      "content": {
        "concept": "Evidence must be preserved for investigation and potential legal proceedings",
        "order_of_volatility": {
          "principle": "Collect most volatile evidence first - it disappears fastest",
          "order": [
            "Memory (RAM) - lost when powered off",
            "Network connections - change constantly",
            "Running processes - lost when system changes",
            "Disk contents - persistent but can be overwritten",
            "Remote logs - may rotate or be deleted",
            "Physical evidence - stable"
          ]
        },
        "chain_of_custody": {
          "purpose": "Document who handled evidence and when",
          "requirements": [
            "Who collected the evidence",
            "When it was collected",
            "Where it was stored",
            "Who accessed it and when",
            "Any changes made"
          ],
          "why_it_matters": "Evidence without chain of custody may be inadmissible in legal proceedings"
        },
        "forensic_principles": {
          "preserve_original": "Work on copies, never original evidence",
          "document_everything": "Record all actions taken",
          "verify_integrity": "Use hashes to prove evidence wasn't modified"
        }
      }
    },
    {
      "id": "module_3",
      "title": "Containment Strategies",
      "trigger": "before_decision_3",
      "content": {
        "concept": "Containment stops damage but must balance speed with evidence preservation",
        "containment_types": {
          "short_term": {
            "goal": "Stop immediate damage right now",
            "actions": ["Isolate system", "Block IP", "Disable account"],
            "timeframe": "Minutes to hours"
          },
          "long_term": {
            "goal": "Prevent re-infection while investigation continues",
            "actions": ["Patch vulnerability", "Reset all credentials", "Segment network"],
            "timeframe": "Hours to days"
          }
        },
        "containment_vs_investigation_tradeoff": {
          "aggressive_containment": {
            "pros": "Stops damage quickly",
            "cons": "May destroy evidence, alert attacker"
          },
          "preserve_and_observe": {
            "pros": "Gather more evidence, understand scope",
            "cons": "Damage may continue"
          },
          "best_practice": "Contain to stop critical damage while preserving what evidence you can"
        },
        "common_containment_actions": {
          "network_isolation": "Disconnect system from network (preserves local evidence)",
          "account_disable": "Stop attacker's authenticated access",
          "firewall_block": "Block attacker's IP/domain",
          "dns_sinkhole": "Redirect malicious domain queries"
        }
      }
    },
    {
      "id": "module_4",
      "title": "Communication During Incidents",
      "trigger": "before_decision_4",
      "content": {
        "concept": "Effective communication is critical during incidents",
        "internal_communication": {
          "ir_team": "Continuous updates, technical details",
          "management": "Regular status updates, decisions needed",
          "it_operations": "Coordination on containment and recovery",
          "legal": "Especially for data breaches, privacy issues",
          "hr": "If employee involvement suspected"
        },
        "external_communication": {
          "law_enforcement": "For serious crimes, may have helpful intelligence",
          "regulators": "Required notifications (HIPAA, PCI, state breach laws)",
          "customers": "If their data was affected",
          "public": "If incident becomes public"
        },
        "communication_principles": {
          "need_to_know": "Not everyone needs all details",
          "accuracy": "Don't speculate - say what you know",
          "timeliness": "Update stakeholders regularly even if no news",
          "documentation": "Record all communications"
        },
        "what_not_to_do": {
          "no_premature_disclosure": "Don't announce before facts are known",
          "no_blame": "Focus on response, not fault-finding (that comes later)",
          "no_unauthorized_statements": "Single spokesperson for external communication"
        }
      }
    }
  ],
  
  "decision_points": [
    {
      "id": "decision_1",
      "sequence": 1,
      "title": "Active Incident Response",
      "narrative": "You receive an alert: ransomware is actively encrypting files on a server. The encryption started 10 minutes ago and is spreading. You can see files being encrypted in real-time.",
      "question": "What should be your FIRST action?",
      "options": [
        {
          "id": "A",
          "text": "Begin forensic imaging of the server",
          "is_correct": false,
          "points": 2,
          "feedback": {
            "short": "Forensics can wait - the attack is active",
            "detailed": "While evidence is important, forensic imaging takes hours. During that time, more files are being encrypted. Stop the active damage first, then collect evidence. The server is creating its own logs of the encryption that will be available after containment."
          }
        },
        {
          "id": "B",
          "text": "Isolate the server from the network immediately",
          "is_correct": true,
          "points": 10,
          "feedback": {
            "short": "Correct! Stop the spread, then investigate",
            "detailed": "With active encryption, the priority is stopping further damage. Network isolation: stops ransomware from spreading to other systems, may stop encryption if it requires C2 communication, and preserves the server's state for investigation. You'll still have the encrypted files, memory, and logs after isolation."
          }
        },
        {
          "id": "C",
          "text": "Call a team meeting to discuss response options",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "No time for meetings during active attack",
            "detailed": "Every minute of meeting is more files encrypted. Active attacks require immediate action. Isolate first to stop damage, then coordinate. You can discuss next steps after immediate containment."
          }
        },
        {
          "id": "D",
          "text": "Shut down the server completely",
          "is_correct": false,
          "points": 4,
          "feedback": {
            "short": "Stops encryption but loses volatile evidence",
            "detailed": "Shutdown stops the ransomware but: loses memory contents (might contain encryption keys), loses running process information, and may corrupt partially encrypted files. Network isolation stops spread while preserving more evidence."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "The attack is active and spreading. What stops the spread while preserving the most evidence?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "Network isolation: stops lateral spread, keeps server running (preserves memory/processes), allows investigation of contained system."
        }
      ],
      "learning_note": "Active attack priority: CONTAIN FIRST. Network isolation is usually preferred over shutdown because it stops spread while preserving volatile evidence. Once contained, you have time for investigation. Don't let the perfect (complete evidence) be the enemy of the good (stopping the attack)."
    },
    {
      "id": "decision_2",
      "sequence": 2,
      "title": "Evidence Collection Priority",
      "narrative": "After containing the ransomware, you need to collect evidence. The server is isolated but still running. You have limited time before you need to begin recovery.",
      "question": "What evidence should you collect FIRST?",
      "options": [
        {
          "id": "A",
          "text": "Memory dump - capture RAM contents",
          "is_correct": true,
          "points": 10,
          "feedback": {
            "short": "Correct! Memory is most volatile - collect first",
            "detailed": "Memory contents are lost on reboot or shutdown. Memory may contain: the running malware, encryption keys (possibly allowing decryption), network connections, and attacker commands. Disk contents will persist - memory won't. Order of volatility: most volatile first."
          }
        },
        {
          "id": "B",
          "text": "Disk image - copy the entire hard drive",
          "is_correct": false,
          "points": 4,
          "feedback": {
            "short": "Important but disk is persistent - memory is more urgent",
            "detailed": "Disk imaging is important but disk contents persist. Memory is lost on power-off. Collect memory first, then disk image. You might even find encryption keys in memory that help recovery."
          }
        },
        {
          "id": "C",
          "text": "Ransom note screenshot - document the demand",
          "is_correct": false,
          "points": 2,
          "feedback": {
            "short": "The ransom note is a file on disk - it won't disappear",
            "detailed": "The ransom note is saved to disk and will be there when you image the drive. It's not volatile evidence. Memory contents, which may contain crucial forensic data, should come first."
          }
        },
        {
          "id": "D",
          "text": "Network logs from the firewall",
          "is_correct": false,
          "points": 4,
          "feedback": {
            "short": "Important but firewall logs are typically retained",
            "detailed": "Firewall logs are stored centrally and usually have retention periods. They're less volatile than the server's memory. Collect from the compromised server first, then gather supporting logs from network devices."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "Order of volatility - what evidence disappears first?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "Memory (RAM) is most volatile - lost on power off. May contain: running malware, encryption keys, attacker commands, network connections."
        }
      ],
      "learning_note": "Order of volatility for evidence collection: Memory â†’ Running processes â†’ Network connections â†’ Disk â†’ Remote logs â†’ Physical. Collect most volatile first. Memory analysis often reveals more about active malware than disk analysis."
    },
    {
      "id": "decision_3",
      "sequence": 3,
      "title": "Containment Decision",
      "narrative": "During investigation, you discover the attacker used a compromised user account (jsmith) to access the server. The account has legitimate access to multiple systems. The attacker may still have the credentials.",
      "question": "What is the MOST appropriate containment action for the compromised account?",
      "options": [
        {
          "id": "A",
          "text": "Monitor the account to see what else the attacker accesses",
          "is_correct": false,
          "points": 2,
          "feedback": {
            "short": "Too risky - attacker can cause more damage",
            "detailed": "While observing attacker activity can provide intelligence, the attacker has already deployed ransomware. Continued access risks additional damage. The investigation value doesn't outweigh the damage risk in this case."
          }
        },
        {
          "id": "B",
          "text": "Disable the account and reset the password immediately",
          "is_correct": true,
          "points": 10,
          "feedback": {
            "short": "Correct! Remove attacker's access immediately",
            "detailed": "Disabling the account: immediately prevents the attacker from using it again, is fast and reversible (low impact if wrong), and is the standard containment for compromised credentials. Reset the password too in case attacker tries to re-enable. Inform jsmith separately about the incident."
          }
        },
        {
          "id": "C",
          "text": "Email the user to change their password",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "Too slow and attacker might intercept",
            "detailed": "Asking the user to change their password: takes time (user might not see email immediately), attacker might intercept the email, and user might choose a weak password. Security team should force the credential change."
          }
        },
        {
          "id": "D",
          "text": "Wait until after the investigation to change anything",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "Leaves attacker with access during investigation",
            "detailed": "Investigation can take days or weeks. Leaving the attacker with valid credentials during that time is unacceptable risk. Contain the credential compromise immediately; you can still investigate how it was compromised."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "The attacker has working credentials. What removes their access fastest?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "Disable account + reset password = attacker loses access immediately. Fast, reversible, standard response to credential compromise."
        }
      ],
      "learning_note": "Credential compromise containment: disable account immediately (prevents use), reset password (invalidates any sessions), and review what the account accessed (scope the damage). This is fast, reversible, and removes attacker access. Communicate with the legitimate user separately."
    },
    {
      "id": "decision_4",
      "sequence": 4,
      "title": "Escalation and Communication",
      "narrative": "The ransomware has encrypted critical business data including customer financial records. Your initial assessment suggests customer data was likely accessed. It's 2 AM and you're the only responder currently engaged.",
      "question": "Who should you notify FIRST?",
      "options": [
        {
          "id": "A",
          "text": "Customers whose data may be affected",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "Too early and requires legal guidance",
            "detailed": "Customer notification is important but: you don't yet know the full scope, notification requirements have legal implications, and premature notification can cause unnecessary panic. Legal counsel should guide customer notification timing and content."
          }
        },
        {
          "id": "B",
          "text": "Your incident response lead/manager for escalation",
          "is_correct": true,
          "points": 10,
          "feedback": {
            "short": "Correct! Escalate to get appropriate resources and authority",
            "detailed": "Escalate to your IR lead: they can activate additional responders, have authority to make containment decisions, know who else needs to be notified (legal, executives), and can coordinate the broader response. Don't try to handle a major incident alone - escalate to get help."
          }
        },
        {
          "id": "C",
          "text": "The FBI to report the ransomware",
          "is_correct": false,
          "points": 4,
          "feedback": {
            "short": "Important but internal escalation comes first",
            "detailed": "Law enforcement notification is valuable but: your organization should decide through proper channels when to involve them, legal counsel may want to guide that conversation, and the FBI won't help with immediate containment. Internal escalation first."
          }
        },
        {
          "id": "D",
          "text": "No one until morning - avoid waking people at 2 AM",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "Major incidents require immediate escalation",
            "detailed": "Customer data breach + ransomware is a major incident requiring immediate executive awareness and potentially regulatory notification. Waiting until morning delays critical decisions and may violate notification requirements. Wake people up - that's what IR plans are for."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "This is a major incident. Who has authority to coordinate response and make decisions?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "Escalate to IR lead/management: they activate resources, have decision authority, and know notification requirements. Don't handle major incidents alone."
        }
      ],
      "learning_note": "Escalation chain for major incidents: your direct IR lead first, who escalates to appropriate executives, legal, and others. Benefits: gets you help, engages decision-makers, ensures notifications happen properly. Major incidents with customer data impact always require immediate escalation regardless of time."
    },
    {
      "id": "decision_5",
      "sequence": 5,
      "title": "Post-Incident Activity",
      "narrative": "The incident is resolved - systems are restored, credentials reset, and monitoring is enhanced. Management asks what the team should do next to prevent recurrence.",
      "question": "What is the MOST important post-incident activity?",
      "options": [
        {
          "id": "A",
          "text": "Identify and terminate the employee who clicked the phishing link",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "Blame-focused approach prevents learning",
            "detailed": "Focusing on blaming individuals: discourages reporting of security issues, doesn't address systemic problems (why did phishing succeed?), and creates a culture of fear. The question is 'why did our controls fail?' not 'who do we blame?'"
          }
        },
        {
          "id": "B",
          "text": "Conduct a blameless lessons learned review and implement improvements",
          "is_correct": true,
          "points": 10,
          "feedback": {
            "short": "Correct! Learn from incidents to prevent recurrence",
            "detailed": "Lessons learned review: document what happened (timeline, actions taken), identify what worked and what didn't (detection, response, communication), find systemic improvements (better controls, training, procedures), assign owners and track improvements, and share lessons (without blame). This turns a negative event into security improvement."
          }
        },
        {
          "id": "C",
          "text": "Move on - the incident is over",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "Misses the learning opportunity",
            "detailed": "Without lessons learned, you'll repeat mistakes. The same vulnerability, gap, or process failure that enabled this incident may enable the next one. Every incident is a learning opportunity - don't waste it."
          }
        },
        {
          "id": "D",
          "text": "Purchase more security tools",
          "is_correct": false,
          "points": 2,
          "feedback": {
            "short": "Tools aren't always the answer",
            "detailed": "The failure may have been process, training, or configuration - not lack of tools. Lessons learned should identify what actually failed. Sometimes tools are the answer, but that determination comes from analysis, not assumption."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "What IR phase focuses on learning and preventing recurrence?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "Lessons learned: blameless review of what happened, what worked, what didn't, and what improvements are needed. Turn incidents into security improvements."
        }
      ],
      "learning_note": "Post-incident lessons learned: conduct within 2 weeks while memory is fresh, blameless (focus on systems/processes, not individuals), document timeline and decisions, identify improvements, assign owners, and track completion. This phase transforms incidents from purely negative events into security program improvements."
    }
  ],
  
  "scoring": {
    "max_points": 50,
    "passing_score": 40,
    "passing_percentage": 80
  },
  
  "outcome_thresholds": {
    "proficient": {"min_score": 45, "title": "IR Fundamentals Proficient", "description": "Strong understanding of incident response basics."},
    "competent": {"min_score": 40, "title": "IR Fundamentals Competent", "description": "Adequate grasp of incident response concepts."},
    "developing": {"min_score": 30, "title": "IR Fundamentals Developing", "description": "Review incident response concepts further."},
    "needs_work": {"min_score": 0, "title": "Additional Study Needed", "description": "Significant review of IR required."}
  },
  
  "remediation_focus": [
    "Understanding the incident response lifecycle phases",
    "Knowing when and how to contain threats",
    "Evidence handling and order of volatility",
    "Communication and escalation during incidents"
  ],
  
  "next_steps": {
    "passed": "Return to D4-SIM-002 for full Incident Response scenario",
    "failed": "Review teaching modules and retry"
  },
  
  "metadata": {
    "version": "1.0",
    "created": "2024-02-13",
    "author": "Security+ Training System",
    "domain_alignment": "Domain 4: Security Operations",
    "prerequisite_for": ["D4-SIM-002"],
    "estimated_time": "20-25 minutes"
  }
}
