{
  "lesson_id": "D1-LESSON-008",
  "domain": 1,
  "title": "Change Management and Security",
  "subtitle": "Controlled Change: Preventing Outages and Security Incidents",
  "version": "2.0-enhanced",
  "objectives_covered": ["1.3"],
  "estimated_duration": "75-90 minutes (core: 45 min, labs: 30-45 min)",
  "difficulty": "intermediate",
  "prerequisites": ["D1-LESSON-001"],

  "skill_tree": {
    "position": {"domain": 1, "sequence": 8, "tier": "intermediate"},
    "prerequisites": [{"lesson_id": "D1-LESSON-001", "title": "Security Controls Fundamentals", "why_needed": "Change management is a managerial control"}],
    "unlocks": [{"lesson_id": "D5-LESSON-001", "title": "Security Governance", "connection": "Change management is part of governance"}],
    "builds_toward": ["CompTIA Security+ SY0-701", "ITIL Foundation", "Security governance frameworks"],
    "cascade_learning": {
      "this_lesson_establishes": ["Change management process flow", "CAB function", "Security impact assessment", "Rollback planning", "Configuration management"],
      "concepts_used_later": {"D5-LESSON-001": "Governance frameworks", "D5-LESSON-004": "Compliance requirements for change documentation"}
    }
  },

  "role_relevance": {
    "soc_analyst": {"relevance": "medium", "percentage_of_job": "15-25%", "daily_tasks": ["Review changes during incident investigation", "Correlate incidents with recent changes", "Verify emergency changes are documented"]},
    "incident_responder": {"relevance": "high", "percentage_of_job": "25-35%", "daily_tasks": ["Review change history during incidents", "Implement emergency security changes", "Document post-incident changes"]},
    "security_engineer": {"relevance": "critical", "percentage_of_job": "40-50%", "daily_tasks": ["Conduct security impact assessments", "Participate in CAB meetings", "Review changes for security implications", "Implement security-related changes"]},
    "grc_analyst": {"relevance": "critical", "percentage_of_job": "45-55%", "daily_tasks": ["Audit change management compliance", "Review change documentation", "Assess change control effectiveness", "Report on change metrics"]},
    "penetration_tester": {"relevance": "low", "percentage_of_job": "10-15%", "daily_tasks": ["Review change management for bypass opportunities", "Test change validation controls"]}
  },

  "introduction": {
    "hook": "In 2017, a routine network configuration change at a major US airline caused a massive IT outage that grounded 2,300 flights, stranded 75,000 passengers, and cost over $100 million. The root cause? A single contractor made an unauthorized change without following change management procedures. When the change failed, there was no rollback plan, no documentation, and no understanding of cascade effects. Change is inevitable—but uncontrolled change is the enemy of both availability and security.",
    "learning_goals": [
      "Explain why change management is critical for security and availability",
      "Apply formal change management processes including CAB approval",
      "Conduct security impact assessments for proposed changes",
      "Implement version control and rollback capabilities",
      "Distinguish between standard, normal, and emergency changes"
    ],
    "why_it_matters": {
      "career_impact": "You'll review change requests, participate in CAB meetings, and ensure rollback plans exist.",
      "business_connection": "Majority of IT outages involve recent changes. Proper change management prevents security misconfigurations.",
      "exam_relevance": "Expect 3-5 questions on processes, documentation, and security considerations."
    },
    "exam_weight": {"estimated_questions": "3-5", "high_yield_topics": ["RFC definition", "CAB function", "Change types (standard/normal/emergency)", "Configuration drift", "Rollback requirements"]}
  },

  "sections": [
    {
      "section_id": "D1-L008-S01",
      "title": "Change Management Fundamentals",
      "estimated_time": "15 minutes",
      "content": {
        "overview": "Change management is a systematic approach to controlling modifications to IT systems, ensuring changes are introduced in a controlled manner while minimizing risk.",
        "core_concepts": [
          {
            "concept": "Why Change Management Matters for Security",
            "reasons": [
              {"reason": "Configuration Drift", "explanation": "Systems gradually deviate from secure baselines without controlled changes"},
              {"reason": "Change-Related Incidents", "explanation": "Majority of IT outages involve recent changes"},
              {"reason": "Compliance Requirements", "explanation": "Regulations (SOX, PCI-DSS, HIPAA) require change documentation"}
            ]
          },
          {
            "concept": "Change Management Process",
            "steps": [
              {"step": "1. RFC (Request for Change)", "description": "Formal submission describing what, why, when, how"},
              {"step": "2. Impact Assessment", "description": "Analyze effects on systems, services, security"},
              {"step": "3. Approval", "description": "Review by CAB or appropriate authority"},
              {"step": "4. Implementation", "description": "Execute during approved window with rollback ready"},
              {"step": "5. Verification", "description": "Confirm change achieved objectives without issues"},
              {"step": "6. Closure", "description": "Document results, update configuration records"}
            ]
          },
          {
            "concept": "Types of Changes",
            "types": [
              {"type": "Standard", "description": "Pre-approved, low-risk, routine", "examples": "Password resets, scheduled patches", "approval": "Pre-approved via policy"},
              {"type": "Normal", "description": "Full change process", "examples": "New server deployment, firewall rule changes", "approval": "CAB approval required"},
              {"type": "Emergency", "description": "Bypass normal process for urgent issues", "examples": "Security incident response, critical outage", "approval": "Expedited approval, documented after"}
            ],
            "critical_point": "Emergency changes STILL require documentation—just reviewed after implementation"
          }
        ],
        "what_would_happen_if": {
          "scenario": "What if you didn't have change management?",
          "consequence": "Configuration drift occurs—systems gradually deviate from secure baselines. When incidents occur, you don't know what changed or when. Troubleshooting becomes impossible because there's no record of the current state. Compliance audits fail because you can't demonstrate controlled change."
        }
      },
      "memory_hooks": {
        "mnemonic": "RFC-AIVVC: Request, Assess, Implement, Verify, Verify, Close",
        "common_mistakes": [
          {"mistake": "Thinking emergency changes skip documentation", "correction": "Emergency changes still need documentation—just expedited approval and post-implementation review."},
          {"mistake": "Confusing standard and normal changes", "correction": "Standard = pre-approved routine. Normal = requires individual approval."}
        ]
      },
      "must_remember_for_exam": [
        {"fact": "RFC (Request for Change) starts the process", "why_tested": "Process trigger"},
        {"fact": "Standard changes are pre-approved; emergency changes bypass but still document", "why_tested": "Change type distinctions"},
        {"fact": "Configuration drift = systems deviating from baselines", "why_tested": "Key terminology"},
        {"fact": "CAB = Change Advisory Board (reviews/approves changes)", "why_tested": "Key role"}
      ],
      "key_points": ["Change management prevents outages and security incidents", "Process: RFC → Assessment → Approval → Implementation → Verification → Closure", "Standard = pre-approved; Normal = full process; Emergency = expedited", "Emergency changes still require documentation"],
      "knowledge_check": {
        "question": "An organization discovers a critical vulnerability being actively exploited. They need to implement a firewall rule immediately. What type of change is this?",
        "options": ["Standard change", "Normal change", "Emergency change", "Automated change"],
        "correct": 2,
        "explanation": "Emergency changes bypass normal approval for urgent security issues. Still documented, just reviewed after implementation.",
        "wrong_answer_analysis": [
          {"option": 0, "why_wrong": "Standard changes are routine and pre-approved, not urgent security responses"},
          {"option": 1, "why_wrong": "Normal changes follow full process—too slow for active exploitation"},
          {"option": 3, "why_wrong": "Automated changes are system-driven, not security responses"}
        ]
      }
    },
    {
      "section_id": "D1-L008-S02",
      "title": "Change Advisory Board (CAB) and Approval",
      "estimated_time": "12 minutes",
      "content": {
        "overview": "The CAB reviews and approves significant changes, providing cross-functional perspective on risk and impact.",
        "core_concepts": [
          {
            "concept": "CAB Composition",
            "members": [
              {"role": "IT Operations", "perspective": "Implementation feasibility, service impact"},
              {"role": "Security", "perspective": "Security impact, risk assessment"},
              {"role": "Business representatives", "perspective": "Business impact, timing"},
              {"role": "Application owners", "perspective": "Application-specific concerns"}
            ]
          },
          {
            "concept": "Security Impact Assessment",
            "questions": [
              "Does this change affect security controls?",
              "Does it introduce new vulnerabilities?",
              "Does it affect access controls or authentication?",
              "Does it affect compliance requirements?",
              "What's the risk if the change fails?"
            ]
          },
          {
            "concept": "Separation of Duties",
            "principle": "Different people for different roles in change process",
            "roles": [
              "Requester (proposes change)",
              "Approver (authorizes change)",
              "Implementer (executes change)",
              "Verifier (confirms success)"
            ],
            "purpose": "Prevents single person from pushing unauthorized changes through"
          }
        ]
      },
      "must_remember_for_exam": [
        {"fact": "CAB = Change Advisory Board", "why_tested": "Key terminology"},
        {"fact": "CAB should include security representation", "why_tested": "Security involvement"},
        {"fact": "Separation of duties: different people for request, approval, implementation", "why_tested": "Control principle"}
      ],
      "key_points": ["CAB is cross-functional: IT, Security, Business, App owners", "Security must participate in change review", "Separation of duties prevents unauthorized changes"],
      "knowledge_check": {
        "question": "Why should security be represented on the Change Advisory Board?",
        "options": ["To slow down changes", "To evaluate security impact of changes", "To implement emergency patches", "To manage change documentation"],
        "correct": 1,
        "explanation": "Security representation ensures changes are evaluated for security impact, preventing misconfigurations that create vulnerabilities.",
        "wrong_answer_analysis": [
          {"option": 0, "why_wrong": "Security's role is assessment, not obstruction"},
          {"option": 2, "why_wrong": "Implementation is separate from CAB review"},
          {"option": 3, "why_wrong": "Documentation is administrative, not security's primary CAB role"}
        ]
      }
    },
    {
      "section_id": "D1-L008-S03",
      "title": "Rollback and Recovery Planning",
      "estimated_time": "10 minutes",
      "content": {
        "overview": "Every significant change needs a rollback plan—a documented procedure to reverse the change if it fails or causes problems.",
        "core_concepts": [
          {
            "concept": "Rollback Plan Components",
            "components": [
              {"component": "Trigger criteria", "description": "When to decide to roll back"},
              {"component": "Rollback procedure", "description": "Step-by-step reversal process"},
              {"component": "Time limit", "description": "Point of no return for rollback"},
              {"component": "Responsibilities", "description": "Who makes rollback decision"},
              {"component": "Communication plan", "description": "Who to notify during rollback"}
            ]
          },
          {
            "concept": "Configuration Baselines",
            "definition": "Documented, known-good configuration state",
            "purpose": [
              "Provides target for rollback",
              "Enables drift detection",
              "Supports compliance verification"
            ]
          },
          {
            "concept": "Version Control",
            "applications": [
              "Infrastructure as Code (Terraform, CloudFormation)",
              "Security tool configurations",
              "Firewall rule sets",
              "Application configurations"
            ],
            "benefit": "Enables precise rollback to any previous state"
          }
        ]
      },
      "must_remember_for_exam": [
        {"fact": "Rollback plan required for significant changes", "why_tested": "Change management requirement"},
        {"fact": "Rollback plan includes: criteria, procedure, time limit, responsibilities", "why_tested": "Plan components"},
        {"fact": "Configuration baseline = documented known-good state", "why_tested": "Key terminology"}
      ],
      "key_points": ["Every significant change needs a rollback plan", "Rollback includes criteria, procedure, time limit, responsibilities", "Configuration baselines enable drift detection and rollback"],
      "knowledge_check": {
        "question": "A change fails during implementation. What determines whether to roll back?",
        "options": ["CAB vote", "Pre-defined rollback criteria", "Manager approval", "Time elapsed"],
        "correct": 1,
        "explanation": "Pre-defined rollback criteria (part of the rollback plan) specify what conditions trigger rollback, enabling quick decisions during incidents.",
        "wrong_answer_analysis": [
          {"option": 0, "why_wrong": "CAB meeting during implementation is too slow"},
          {"option": 2, "why_wrong": "Waiting for manager delays response"},
          {"option": 3, "why_wrong": "Time alone doesn't indicate failure"}
        ]
      }
    },
    {
      "section_id": "D1-L008-S04",
      "title": "Change Documentation and Compliance",
      "estimated_time": "10 minutes",
      "content": {
        "overview": "Change documentation supports security, compliance, and operational needs.",
        "core_concepts": [
          {
            "concept": "Documentation Requirements",
            "requirements": [
              "What was changed",
              "Why it was changed",
              "Who approved it",
              "Who implemented it",
              "When it was implemented",
              "What testing was performed",
              "What the results were"
            ]
          },
          {
            "concept": "Compliance Implications",
            "frameworks": [
              {"framework": "PCI-DSS", "requirement": "Documented change control procedures"},
              {"framework": "SOX", "requirement": "Audit trail for system changes"},
              {"framework": "HIPAA", "requirement": "Configuration management"}
            ]
          },
          {
            "concept": "CMDB (Configuration Management Database)",
            "definition": "Central repository tracking all configuration items",
            "updates": "Must be updated when changes are implemented",
            "purpose": "Provides accurate current state documentation"
          }
        ]
      },
      "must_remember_for_exam": [
        {"fact": "Change documentation required for compliance (PCI-DSS, SOX, HIPAA)", "why_tested": "Compliance linkage"},
        {"fact": "CMDB = Configuration Management Database", "why_tested": "Terminology"},
        {"fact": "Documentation includes: what, why, who approved, who implemented, when, testing, results", "why_tested": "Documentation components"}
      ],
      "key_points": ["Documentation supports security, compliance, and operations", "Compliance frameworks require change documentation", "CMDB tracks configuration items and must be updated with changes"]
    }
  ],

  "hands_on_labs": {
    "browser_labs": [
      {"lab_id": "lab-rfc-review", "title": "RFC Security Assessment", "type": "scenario_quiz", "description": "Review RFC submissions and identify security concerns"},
      {"lab_id": "lab-rollback-design", "title": "Rollback Plan Designer", "type": "template_exercise", "description": "Create rollback plans for common change scenarios"}
    ],
    "external_labs": [
      {"resource": "ITIL Foundation", "description": "Industry-standard change management framework"}
    ]
  },

  "summary": {
    "key_takeaways": [
      "Change management controls modifications to prevent outages and security incidents",
      "Process: RFC → Impact Assessment → Approval → Implementation → Verification → Closure",
      "Standard = pre-approved routine; Normal = full process; Emergency = expedited but documented",
      "CAB is cross-functional and includes security representation",
      "Every significant change needs a rollback plan",
      "Configuration baselines enable drift detection and compliance"
    ],
    "exam_essentials": [
      "RFC (Request for Change) starts the process",
      "CAB = Change Advisory Board",
      "Emergency changes still require documentation",
      "Configuration drift = deviation from baseline",
      "Separation of duties: different people for request, approval, implementation",
      "Rollback plan includes criteria, procedure, time limit"
    ]
  },

  "related_content": {
    "simulations": ["D1-SIM-005"],
    "remediation": ["D1-REM-001"],
    "next_lesson": "D2-LESSON-001",
    "previous_lesson": "D1-LESSON-007"
  }
}
