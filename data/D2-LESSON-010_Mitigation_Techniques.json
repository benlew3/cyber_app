{
  "lesson_id": "D2-LESSON-010",
  "domain": 2,
  "title": "Mitigation Techniques",
  "subtitle": "Defensive Strategies Against Common Attacks",
  "version": "2.0-enhanced",
  "objectives_covered": ["2.5"],
  "estimated_duration": "75-90 minutes",
  "difficulty": "intermediate",
  "prerequisites": ["D2-LESSON-005", "D2-LESSON-006"],

  "skill_tree": {
    "position": {"domain": 2, "sequence": 10, "tier": "intermediate"},
    "prerequisites": [
      {"lesson_id": "D2-LESSON-005", "title": "Network Attacks", "why_needed": "Understand attacks to mitigate"},
      {"lesson_id": "D2-LESSON-006", "title": "Application Attacks", "why_needed": "Understand attacks to mitigate"}
    ],
    "unlocks": [{"lesson_id": "D3-LESSON-003", "title": "Network Security", "connection": "Network defense implementations"}]
  },

  "role_relevance": {
    "soc_analyst": {"relevance": "high", "percentage_of_job": "30-40%", "daily_tasks": ["Recommend mitigations", "Verify controls working"]},
    "security_engineer": {"relevance": "critical", "percentage_of_job": "55-65%", "daily_tasks": ["Implement mitigations", "Configure defenses"]},
    "incident_responder": {"relevance": "high", "percentage_of_job": "35-45%", "daily_tasks": ["Apply emergency mitigations", "Contain attacks"]},
    "penetration_tester": {"relevance": "high", "percentage_of_job": "30-40%", "daily_tasks": ["Test mitigation effectiveness"]}
  },

  "introduction": {
    "hook": "Every attack has a countermeasure. Understanding how to mitigate specific attack typesâ€”from network segmentation to input validationâ€”is essential for building effective defenses.",
    "exam_weight": {"estimated_questions": "5-7", "high_yield_topics": ["Network segmentation", "Patch management", "Access control", "Encryption"]}
  },

  "sections": [
    {
      "section_id": "D2-L010-S01",
      "title": "Network Attack Mitigations",
      "estimated_time": "15 minutes",
      "content": {
        "core_concepts": [
          {
            "concept": "Network Segmentation",
            "definition": "Dividing network into isolated segments",
            "benefits": ["Limits lateral movement", "Contains breaches", "Enables granular control"],
            "implementation": ["VLANs", "Firewalls", "Microsegmentation"]
          },
          {
            "concept": "DoS/DDoS Mitigations",
            "mitigations": [
              {"mitigation": "Rate limiting", "purpose": "Restrict requests per source"},
              {"mitigation": "DDoS protection services", "purpose": "Absorb volumetric attacks"},
              {"mitigation": "SYN cookies", "purpose": "Defend against SYN floods"},
              {"mitigation": "Anycast", "purpose": "Distribute traffic across locations"}
            ]
          },
          {
            "concept": "MITM Mitigations",
            "mitigations": [
              {"mitigation": "Encryption (TLS)", "purpose": "Prevent eavesdropping"},
              {"mitigation": "Certificate validation", "purpose": "Verify identity"},
              {"mitigation": "HSTS", "purpose": "Force HTTPS"},
              {"mitigation": "Dynamic ARP inspection", "purpose": "Prevent ARP poisoning"}
            ]
          }
        ]
      },
      "must_remember_for_exam": [
        {"fact": "Network segmentation limits lateral movement", "why_tested": "Key defense"},
        {"fact": "SYN cookies defend against SYN floods", "why_tested": "Specific mitigation"},
        {"fact": "HSTS forces HTTPS, prevents SSL stripping", "why_tested": "Web security"},
        {"fact": "Dynamic ARP inspection prevents ARP poisoning", "why_tested": "Network defense"}
      ],
      "key_points": ["Segmentation contains breaches", "SYN cookies defend SYN floods", "HSTS prevents SSL stripping", "DAI prevents ARP poisoning"]
    },
    {
      "section_id": "D2-L010-S02",
      "title": "Application Attack Mitigations",
      "estimated_time": "12 minutes",
      "content": {
        "core_concepts": [
          {
            "concept": "Injection Mitigations",
            "sql_injection": ["Parameterized queries", "Input validation", "Least privilege DB accounts"],
            "command_injection": ["Avoid shell commands", "Input validation", "Whitelisting"],
            "xss": ["Output encoding", "CSP", "HttpOnly cookies"]
          },
          {
            "concept": "Access Control Mitigations",
            "controls": [
              {"control": "Least privilege", "purpose": "Minimum necessary access"},
              {"control": "MFA", "purpose": "Additional authentication factor"},
              {"control": "Session management", "purpose": "Secure session handling"},
              {"control": "Account lockout", "purpose": "Prevent brute force"}
            ]
          }
        ]
      },
      "must_remember_for_exam": [
        {"fact": "Parameterized queries prevent SQL injection", "why_tested": "Primary defense"},
        {"fact": "Output encoding prevents XSS", "why_tested": "Primary defense"},
        {"fact": "MFA mitigates credential attacks", "why_tested": "Authentication"},
        {"fact": "Least privilege limits damage from compromise", "why_tested": "Access control"}
      ],
      "key_points": ["Parameterized queries for SQLi", "Output encoding for XSS", "MFA for authentication", "Least privilege everywhere"]
    },
    {
      "section_id": "D2-L010-S03",
      "title": "General Mitigation Strategies",
      "estimated_time": "10 minutes",
      "content": {
        "core_concepts": [
          {
            "concept": "Patch Management",
            "importance": "Fix known vulnerabilities before exploitation",
            "process": ["Inventory assets", "Monitor for patches", "Test patches", "Deploy patches", "Verify deployment"]
          },
          {
            "concept": "Defense in Depth",
            "definition": "Multiple layers of security controls",
            "principle": "No single control is perfect; layers compensate for individual failures"
          },
          {
            "concept": "Security Monitoring",
            "components": ["Log collection", "SIEM correlation", "Alerting", "Incident response"]
          }
        ]
      },
      "must_remember_for_exam": [
        {"fact": "Patch management fixes known vulnerabilities", "why_tested": "Essential process"},
        {"fact": "Defense in depth = multiple layers", "why_tested": "Core principle"}
      ]
    }
  ],

  "summary": {
    "exam_essentials": [
      "Network segmentation limits lateral movement",
      "Parameterized queries prevent SQL injection",
      "Output encoding prevents XSS",
      "MFA mitigates credential compromise",
      "Patch management fixes known vulnerabilities",
      "Defense in depth = multiple layers"
    ]
  },

  "related_content": {
    "next_lesson": "D2-LESSON-011",
    "previous_lesson": "D2-LESSON-009"
  }
}
