{
  "lesson_id": "D2-LESSON-008",
  "domain": 2,
  "title": "Indicators of Compromise and Detection",
  "subtitle": "Finding Evil: IOCs, IOAs, and Threat Detection",
  "version": "2.0-enhanced",
  "objectives_covered": ["2.4"],
  "estimated_duration": "75-90 minutes",
  "difficulty": "intermediate",
  "prerequisites": ["D2-LESSON-004"],

  "skill_tree": {
    "position": {"domain": 2, "sequence": 8, "tier": "intermediate"},
    "prerequisites": [{"lesson_id": "D2-LESSON-004", "title": "Malware Types", "why_needed": "Understand what creates indicators"}],
    "unlocks": [{"lesson_id": "D4-LESSON-001", "title": "Security Monitoring", "connection": "Detection in SOC operations"}]
  },

  "role_relevance": {
    "soc_analyst": {"relevance": "critical", "percentage_of_job": "60-70%", "daily_tasks": ["Hunt for IOCs", "Analyze indicators", "Correlate events"]},
    "incident_responder": {"relevance": "critical", "percentage_of_job": "55-65%", "daily_tasks": ["Identify compromise indicators", "Track attacker activity", "Document findings"]},
    "security_engineer": {"relevance": "high", "percentage_of_job": "30-40%", "daily_tasks": ["Implement detection rules", "Configure alerting"]},
    "penetration_tester": {"relevance": "medium", "percentage_of_job": "25-35%", "daily_tasks": ["Understand detection capabilities", "Evade indicators"]}
  },

  "introduction": {
    "hook": "When SolarWinds was compromised, security teams worldwide scrambled to find indicators of compromise in their environments. Knowing what to look for—and finding it before damage is done—is the essence of threat detection.",
    "exam_weight": {"estimated_questions": "4-6", "high_yield_topics": ["IOC vs IOA", "Common indicators", "Detection methods"]}
  },

  "sections": [
    {
      "section_id": "D2-L008-S01",
      "title": "Indicators of Compromise (IOCs)",
      "estimated_time": "15 minutes",
      "content": {
        "core_concepts": [
          {
            "concept": "IOC Definition",
            "definition": "Evidence that a security incident may have occurred",
            "note": "Forensic artifacts left by attackers"
          },
          {
            "concept": "Common IOC Types",
            "types": [
              {"type": "File-based", "examples": "Malware hashes (MD5, SHA256), malicious filenames"},
              {"type": "Network-based", "examples": "Malicious IPs, domains, URLs, unusual ports"},
              {"type": "Host-based", "examples": "Registry changes, unusual processes, scheduled tasks"},
              {"type": "Behavioral", "examples": "Unusual login times, data exfiltration patterns"}
            ]
          },
          {
            "concept": "IOC vs IOA",
            "ioc": "Indicator of Compromise - evidence breach occurred (reactive)",
            "ioa": "Indicator of Attack - evidence attack is occurring (proactive)",
            "key_difference": "IOC = what happened; IOA = what's happening"
          }
        ]
      },
      "must_remember_for_exam": [
        {"fact": "IOC = evidence of past compromise", "why_tested": "Definition"},
        {"fact": "IOA = evidence of ongoing attack", "why_tested": "Definition"},
        {"fact": "Common IOCs: hashes, IPs, domains, registry changes", "why_tested": "Types"},
        {"fact": "IOCs are reactive; IOAs enable proactive detection", "why_tested": "Distinction"}
      ],
      "key_points": ["IOC = evidence of compromise (reactive)", "IOA = evidence of attack in progress (proactive)", "Types: file-based, network-based, host-based, behavioral"]
    },
    {
      "section_id": "D2-L008-S02",
      "title": "Detection Methods",
      "estimated_time": "12 minutes",
      "content": {
        "core_concepts": [
          {
            "concept": "Detection Approaches",
            "approaches": [
              {"approach": "Signature-based", "method": "Match known bad patterns", "strength": "Fast, low false positives", "weakness": "Misses unknown threats"},
              {"approach": "Anomaly-based", "method": "Detect deviations from baseline", "strength": "Can find unknown threats", "weakness": "Higher false positives"},
              {"approach": "Behavior-based", "method": "Identify suspicious behaviors", "strength": "Detects evasive malware", "weakness": "Requires tuning"},
              {"approach": "Heuristic", "method": "Rules-based analysis", "strength": "Balances detection methods", "weakness": "May miss novel attacks"}
            ]
          },
          {
            "concept": "Threat Hunting",
            "definition": "Proactively searching for threats that evaded detection",
            "method": "Hypothesis-driven investigation using IOCs and behavioral analysis",
            "key": "Assumes breach—looks for evidence of compromise"
          }
        ]
      },
      "must_remember_for_exam": [
        {"fact": "Signature-based = match known patterns (fast, misses unknown)", "why_tested": "Detection method"},
        {"fact": "Anomaly-based = detect deviations (finds unknown, higher FP)", "why_tested": "Detection method"},
        {"fact": "Threat hunting = proactive search assuming breach", "why_tested": "Concept"}
      ],
      "key_points": ["Signature = known patterns; Anomaly = baseline deviations", "Behavior-based detects evasive techniques", "Threat hunting proactively searches for hidden threats"]
    }
  ],

  "summary": {
    "exam_essentials": [
      "IOC = evidence of compromise (reactive)",
      "IOA = evidence of ongoing attack (proactive)",
      "Signature-based = known patterns, fast, misses unknown",
      "Anomaly-based = baseline deviations, finds unknown, more FPs",
      "Threat hunting = proactive search assuming breach"
    ]
  },

  "related_content": {
    "next_lesson": "D2-LESSON-009",
    "previous_lesson": "D2-LESSON-007"
  }
}
