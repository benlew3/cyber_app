{
  "lesson_id": "D2-LESSON-007",
  "domain": 2,
  "title": "Vulnerability Management",
  "subtitle": "Finding and Fixing Weaknesses Before Attackers Do",
  "version": "2.0-enhanced",
  "objectives_covered": [
    "2.3"
  ],
  "estimated_duration": "90-120 minutes",
  "difficulty": "intermediate",
  "prerequisites": [
    "D2-LESSON-006"
  ],
  "skill_tree": {
    "position": {
      "domain": 2,
      "sequence": 7,
      "tier": "intermediate"
    },
    "prerequisites": [
      {
        "lesson_id": "D2-LESSON-006",
        "title": "Application Attacks",
        "why_needed": "Understand vulnerabilities being scanned"
      }
    ],
    "unlocks": [
      {
        "lesson_id": "D4-LESSON-003",
        "title": "Vulnerability Management (Operations)",
        "connection": "Operational vulnerability processes"
      }
    ]
  },
  "role_relevance": {
    "soc_analyst": {
      "relevance": "high",
      "percentage_of_job": "25-35%",
      "daily_tasks": [
        "Review vulnerability alerts",
        "Prioritize findings",
        "Track remediation"
      ]
    },
    "security_engineer": {
      "relevance": "critical",
      "percentage_of_job": "40-50%",
      "daily_tasks": [
        "Configure scanners",
        "Analyze results",
        "Coordinate patching"
      ]
    },
    "grc_analyst": {
      "relevance": "high",
      "percentage_of_job": "35-45%",
      "daily_tasks": [
        "Report on vulnerability metrics",
        "Track compliance",
        "Manage risk acceptance"
      ]
    },
    "penetration_tester": {
      "relevance": "critical",
      "percentage_of_job": "50-60%",
      "daily_tasks": [
        "Validate scan findings",
        "Discover additional vulnerabilities"
      ]
    }
  },
  "introduction": {
    "hook": "The 2017 Equifax breach exploited a vulnerability that had a patch available for two months. 147 million records exposed because of poor vulnerability management. Finding vulnerabilities is only half the battleâ€”you must also fix them in time.",
    "exam_weight": {
      "estimated_questions": "5-7",
      "high_yield_topics": [
        "CVSS scoring",
        "Vulnerability types",
        "Scanning vs assessment vs penetration test",
        "Zero-day definition"
      ]
    },
    "learning_goals": [
      "Explain the complete vulnerability management lifecycle",
      "Differentiate between vulnerability scanning, penetration testing, and red team exercises",
      "Prioritize vulnerabilities using CVSS scores and risk-based approaches",
      "Develop remediation strategies aligned with organizational risk tolerance"
    ],
    "why_it_matters": {
      "career_impact": "Vulnerability management is a core security function present in every mature organization. Security analysts run scans, prioritize findings, and track remediation - skills used daily in most security roles.",
      "business_connection": "60% of breaches involve known, unpatched vulnerabilities. Effective vulnerability management programs directly reduce breach likelihood and demonstrate due diligence to auditors and regulators.",
      "exam_relevance": "Expect 4-6 questions on vulnerability management. Focus areas: scan types and tools, CVSS scoring components, remediation prioritization, false positive handling, and responsible disclosure."
    }
  },
  "sections": [
    {
      "section_id": "D2-L007-S01",
      "title": "Vulnerability Fundamentals",
      "estimated_time": "12 minutes",
      "content": "Vulnerabilities represent weaknesses in systems, applications, configurations, or processes that could be exploited to compromise security. Understanding the vulnerability ecosystem is critical for effective security operations.\n\n**Types of Vulnerabilities:**\n\n*Software Vulnerabilities* arise from coding errors, design flaws, or implementation mistakes. Buffer overflows occur when programs write data beyond allocated memory boundaries. Integer overflows happen when arithmetic operations exceed data type limits. Race conditions emerge when timing dependencies create exploitable windows. Use-after-free vulnerabilities occur when programs access memory after it's been deallocated.\n\n*Configuration Vulnerabilities* result from insecure settings rather than code flaws. Default credentials left unchanged provide easy access. Overly permissive access controls grant unnecessary privileges. Disabled security features remove protective barriers. Missing patches leave known vulnerabilities unaddressed. Exposed management interfaces provide attack entry points.\n\n*Architectural Vulnerabilities* stem from design decisions. Single points of failure create availability risks. Missing segmentation allows lateral movement. Inadequate logging prevents detection. Weak trust boundaries enable privilege escalation.\n\n*Zero-Day Vulnerabilities* are unknown to vendors and have no available patches. They command premium prices in underground markets ($50,000-$2.5M depending on target). Nation-states stockpile zero-days for offensive operations. The window between discovery and patch availability is the danger zone.\n\n**Vulnerability Lifecycle:**\n1. Introduction - Vulnerability created during development\n2. Discovery - Found by researcher, attacker, or vendor\n3. Disclosure - Reported (responsible) or exploited (malicious)\n4. Patch Development - Vendor creates fix\n5. Patch Release - Fix made available\n6. Patch Deployment - Organizations apply fix\n7. Exploitation Window - Gap between disclosure and deployment",
      "must_remember_for_exam": [
        {
          "fact": "Zero-day = no patch available, 0 days to prepare",
          "why_tested": "Definition"
        },
        {
          "fact": "CVSS 9.0-10.0 = Critical, 7.0-8.9 = High",
          "why_tested": "Scoring"
        },
        {
          "fact": "CVE = standardized vulnerability identifier",
          "why_tested": "Terminology"
        }
      ],
      "key_points": [
        "Zero-day has no patch; CVSS rates severity 0-10",
        "CVE provides standardized vulnerability IDs",
        "Critical = 9.0-10.0, High = 7.0-8.9"
      ],
      "exam_tips": [
        "Vulnerability scan identifies; Penetration test exploits",
        "CVSS provides standardized severity scoring (0-10)"
      ],
      "knowledge_check": {
        "question": "What is a vulnerability in the context of security?",
        "options": [
          "A malicious actor attempting to breach systems",
          "A weakness that could be exploited to compromise security",
          "An attack that has already succeeded",
          "A security control that is too expensive"
        ],
        "correct_answer": 1,
        "explanation": "A vulnerability is a weakness in a system, process, or control that could be exploited."
      },
      "memory_hooks": {
        "mnemonics": [
          "Vulnerability = Weakness; Threat = Actor; Risk = Weakness x Threat x Impact"
        ],
        "analogies": [
          "Vulnerability is unlocked window. Threat is burglar. Risk is chance of being robbed."
        ],
        "common_mistakes": [
          "Confusing vulnerabilities with threats or risks"
        ]
      },
      "deep_dive": [
        {
          "title": "CVE and Vulnerability Databases",
          "content": "The Common Vulnerabilities and Exposures (CVE) system provides standardized identifiers for publicly known vulnerabilities. CVE-YYYY-NNNNN format includes year and sequential number. The National Vulnerability Database (NVD) enriches CVEs with CVSS scores, affected products (CPE), and references. MITRE maintains the CVE list while NIST operates NVD. Other databases include VulnDB (commercial, comprehensive), Exploit-DB (proof-of-concept exploits), and vendor-specific advisories."
        },
        {
          "title": "CVSS Scoring Deep Dive",
          "content": "CVSS 3.1 Base Score components: Attack Vector (Network/Adjacent/Local/Physical), Attack Complexity (Low/High), Privileges Required (None/Low/High), User Interaction (None/Required), Scope (Unchanged/Changed), and CIA Impact (None/Low/High each). A network-accessible, low-complexity, no-auth-required vulnerability with high CIA impact scores 9.8-10.0 (Critical). Environmental scores adjust for your specific context - a critical vulnerability on an isolated test system may be lower actual risk than a medium vulnerability on your payment processing server."
        }
      ],
      "career_spotlight": {
        "role": "Vulnerability Analyst",
        "daily_tasks": [
          "Reviewing scan results and prioritizing findings",
          "Researching vulnerability details and exploit availability",
          "Coordinating remediation with system owners",
          "Tracking remediation progress and SLA compliance",
          "Creating vulnerability metrics and trend reports"
        ],
        "tools_used": [
          "Tenable Nessus/SC",
          "Qualys",
          "Rapid7 InsightVM",
          "NVD/CVE databases",
          "Exploit-DB"
        ],
        "career_path": "Vulnerability Analyst → Senior Analyst → Vulnerability Management Lead → Security Engineering Manager"
      },
      "real_world_example": {
        "title": "Log4Shell (CVE-2021-44228) - The Vulnerability That Shook the Internet",
        "incident": "In December 2021, a critical vulnerability in Apache Log4j (CVSS 10.0) allowed remote code execution via specially crafted log messages. The ubiquity of Log4j meant millions of applications were vulnerable.",
        "impact": "Affected organizations worldwide including Apple, Amazon, Twitter, Cloudflare, and countless enterprise applications. Exploitation began within hours of disclosure.",
        "lesson": "Software composition analysis (SCA) is critical - you can't patch what you don't know you have. Log4Shell exposed how poorly most organizations track their software dependencies."
      },
      "glossary_terms": [
        {
          "term": "CVE",
          "definition": "Common Vulnerabilities and Exposures - standardized identifier for publicly known security vulnerabilities",
          "exam_note": "Know the CVE-YYYY-NNNNN format"
        },
        {
          "term": "CVSS",
          "definition": "Common Vulnerability Scoring System - standardized framework for rating vulnerability severity (0-10 scale)",
          "exam_note": "Understand Base, Temporal, and Environmental score groups"
        },
        {
          "term": "Zero-Day",
          "definition": "A vulnerability unknown to the vendor with no available patch",
          "exam_note": "Zero-day = unknown to vendor; zero-day exploit = active exploitation of unknown vulnerability"
        },
        {
          "term": "NVD",
          "definition": "National Vulnerability Database - U.S. government repository of vulnerability data enriched with CVSS scores",
          "exam_note": "NVD is maintained by NIST and enriches CVE data"
        }
      ]
    },
    {
      "section_id": "D2-L007-S02",
      "title": "Vulnerability Assessment Methods",
      "estimated_time": "12 minutes",
      "content": "Vulnerability assessment encompasses multiple techniques to identify security weaknesses before attackers exploit them.\n\n**Vulnerability Scanning**\n\n*Credentialed Scans* authenticate to target systems, enabling deeper inspection. They can enumerate installed software, check configurations, verify patch levels, and assess local vulnerabilities. Accuracy is significantly higher - typically 80-90% fewer false positives than non-credentialed scans. Requires service accounts with appropriate read access.\n\n*Non-Credentialed Scans* probe systems externally, identifying what an attacker would see. They detect network-accessible vulnerabilities, open ports, exposed services, and banner information. Useful for external attack surface assessment but miss internal vulnerabilities.\n\n*Agent-Based Scanning* deploys lightweight agents on endpoints for continuous assessment. Agents report vulnerability data to central console without network scanning. Ideal for mobile devices, remote workers, and systems behind firewalls. Examples: Qualys Cloud Agent, Tenable Agent.\n\n*Passive Scanning* monitors network traffic to identify vulnerable systems without active probing. Detects applications, versions, and potential vulnerabilities from observed traffic. No impact on systems but limited to what traverses monitored network segments.\n\n**Scan Scheduling and Scope:**\n- Production systems: Weekly scans during maintenance windows\n- Critical assets: Daily or continuous scanning\n- New deployments: Pre-production scan required\n- Compliance: Quarterly minimum for PCI-DSS, often monthly\n- Full authenticated scans: Monthly comprehensive sweeps\n\n**Application Security Testing:**\n\n*Static Application Security Testing (SAST)* analyzes source code without execution. Identifies coding flaws, insecure functions, hardcoded credentials. Integrates into CI/CD pipelines for shift-left security. High false positive rates require developer triage.\n\n*Dynamic Application Security Testing (DAST)* tests running applications by sending malicious inputs. Simulates attacker behavior against live applications. Finds runtime vulnerabilities SAST cannot detect. Lower false positive rate but requires running application.\n\n*Interactive Application Security Testing (IAST)* combines SAST and DAST using instrumentation agents. Monitors application during testing for real-time analysis. Higher accuracy than SAST or DAST alone. Requires test environment with instrumentation.\n\n*Software Composition Analysis (SCA)* identifies third-party and open-source components. Maps dependencies to known vulnerabilities. Critical after Log4Shell demonstrated supply chain risks. Examples: Snyk, Black Duck, WhiteSource.",
      "must_remember_for_exam": [
        {
          "fact": "Vulnerability scan = automated check; Pentest = actual exploitation",
          "why_tested": "Method distinction"
        },
        {
          "fact": "Credentialed scans are more accurate than non-credentialed",
          "why_tested": "Scan comparison"
        },
        {
          "fact": "False positive = reported but doesn't exist; False negative = exists but not found",
          "why_tested": "Terminology"
        }
      ],
      "key_points": [
        "Scan (automated) vs Assessment (analyzed) vs Pentest (exploited)",
        "Credentialed scans see more, are more accurate",
        "False positive = reported incorrectly; False negative = missed"
      ],
      "exam_tips": [
        "Least privilege: minimum access needed to do the job",
        "Separation of duties: prevent single person from having too much control"
      ],
      "knowledge_check": {
        "question": "What is the key difference between vulnerability scanning and penetration testing?",
        "options": [
          "Scanning is automated; penetration testing is always manual",
          "Scanning identifies vulnerabilities; penetration testing attempts exploitation",
          "Penetration testing is cheaper than scanning",
          "Scanning requires more technical skill"
        ],
        "correct_answer": 1,
        "explanation": "Vulnerability scanning identifies potential weaknesses. Penetration testing attempts exploitation to prove real-world risk."
      },
      "memory_hooks": {
        "mnemonics": [
          "SCAP: Scan, Check, Audit, Pentest"
        ],
        "analogies": [
          "Scanning is home inspection checklist. Pentesting is hiring someone to try to break in."
        ],
        "common_mistakes": [
          "Treating vulnerability scan results as penetration test results"
        ]
      },
      "deep_dive": [
        {
          "title": "Scan Configuration Best Practices",
          "content": "Effective scanning requires careful configuration: Use credentialed scans whenever possible for accuracy. Exclude fragile systems (medical devices, legacy ICS) or scan during maintenance. Configure appropriate scan intensity - aggressive scans can crash unstable systems. Maintain scan credentials securely in vault solutions. Validate scan coverage regularly - new subnets and systems may not be included. Use scan templates aligned with compliance requirements (PCI ASV scans have specific requirements)."
        },
        {
          "title": "False Positive Management",
          "content": "False positives waste remediation effort and erode trust in scanning programs. Strategies: Tune scanner plugins based on your environment. Implement validation workflows before assigning remediation. Use credentialed scans to reduce banner-based false positives. Maintain exception lists for known false positives with documented justification and expiration dates. Track false positive rates as a scanner effectiveness metric. Consider multiple scanner correlation for high-confidence findings."
        }
      ],
      "career_spotlight": {
        "role": "Application Security Engineer",
        "daily_tasks": [
          "Running and tuning SAST/DAST scans",
          "Triaging application security findings",
          "Working with developers to remediate vulnerabilities",
          "Integrating security tools into CI/CD pipelines",
          "Conducting security architecture reviews"
        ],
        "tools_used": [
          "Checkmarx",
          "Veracode",
          "SonarQube",
          "Burp Suite",
          "OWASP ZAP",
          "Snyk"
        ],
        "career_path": "Developer → AppSec Engineer → Senior AppSec → Application Security Architect"
      },
      "real_world_example": {
        "title": "Equifax Breach (2017) - When Scanning Isn't Enough",
        "incident": "Equifax's vulnerability scanner identified the Apache Struts vulnerability (CVE-2017-5638) but the finding wasn't remediated. Attackers exploited the unpatched system for 78 days, exfiltrating 147 million records.",
        "impact": "$1.4 billion in breach costs, CEO resignation, Congressional hearings, and lasting reputation damage.",
        "lesson": "Scanning finds vulnerabilities; remediation fixes them. Without effective patch management processes and accountability, scanning provides false confidence."
      },
      "glossary_terms": [
        {
          "term": "SAST",
          "definition": "Static Application Security Testing - analyzes source code for vulnerabilities without executing the application",
          "exam_note": "SAST = source code analysis, finds bugs early but high false positives"
        },
        {
          "term": "DAST",
          "definition": "Dynamic Application Security Testing - tests running applications by simulating attacks",
          "exam_note": "DAST = runtime testing, lower false positives but requires running app"
        },
        {
          "term": "SCA",
          "definition": "Software Composition Analysis - identifies third-party components and their known vulnerabilities",
          "exam_note": "SCA critical for supply chain security and open-source risk"
        },
        {
          "term": "Credentialed Scan",
          "definition": "Vulnerability scan that authenticates to target systems for deeper inspection",
          "exam_note": "Credentialed = more accurate, fewer false positives"
        }
      ]
    },
    {
      "section_id": "D2-L007-S03",
      "title": "Vulnerability Management Process",
      "estimated_time": "10 minutes",
      "content": "Vulnerability management is a continuous lifecycle of discovering, prioritizing, remediating, and verifying security weaknesses.\n\n**The Vulnerability Management Lifecycle:**\n\n*1. Asset Discovery and Inventory*\nYou cannot protect what you don't know exists. Maintain comprehensive asset inventory including hardware, software, cloud resources, and shadow IT. Classify assets by criticality, data sensitivity, and business function. Map asset ownership for remediation accountability. Update inventory continuously as environments change.\n\n*2. Vulnerability Identification*\nDeploy multiple detection methods: scheduled scans, continuous monitoring, threat intelligence feeds, penetration test findings, bug bounty reports, and vendor advisories. Aggregate findings into unified vulnerability repository. Deduplicate and correlate across sources for complete picture.\n\n*3. Prioritization and Risk Rating*\nRaw CVSS scores are insufficient for prioritization. Context matters:\n\n**Risk-Based Prioritization Factors:**\n- Asset criticality (crown jewels vs. test systems)\n- Data sensitivity (PII, financial, regulated)\n- Exposure (internet-facing vs. internal-only)\n- Exploitability (public exploit available? actively exploited?)\n- Compensating controls (WAF, segmentation, monitoring)\n- Business impact of remediation (downtime requirements)\n\n**Prioritization Frameworks:**\n- CVSS Environmental Scores (customize to your environment)\n- Exploit Prediction Scoring System (EPSS) - likelihood of exploitation\n- Stakeholder-Specific Vulnerability Categorization (SSVC) - CISA's decision tree\n- Threat intelligence overlay - is this being actively exploited?\n\n*4. Remediation Planning*\nDevelop remediation options for each finding:\n- **Patch**: Apply vendor fix (preferred when available)\n- **Upgrade**: Move to non-vulnerable version\n- **Workaround**: Disable vulnerable feature\n- **Compensating Control**: Add protection layer\n- **Risk Acceptance**: Document decision to accept risk\n- **System Retirement**: Decommission vulnerable system\n\nCoordinate remediation windows with change management. Estimate effort and resources required. Assign to system owners with clear SLAs.\n\n**Remediation SLA Guidelines:**\n| Severity | Internet-Facing | Internal |\n|----------|-----------------|----------|\n| Critical | 24-72 hours | 7 days |\n| High | 7 days | 30 days |\n| Medium | 30 days | 90 days |\n| Low | 90 days | 180 days |\n\n*5. Verification and Validation*\nRe-scan after remediation to confirm fix. Validate that patches didn't break functionality. Update vulnerability status in tracking system. Close tickets with evidence of remediation.\n\n*6. Reporting and Metrics*\nTrack program effectiveness with metrics:\n- Mean Time to Remediate (MTTR) by severity\n- Vulnerability aging (count by days open)\n- SLA compliance rates\n- Scan coverage percentage\n- Risk reduction over time",
      "must_remember_for_exam": [
        {
          "fact": "Lifecycle: Discover â†’ Prioritize â†’ Remediate â†’ Verify â†’ Report",
          "why_tested": "Process"
        },
        {
          "fact": "Risk acceptance requires documentation and approval",
          "why_tested": "Governance"
        },
        {
          "fact": "Compensating control mitigates when patching isn't possible",
          "why_tested": "Remediation option"
        }
      ],
      "exam_tips": [
        "Risk = Threat × Vulnerability × Impact (or Likelihood × Impact)",
        "Four risk treatments: Accept, Mitigate, Transfer, Avoid"
      ],
      "knowledge_check": {
        "question": "Which CVSS metric indicates whether an attacker can exploit a vulnerability remotely?",
        "options": [
          "Impact Score",
          "Attack Vector",
          "Privileges Required",
          "User Interaction"
        ],
        "correct_answer": 1,
        "explanation": "Attack Vector indicates how the vulnerability can be exploited: Network (remote), Adjacent, Local, or Physical."
      },
      "memory_hooks": {
        "mnemonics": [
          "DRIP: Discover, Risk-rank, Investigate, Patch/mitigate"
        ],
        "analogies": [
          "Vuln management is like car maintenance - regular inspections, prioritize safety issues"
        ],
        "common_mistakes": [
          "Patching by CVSS alone without considering asset criticality"
        ]
      },
      "deep_dive": [
        {
          "title": "Vulnerability Exceptions and Risk Acceptance",
          "content": "Not every vulnerability can or should be immediately patched. Formal exception process required: Document business justification for delay/acceptance. Identify compensating controls implemented. Set expiration date for exception review. Require appropriate management approval (higher severity = higher approval level). Track exceptions in GRC system. Review expired exceptions promptly. Risk acceptance is valid but must be informed, documented, and periodically reconsidered."
        },
        {
          "title": "Vulnerability Management Maturity Model",
          "content": "Level 1 (Initial): Ad-hoc scanning, reactive patching. Level 2 (Developing): Scheduled scans, basic prioritization by CVSS. Level 3 (Defined): Risk-based prioritization, SLAs, metrics. Level 4 (Managed): Continuous scanning, automation, threat intel integration. Level 5 (Optimizing): Predictive analytics, full automation, proactive security. Most organizations operate at Level 2-3. Advancement requires executive support, dedicated resources, and process maturity."
        }
      ],
      "career_spotlight": {
        "role": "Vulnerability Management Program Manager",
        "daily_tasks": [
          "Reviewing program metrics and SLA compliance",
          "Escalating aged vulnerabilities to leadership",
          "Coordinating with IT teams on remediation blockers",
          "Presenting risk posture to executives",
          "Improving program processes and automation"
        ],
        "tools_used": [
          "Tenable.io/SC",
          "ServiceNow VR",
          "Kenna Security",
          "Nucleus",
          "Vulcan Cyber"
        ],
        "career_path": "Security Analyst → Vuln Management Lead → Program Manager → Director of Security Operations"
      },
      "real_world_example": {
        "title": "WannaCry (2017) - The Patch That Wasn't Applied",
        "incident": "Microsoft released MS17-010 patching EternalBlue in March 2017. WannaCry ransomware exploited unpatched systems in May 2017, spreading to 200,000+ systems in 150 countries within days.",
        "impact": "NHS UK canceled 19,000 appointments. Maersk lost $300M. FedEx lost $400M. Total global damage estimated at $4-8 billion.",
        "lesson": "The vulnerability was known and patched for 59 days before WannaCry. Organizations with effective vulnerability management programs were protected. Those without paid dearly."
      },
      "glossary_terms": [
        {
          "term": "MTTR",
          "definition": "Mean Time to Remediate - average time from vulnerability discovery to successful remediation",
          "exam_note": "Key metric for vulnerability management program effectiveness"
        },
        {
          "term": "Risk Acceptance",
          "definition": "Formal acknowledgment and documentation of accepting a known risk without remediation",
          "exam_note": "Valid risk treatment but requires documentation and appropriate approval"
        },
        {
          "term": "Compensating Control",
          "definition": "Alternative security measure implemented when the preferred control is not feasible",
          "exam_note": "Must provide equivalent protection to primary control"
        },
        {
          "term": "EPSS",
          "definition": "Exploit Prediction Scoring System - probability that a vulnerability will be exploited in the wild",
          "exam_note": "Complements CVSS with likelihood prediction"
        }
      ]
    }
  ],
  "summary": {
    "exam_essentials": [
      "Zero-day = no patch available",
      "CVSS: Critical 9.0-10.0, High 7.0-8.9",
      "CVE = standardized vulnerability ID",
      "Credentialed scans more accurate than non-credentialed",
      "Pentest actually exploits; scan just identifies"
    ],
    "connection_to_next": "Vulnerability management is proactive defense. The next lesson covers Indicators of Compromise - detecting that attacks have occurred.",
    "key_takeaways": [
      "Vulnerability management is a continuous lifecycle: discover, prioritize, remediate, verify",
      "CVSS scores provide standardized severity ratings but must be contextualized with asset value and exposure",
      "Risk-based prioritization considers exploitability, asset criticality, and threat intelligence",
      "Vulnerability scanning differs from penetration testing - scans find, pentests prove exploitability",
      "Remediation options include patching, compensating controls, risk acceptance, or system retirement"
    ]
  },
  "related_content": {
    "next_lesson": "D2-LESSON-008",
    "previous_lesson": "D2-LESSON-006"
  },
  "hands_on_activity": {
    "title": "Vulnerability Prioritization Exercise",
    "objective": "Prioritize vulnerabilities using risk-based approach",
    "scenario": "Your scan found 500 vulnerabilities. Prioritize these 5 critical findings.",
    "steps": [
      "Review CVSS score and characteristics",
      "Consider asset criticality and exposure",
      "Factor in exploit availability",
      "Assign remediation priority and timeframe"
    ],
    "exercises": [
      {
        "vuln": "CVSS 9.8 RCE on internet-facing web server",
        "asset": "Customer portal",
        "exploit_available": "Yes, actively exploited",
        "priority": "1 - Critical",
        "timeframe": "24 hours"
      },
      {
        "vuln": "CVSS 7.5 SQL injection on internal HR application",
        "asset": "HR system with PII",
        "exploit_available": "PoC available",
        "priority": "2 - High",
        "timeframe": "7 days"
      },
      {
        "vuln": "CVSS 9.0 RCE but no patch available",
        "asset": "Legacy manufacturing system",
        "exploit_available": "Yes",
        "priority": "2 - High (compensating controls)",
        "timeframe": "Immediate mitigations, patch when available"
      },
      {
        "vuln": "CVSS 4.0 information disclosure",
        "asset": "Development server",
        "exploit_available": "No",
        "priority": "4 - Low",
        "timeframe": "30 days"
      }
    ],
    "expected_outcome": "Create prioritized remediation plan with business justification",
    "reflection_questions": [
      "When would you patch a CVSS 7.0 before a CVSS 9.0?",
      "How do you handle critical vulnerabilities with no patch?",
      "What role does threat intelligence play in prioritization?"
    ]
  },
  "what_would_you_do": {
    "scenario": "Your vulnerability scan shows 2,000 findings. Management wants them all fixed in 30 days. Your team can realistically fix 200/month. The highest-CVSS finding (9.8) is on an internal legacy system. A CVSS 7.5 finding is on your internet-facing payment portal.",
    "context": "Resources are limited. The legacy system processes internal reports only. The payment portal handles $10M/month in transactions.",
    "question": "How do you approach vulnerability prioritization?",
    "options": [
      {
        "id": "a",
        "text": "Fix by CVSS score - highest scores first (start with the 9.8)",
        "is_best": false,
        "feedback": "CVSS alone ignores context. The 9.8 is internal-only; the 7.5 is internet-facing with payment data. Asset criticality and exposure must factor into prioritization.",
        "consequences": "Fix internal system while payment portal exploited. $10M in transactions at risk."
      },
      {
        "id": "b",
        "text": "Risk-based prioritization: internet-facing + payment data + CVSS together. Fix payment portal first.",
        "is_best": true,
        "feedback": "Correct! Risk = likelihood × impact. Internet-facing (higher likelihood) × payment data (higher impact) makes the 7.5 higher actual risk than the internal 9.8.",
        "consequences": "Payment portal secured first. Risk reduced where exposure and impact are highest."
      },
      {
        "id": "c",
        "text": "Promise to fix all 2,000 in 30 days since management requested it",
        "is_best": false,
        "feedback": "Promising impossible outcomes destroys credibility. Set realistic expectations and prioritize effectively with available resources.",
        "consequences": "Team burns out trying to meet impossible goal. Quality suffers. Critical vulnerabilities missed."
      },
      {
        "id": "d",
        "text": "Fix only the internet-facing vulnerabilities - ignore internal systems",
        "is_best": false,
        "feedback": "Internal systems matter too - attackers who breach the perimeter will target them. Prioritize internet-facing first, but don't ignore internal risks.",
        "consequences": "External systems secured but attacker pivots from phishing compromise to vulnerable internal systems."
      }
    ],
    "key_lesson": "Risk-based prioritization considers CVSS + asset value + exposure + threat intelligence. Don't blindly follow CVSS scores - a 7.5 on internet-facing critical assets may be higher risk than a 9.8 on isolated internal systems."
  }
}