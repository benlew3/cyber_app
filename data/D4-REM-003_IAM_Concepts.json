{
  "simulation_id": "D4-REM-003",
  "title": "IAM Concepts",
  "domain": 4,
  "category": "remediation",
  "difficulty": "foundational",
  "time_estimate": "20-25 minutes",
  "passing_score": 40,
  "max_score": 50,
  
  "target_weaknesses": [
    "Understanding identity lifecycle (joiner, mover, leaver)",
    "Authentication factors and MFA concepts",
    "Privileged access management principles",
    "Access control models (RBAC, least privilege)"
  ],
  
  "exam_objectives": [
    {
      "id": "4.6",
      "description": "Given a scenario, implement and maintain identity and access management",
      "coverage": ["provisioning", "deprovisioning", "MFA", "PAM", "access controls"]
    },
    {
      "id": "4.5",
      "description": "Explain the purpose of mitigation techniques used to secure the enterprise",
      "coverage": ["least privilege", "separation of duties"]
    }
  ],
  
  "scenario_context": {
    "setting": "IAM fundamentals training - learning identity and access management",
    "your_role": "IT professional learning IAM concepts",
    "narrative": "Welcome to Identity and Access Management training. Today we'll learn the fundamentals of managing user identities, authentication, and access controls. These concepts are critical for protecting systems and data by ensuring only authorized users have appropriate access."
  },
  
  "teaching_modules": [
    {
      "id": "module_1",
      "title": "The Identity Lifecycle",
      "trigger": "before_decision_1",
      "content": {
        "concept": "Identities have a lifecycle from creation to deletion",
        "joiner_mover_leaver": {
          "joiner": {
            "trigger": "New employee, contractor, or partner joins",
            "activities": [
              "Create user account",
              "Assign appropriate access based on role",
              "Issue credentials (password, badge, MFA device)",
              "Provide access to required systems"
            ],
            "goal": "User has exactly the access they need on day one"
          },
          "mover": {
            "trigger": "Person changes role, department, or responsibilities",
            "activities": [
              "Review current access",
              "Remove access no longer needed",
              "Add access for new role",
              "Update group memberships"
            ],
            "risk": "Privilege accumulation - users keep old access and get new access"
          },
          "leaver": {
            "trigger": "Person leaves organization (voluntary or involuntary)",
            "activities": [
              "Disable account immediately",
              "Revoke all access",
              "Transfer data ownership",
              "Eventually delete account"
            ],
            "risk": "Terminated users retaining access"
          }
        },
        "automation_importance": {
          "manual_process": "Error-prone, slow, inconsistent",
          "automated_process": "Fast, consistent, audit trail",
          "key_insight": "HR system should trigger identity changes automatically"
        }
      }
    },
    {
      "id": "module_2",
      "title": "Authentication Factors",
      "trigger": "before_decision_2",
      "content": {
        "concept": "Authentication proves you are who you claim to be",
        "authentication_factors": {
          "something_you_know": {
            "examples": ["Password", "PIN", "Security questions"],
            "pros": "Easy to implement, familiar to users",
            "cons": "Can be guessed, stolen, phished, or forgotten"
          },
          "something_you_have": {
            "examples": ["Hardware token", "Smart card", "Mobile phone"],
            "pros": "Harder to steal remotely, physical possession required",
            "cons": "Can be lost or stolen, requires distribution"
          },
          "something_you_are": {
            "examples": ["Fingerprint", "Face recognition", "Retina scan"],
            "pros": "Can't be forgotten, hard to fake",
            "cons": "Privacy concerns, false positives/negatives, can't be changed if compromised"
          },
          "somewhere_you_are": {
            "examples": ["IP address", "GPS location", "Network location"],
            "pros": "Adds context, transparent to user",
            "cons": "Can be spoofed, not reliable alone"
          }
        },
        "multi_factor_authentication": {
          "definition": "Using two or more different factor types",
          "example": "Password (know) + authenticator app code (have)",
          "why_it_matters": "Attacker must compromise multiple factors",
          "not_mfa": "Two passwords (both 'something you know') = not MFA"
        }
      }
    },
    {
      "id": "module_3",
      "title": "Privileged Access Management",
      "trigger": "before_decision_3",
      "content": {
        "concept": "Privileged accounts require special protection due to their power",
        "what_is_privileged": {
          "definition": "Accounts with elevated permissions beyond normal users",
          "examples": [
            "Domain administrators",
            "Root accounts",
            "Database administrators",
            "Service accounts with system access"
          ],
          "why_they_matter": "Compromise of one privileged account can compromise entire environment"
        },
        "pam_principles": {
          "least_privilege": "Only the minimum access needed for the task",
          "separation": "Different accounts for daily work vs admin tasks",
          "just_in_time": "Elevate privileges only when needed, not standing access",
          "monitoring": "All privileged actions logged and reviewed"
        },
        "common_mistakes": {
          "shared_admin_accounts": "No accountability - who did what?",
          "daily_admin_use": "Admin browses web with admin credentials = elevated risk",
          "permanent_privileges": "Standing admin access even when not needed"
        },
        "best_practices": {
          "dedicated_admin_accounts": "Separate from daily-use account",
          "credential_vaulting": "Store admin passwords securely, not in spreadsheets",
          "session_recording": "Log privileged sessions for audit",
          "time_limited": "Admin access expires automatically"
        }
      }
    },
    {
      "id": "module_4",
      "title": "Access Control Models",
      "trigger": "before_decision_4",
      "content": {
        "concept": "Access control determines who can access what",
        "key_principles": {
          "least_privilege": {
            "definition": "Users get minimum access needed for their job",
            "benefit": "Limits damage if account is compromised",
            "implementation": "Start with no access, add only what's needed"
          },
          "separation_of_duties": {
            "definition": "Critical tasks require multiple people",
            "benefit": "Prevents single person from committing fraud",
            "example": "One person creates payments, another approves"
          },
          "need_to_know": {
            "definition": "Access based on business need, not clearance alone",
            "benefit": "Sensitive data only accessible to those who need it",
            "example": "HR can see personnel files; IT cannot (even though they have admin access to systems)"
          }
        },
        "rbac": {
          "name": "Role-Based Access Control",
          "concept": "Access granted through roles, not individually",
          "how_it_works": [
            "Define roles based on job functions",
            "Assign permissions to roles",
            "Assign users to roles",
            "Users get permissions from their roles"
          ],
          "benefits": [
            "Easier to manage than individual permissions",
            "Consistent access for same job function",
            "Easier auditing"
          ]
        }
      }
    },
    {
      "id": "module_5",
      "title": "Access Reviews",
      "trigger": "before_decision_5",
      "content": {
        "concept": "Regular reviews ensure access remains appropriate",
        "why_reviews_matter": {
          "privilege_creep": "Access accumulates over time as people change roles",
          "orphaned_access": "People leave but access remains",
          "inappropriate_access": "Access granted that shouldn't have been"
        },
        "review_types": {
          "user_access_review": {
            "scope": "All access for a specific user",
            "reviewer": "User's manager",
            "frequency": "Annual or on job change"
          },
          "application_access_review": {
            "scope": "All users of a specific application",
            "reviewer": "Application owner",
            "frequency": "Quarterly to annual"
          },
          "privileged_access_review": {
            "scope": "All privileged accounts",
            "reviewer": "Security team",
            "frequency": "Quarterly or more often"
          }
        },
        "review_process": {
          "certify": "Confirm access is still needed",
          "revoke": "Remove access that's no longer needed",
          "document": "Record decisions for audit"
        },
        "common_problem": {
          "rubber_stamping": "Reviewers approve everything without looking",
          "solution": "Training, random audits, focus on changes"
        }
      }
    }
  ],
  
  "decision_points": [
    {
      "id": "decision_1",
      "sequence": 1,
      "title": "Deprovisioning Priority",
      "narrative": "An employee was terminated this morning for cause. They're upset and have already left the building. HR informs you about the termination via email.",
      "question": "What is the MOST urgent action regarding this user's access?",
      "options": [
        {
          "id": "A",
          "text": "Schedule account deletion for next week's maintenance window",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "Far too slow for a hostile termination",
            "detailed": "A terminated employee who is upset poses immediate risk. Waiting until next week gives them days to access systems and potentially cause damage or steal data. Deprovisioning must be immediate."
          }
        },
        {
          "id": "B",
          "text": "Disable all accounts and revoke access immediately",
          "is_correct": true,
          "points": 10,
          "feedback": {
            "short": "Correct! Immediate deprovisioning for terminated users",
            "detailed": "Immediate actions: disable AD account (prevents new logins), revoke VPN access, disable email, revoke application access. The user left upset - they may try to access systems remotely. Every minute of delay is risk. This should be automated when possible."
          }
        },
        {
          "id": "C",
          "text": "Wait for the standard HR termination process to complete",
          "is_correct": false,
          "points": 2,
          "feedback": {
            "short": "Standard process is too slow for security risk",
            "detailed": "Standard HR processes might take days. For a hostile termination, security needs override standard timelines. IT should have an expedited process for immediate deprovisioning when security risk exists."
          }
        },
        {
          "id": "D",
          "text": "Just change their password - they can keep the account for reference",
          "is_correct": false,
          "points": 2,
          "feedback": {
            "short": "Password change alone is insufficient",
            "detailed": "Password change doesn't revoke existing sessions, doesn't disable email, doesn't revoke application access, and doesn't prevent them from resetting password if they have access to password reset. Full account disable is required."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "A terminated employee who is upset = security risk. How quickly should access be removed?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "Immediate deprovisioning: disable account, revoke all access, terminate sessions. Don't wait for standard processes when there's security risk."
        }
      ],
      "learning_note": "Deprovisioning priority: terminated users (especially hostile separations) need immediate access revocation. Best practice is automated deprovisioning triggered by HR system. For high-risk terminations, security should be notified before the employee to ensure access is revoked as they leave."
    },
    {
      "id": "decision_2",
      "sequence": 2,
      "title": "MFA Configuration",
      "narrative": "You're implementing MFA for remote access. Users currently authenticate with username and password only. You need to add a second factor.",
      "question": "Which MFA configuration provides the STRONGEST security improvement?",
      "options": [
        {
          "id": "A",
          "text": "Add a second password that users must also enter",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "Two passwords are not MFA",
            "detailed": "Two passwords are both 'something you know' - the same factor type. MFA requires different factor types. Two passwords can both be phished, stolen, or guessed. This provides minimal security improvement."
          }
        },
        {
          "id": "B",
          "text": "Add SMS text message codes as second factor",
          "is_correct": false,
          "points": 4,
          "feedback": {
            "short": "Better than nothing but SMS has weaknesses",
            "detailed": "SMS is a true second factor (something you have - the phone), but: SMS can be intercepted via SIM swapping attacks, SMS can be redirected by attackers, and cell networks have vulnerabilities. It's better than password-only but not the strongest option."
          }
        },
        {
          "id": "C",
          "text": "Add authenticator app (TOTP) codes as second factor",
          "is_correct": true,
          "points": 10,
          "feedback": {
            "short": "Correct! Authenticator apps are more secure than SMS",
            "detailed": "Authenticator apps (Google Authenticator, Microsoft Authenticator): generate codes on the device (not transmitted via SMS), can't be intercepted via SIM swap, work offline, and are a true 'something you have' factor. This is the standard recommendation for most MFA implementations."
          }
        },
        {
          "id": "D",
          "text": "Add security questions as second factor",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "Security questions are 'something you know' - same as password",
            "detailed": "Security questions are knowledge-based - the same factor type as password. Answers can often be researched on social media or guessed. This is not true MFA and provides minimal additional security."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "MFA requires different factor types. Password is 'something you know.' What's a different factor type?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "'Something you have' - authenticator app on your phone generates codes. More secure than SMS because codes aren't transmitted over vulnerable networks."
        }
      ],
      "learning_note": "MFA strength comparison: Hardware tokens (FIDO2) > Authenticator apps (TOTP) > Push notifications > SMS > Security questions. Authenticator apps are the practical sweet spot for most organizations - secure, low cost, user-friendly. Avoid SMS for high-security applications."
    },
    {
      "id": "decision_3",
      "sequence": 3,
      "title": "Privileged Account Management",
      "narrative": "The IT team shares one administrator account with the password written on a sticky note on the server room wall. When something breaks, any available admin logs in and fixes it.",
      "question": "What is the PRIMARY security problem with this approach?",
      "options": [
        {
          "id": "A",
          "text": "The sticky note could fall off the wall",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "Physical security is a problem, but not the primary one",
            "detailed": "The sticky note is bad, but even if the password were memorized, shared admin accounts are a fundamental security problem. The password visibility is a symptom, not the root cause."
          }
        },
        {
          "id": "B",
          "text": "No accountability - impossible to know who did what",
          "is_correct": true,
          "points": 10,
          "feedback": {
            "short": "Correct! Shared accounts eliminate individual accountability",
            "detailed": "With shared accounts: no audit trail of individual actions (logs show 'admin' did it, not who), no accountability for mistakes or malicious actions, impossible to investigate incidents, and violates compliance requirements. Each admin should have their own admin account with their activity logged."
          }
        },
        {
          "id": "C",
          "text": "Too many people know the password",
          "is_correct": false,
          "points": 4,
          "feedback": {
            "short": "Part of the problem but not the primary issue",
            "detailed": "Multiple people knowing the password increases exposure, but even if only two people knew it, you still couldn't determine which one performed an action. Individual accounts solve both the exposure and accountability problems."
          }
        },
        {
          "id": "D",
          "text": "The password should be more complex",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "Password complexity doesn't address shared account issues",
            "detailed": "A complex password on a shared account still has no accountability. Password complexity is good practice but doesn't solve the fundamental problem of not knowing who did what."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "If something goes wrong with that admin account, how would you know who did it?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "Shared accounts = no individual accountability. Logs show 'admin' but not which person. Essential for incident investigation and compliance."
        }
      ],
      "learning_note": "Shared privileged accounts problems: no individual accountability, can't investigate incidents, can't revoke access for one person without affecting others, and violates compliance requirements. Solution: individual admin accounts per person, credential vaulting, session logging."
    },
    {
      "id": "decision_4",
      "sequence": 4,
      "title": "Access Control Implementation",
      "narrative": "A new employee joins the accounting team. They need access to the accounting system, email, and shared drives. You're setting up their access.",
      "question": "What is the BEST approach for granting this user access?",
      "options": [
        {
          "id": "A",
          "text": "Copy permissions from another accountant's account",
          "is_correct": false,
          "points": 4,
          "feedback": {
            "short": "May copy inappropriate or excessive access",
            "detailed": "The other accountant may have accumulated extra permissions over time (privilege creep), may have access specific to their duties that the new person doesn't need, or may have incorrect access themselves. Copying propagates problems."
          }
        },
        {
          "id": "B",
          "text": "Assign the Accountant role which has pre-defined appropriate access",
          "is_correct": true,
          "points": 10,
          "feedback": {
            "short": "Correct! Role-based access is consistent and manageable",
            "detailed": "RBAC approach: the Accountant role is pre-defined with appropriate permissions, all accountants get consistent access, changes to the role affect all members, and it's easy to audit who has what. New employee gets exactly what they need - no more, no less."
          }
        },
        {
          "id": "C",
          "text": "Give them full access and remove what they don't need later",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "Violates least privilege - start with maximum access?",
            "detailed": "This inverts least privilege. Starting with full access: exposes them to data they shouldn't see initially, creates risk if they make mistakes with excess access, and 'removing later' rarely happens. Start with minimum needed."
          }
        },
        {
          "id": "D",
          "text": "Ask them what access they think they need",
          "is_correct": false,
          "points": 2,
          "feedback": {
            "short": "New employees don't know what they need",
            "detailed": "A new employee doesn't know your systems or what access is appropriate. They might ask for too much (everything sounds useful) or too little (don't know what exists). Access should be defined by the role requirements, not user requests."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "What access control approach provides consistent, appropriate access for job functions?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "RBAC: define roles with appropriate permissions, assign users to roles. Consistent access, easy management, supports least privilege."
        }
      ],
      "learning_note": "RBAC benefits: consistent access (same role = same access), easier management (change role, not individuals), supports least privilege (roles have only needed permissions), and easier auditing (check role membership). Avoid copying from other users - you copy their privilege creep too."
    },
    {
      "id": "decision_5",
      "sequence": 5,
      "title": "Access Review Finding",
      "narrative": "During an access review, you find that a user who transferred from Accounting to Marketing six months ago still has full access to the accounting system including sensitive financial data.",
      "question": "What is this situation called and how should it be addressed?",
      "options": [
        {
          "id": "A",
          "text": "This is normal - they might need it as backup",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "Keeping unnecessary access violates least privilege",
            "detailed": "Marketing doesn't need accounting access. Keeping 'just in case' access creates unnecessary risk. If they ever need temporary access, a proper request process exists. The access should be removed."
          }
        },
        {
          "id": "B",
          "text": "Privilege creep - revoke the accounting access immediately",
          "is_correct": true,
          "points": 10,
          "feedback": {
            "short": "Correct! Remove access that's no longer needed",
            "detailed": "Privilege creep: accumulation of access as users change roles without removing old permissions. This user has access to sensitive financial data they no longer need. Revoke the accounting access - they have no business need for it in their current role. This is exactly what access reviews are designed to catch."
          }
        },
        {
          "id": "C",
          "text": "Ask the user if they still need the access",
          "is_correct": false,
          "points": 2,
          "feedback": {
            "short": "Users will almost always say yes",
            "detailed": "Users tend to keep access 'just in case' or because removing it requires explanation. The review should be based on business need, not user preference. A marketing person has no business need for full accounting access."
          }
        },
        {
          "id": "D",
          "text": "Document it for next year's review",
          "is_correct": false,
          "points": 0,
          "feedback": {
            "short": "Delays addressing a clear problem",
            "detailed": "The review found a problem - inappropriate access. Documenting for next year leaves the risk in place for another year. Reviews should result in action, not just documentation."
          }
        }
      ],
      "hints": [
        {
          "level": 1,
          "cost": 2,
          "text": "What happens when users change roles but keep their old access?"
        },
        {
          "level": 2,
          "cost": 5,
          "text": "Privilege creep: access accumulates over time. Movers should have old access removed when new access is granted. Reviews catch what was missed."
        }
      ],
      "learning_note": "Privilege creep: access accumulates as users change roles without removing old permissions. Access reviews catch this. When found: revoke unnecessary access (don't just document), update the mover process to prevent recurrence, and consider whether this indicates a systemic problem."
    }
  ],
  
  "scoring": {
    "max_points": 50,
    "passing_score": 40,
    "passing_percentage": 80
  },
  
  "outcome_thresholds": {
    "proficient": {"min_score": 45, "title": "IAM Concepts Proficient", "description": "Strong understanding of IAM fundamentals."},
    "competent": {"min_score": 40, "title": "IAM Concepts Competent", "description": "Adequate grasp of IAM concepts."},
    "developing": {"min_score": 30, "title": "IAM Concepts Developing", "description": "Review IAM concepts further."},
    "needs_work": {"min_score": 0, "title": "Additional Study Needed", "description": "Significant review of IAM required."}
  },
  
  "remediation_focus": [
    "Understanding the identity lifecycle (joiner, mover, leaver)",
    "Authentication factors and MFA concepts",
    "Privileged access management principles",
    "Access control models and least privilege"
  ],
  
  "next_steps": {
    "passed": "Return to D4-SIM-004 for full IAM scenario",
    "failed": "Review teaching modules and retry"
  },
  
  "metadata": {
    "version": "1.0",
    "created": "2024-02-13",
    "author": "Security+ Training System",
    "domain_alignment": "Domain 4: Security Operations",
    "prerequisite_for": ["D4-SIM-004"],
    "estimated_time": "20-25 minutes"
  }
}
