<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="CompTIA Security+ SY0-701 Training Platform">
    <meta name="theme-color" content="#09090b">
    <title>Security+ SY0-701 Training Platform</title>
    
    <!-- Optimized Critical CSS -->
    <style>
        /* Reset and Base - Minimal FOUC */
        *{margin:0;padding:0;box-sizing:border-box}
        html,body{height:100%;background:#09090b;color:#fafafa;font-family:system-ui,-apple-system,sans-serif}
        
        /* Kill colored nav immediately */
        [style*="linear-gradient"],[style*="Security+ SY0-701"],.colored-nav,.top-nav{display:none!important;height:0!important}
        
        /* Loading screen */
        #loading-screen{position:fixed;inset:0;background:#09090b;display:flex;flex-direction:column;justify-content:center;align-items:center;z-index:9999;transition:opacity .3s}
        #loading-screen.hide{opacity:0;pointer-events:none}
        .loader{width:48px;height:48px;border:3px solid #27272a;border-top-color:#6366f1;border-radius:50%;animation:spin 1s linear infinite}
        @keyframes spin{to{transform:rotate(360deg)}}
        #loading-text{margin-top:16px;color:#a1a1aa;font-size:14px}
        
        /* Main content */
        #main-content{display:none;min-height:100vh}
        #main-content.show{display:block}
        
        /* Error handling */
        .error-screen{display:none;position:fixed;inset:0;background:#09090b;padding:20px;z-index:9998}
        .error-container{max-width:600px;margin:50px auto;padding:30px;background:#18181b;border:1px solid #27272a;border-radius:12px;text-align:center}
        .error-btn{background:#27272a;color:#fafafa;border:none;padding:12px 24px;border-radius:6px;cursor:pointer;margin:5px}
        .error-btn:hover{background:#3f3f46}
    </style>
</head>
<body>
    <!-- JavaScript Check -->
    <noscript>
        <div style="position:fixed;top:0;left:0;right:0;background:#ef4444;color:white;padding:15px;text-align:center;z-index:10000">
            ‚ö†Ô∏è JavaScript is required. Please enable it in your browser.
        </div>
    </noscript>
    
    <!-- Loading Screen -->
    <div id="loading-screen">
        <div class="loader"></div>
        <div id="loading-text">Loading Security+ Platform...</div>
    </div>
    
    <!-- Error Screen -->
    <div class="error-screen" id="error-screen">
        <div class="error-container">
            <h1 style="font-size:24px;margin-bottom:10px">‚ö†Ô∏è Loading Error</h1>
            <p id="error-message" style="color:#a1a1aa;margin:20px 0">
                Unable to load the platform. This may be a temporary issue.
            </p>
            <div>
                <button class="error-btn" onclick="location.reload(true)" style="background:#6366f1">
                    üîÑ Reload Page
                </button>
                <button class="error-btn" onclick="localStorage.clear();location.reload()">
                    üßπ Clear Cache & Reload
                </button>
            </div>
        </div>
    </div>
    
    <!-- Main App Container -->
    <main id="main-content">
        <div id="content"></div>
    </main>
    
    <!-- Immediate Colored Nav Killer -->
    <script>
        // Kill colored nav IMMEDIATELY
        (function(){
            const kill = () => {
                document.querySelectorAll('[style*="linear-gradient"],[style*="Security+ SY0-701"],.colored-nav,.top-nav').forEach(e => {
                    if(e && e.parentNode && !e.classList?.contains('platform-header-bar')) e.remove();
                });
            };
            kill();
            let c=0;
            const i=setInterval(()=>{kill();if(++c>30)clearInterval(i)},100);
        })();
        
        // App load monitoring
        let appLoaded = false;
        let loadTimeout = null;
        
        // Show error if app doesn't load
        function showError(msg) {
            console.error('Error:', msg);
            const ls = document.getElementById('loading-screen');
            const es = document.getElementById('error-screen');
            const em = document.getElementById('error-message');
            if(ls) ls.style.display = 'none';
            if(es) es.style.display = 'block';
            if(em && msg) em.textContent = msg;
        }
        
        // Hide loading when app loads
        function hideLoading() {
            const ls = document.getElementById('loading-screen');
            const mc = document.getElementById('main-content');
            if(ls) {
                ls.classList.add('hide');
                setTimeout(() => ls.style.display = 'none', 300);
            }
            if(mc) mc.classList.add('show');
        }
        
        // Set timeout for app loading (8 seconds)
        loadTimeout = setTimeout(() => {
            if(!appLoaded && (!window.APP || !window.APP.initialized)) {
                showError('Application is taking too long to load. Please check your connection and reload.');
            }
        }, 8000);
        
        // Monitor app initialization
        const checkApp = setInterval(() => {
            if(window.APP && window.APP.initialized) {
                appLoaded = true;
                clearTimeout(loadTimeout);
                clearInterval(checkApp);
                hideLoading();
                console.log('‚úÖ App loaded successfully');
            }
        }, 100);
        
        // Fallback after 10 seconds
        setTimeout(() => {
            clearInterval(checkApp);
            if(!appLoaded) {
                hideLoading();
                const content = document.getElementById('content');
                if(content && !content.innerHTML) {
                    content.innerHTML = `
                        <div style="padding:40px;text-align:center;max-width:600px;margin:0 auto">
                            <h1 style="font-size:2rem;margin-bottom:20px">Security+ Training Platform</h1>
                            <p style="color:#a1a1aa;margin-bottom:20px">Loading in compatibility mode...</p>
                            <button onclick="location.reload()" style="background:#6366f1;color:white;border:none;padding:12px 24px;border-radius:6px;cursor:pointer">
                                Reload Full Platform
                            </button>
                        </div>
                    `;
                }
            }
        }, 10000);
    </script>
    
    <!-- Load Main App -->
    <script src="./js/app.js" defer></script>
    
    <!-- Final Cleanup -->
    <script>
        window.addEventListener('load', () => {
            // Final colored nav removal
            setTimeout(() => {
                document.querySelectorAll('[style*="linear-gradient"]').forEach(e => {
                    if(!e.classList?.contains('platform-header-bar')) e.remove();
                });
            }, 500);
        });
    </script>
</body>
</html>
